<!DOCTYPE html>
<html><head><title>Issue2951.xaml.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(144);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="Xamarin.Forms.Core.iOS.UITests/Issue2951.xaml.cs" target="_top">Issue2951.xaml.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xamarin.Forms.Core.iOS.UITests" target="_top">Xamarin.Forms.Core.iOS.UITests\Xamarin.Forms.Core.iOS.UITests.csproj</a> (Xamarin.Forms.Core.iOS.UITests)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">CustomAttributes</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Internals</span>;
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UITEST</span>
<b>using</b> <span class="i n">Xamarin</span>.<span class="i">UITest</span>.<span class="i">Queries</span>;
<b>using</b> <span class="i">NUnit</span>.<span class="i">Framework</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
 
<b>namespace</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Controls</span>.<span class="i n">Issues</span>
{
	[<a href="/Xamarin.Forms.Core/A.html#86e8cd96f62aab08" class="t constructor">Preserve</a> (<a href="/Xamarin.Forms.Core/A.html#1bacf10dafd22c73" class="i field">AllMembers</a> = <b>true</b>)]
	[<a href="/Xamarin.Forms.CustomAttributes/A.html#ee8e16fdd2ff2815" class="t constructor">Issue</a> (<a href="/Xamarin.Forms.CustomAttributes/A.html#71fbc272a65cfefa" class="t t">IssueTracker</a>.<a href="/Xamarin.Forms.CustomAttributes/A.html#95167b8d420cde62" class="i field">Github</a>, 2951, <span class="s">&quot;On Android, button background is not updated when color changes &quot;</span>)]
	<b>public</b> <b>partial</b> <b>class</b> <a id="d70180f22828f5e6" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">Issue2951</a> : <a href="TestPages.cs.html#68092d82b8b3d7b5" class="t t">TestContentPage</a>
	{
		<b>public</b> <a id="27926e1297a0592a" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i constructor">Issue2951</a> ()
		{
			<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">APP</span>
<span class="e">			InitializeComponent ();
</span>			<span class="k preprocess">#</span><span class="k preprocess">endif</span>
		}
 
		<b>protected override void</b> <a id="dd87d08fdd3410b8" href="R/dd87d08fdd3410b8.html" target="n" data-glyph="75,1" class="i method">Init</a> ()
		{
			<a href="/Xamarin.Forms.Core/A.html#ec31b23be1ce91d4" class="i property">BindingContext</a> = <b>new</b> <a href="#5a5886bf57558295" class="t constructor">MyViewModel</a> ();
		}
 
		[<a href="/Xamarin.Forms.Core/A.html#86e8cd96f62aab08" class="t constructor">Preserve</a> (<a href="/Xamarin.Forms.Core/A.html#1bacf10dafd22c73" class="i field">AllMembers</a> = <b>true</b>)]
		<b>public class</b> <a id="a50ee3beb105d8f5" href="R/a50ee3beb105d8f5.html" target="n" data-glyph="0,1" class="t t">MyViewModel</a>
		{
			<b>public</b> <a href="@0@System/A.html#f63ea2601f5edbbb" class="t t">ObservableCollection</a>&lt;<a href="#9a29ab765d18220a" class="t t">MyItemViewModel</a>&gt; <a id="5bb13c7506ded536" href="R/5bb13c7506ded536.html" target="n" data-glyph="102,2" class="i property">Items</a> { <b>get</b>; <b>private set</b>; }
 
			<b>public</b> <a href="/Xamarin.Forms.Core/A.html#72d986f738e94e84" class="t t">Command</a>&lt;<a href="#9a29ab765d18220a" class="t t">MyItemViewModel</a>&gt; <a id="6d2d3892c108f0b1" href="R/6d2d3892c108f0b1.html" target="n" data-glyph="102,2" class="i property">ButtonTapped</a> { <b>get</b>; <b>private set</b>; }
 
			<b>public</b> <a id="5a5886bf57558295" href="R/5a5886bf57558295.html" target="n" data-glyph="72,2" class="i constructor">MyViewModel</a> ()
			{
				<a href="#6d2d3892c108f0b1" class="i property">ButtonTapped</a> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#ff6cfd786800c482" class="t constructor">Command</a>&lt;<a href="#9a29ab765d18220a" class="t t">MyItemViewModel</a>&gt; (<a href="#6a514a48c1895826" class="i method">OnItemTapped</a>);
 
				<a href="#5bb13c7506ded536" class="i property">Items</a> = <b>new</b> <a href="@0@System/A.html#a0b7a0640c9feb02" class="t constructor">ObservableCollection</a>&lt;<a href="#9a29ab765d18220a" class="t t">MyItemViewModel</a>&gt; ();
 
				<a href="#5bb13c7506ded536" class="i property">Items</a>.<a href="@0@mscorlib/A.html#5c61cc24de82f7e7" class="i method">Add</a> (<b>new</b> <a href="#9a29ab765d18220a" class="t constructor">MyItemViewModel</a> { <a href="#5effb369cb492724" class="i property">Name</a> = <span class="s">&quot;A&quot;</span>, <a href="#6128c8947fd8492e" class="i property">IsStarted</a> = <b>false</b> });
				<a href="#5bb13c7506ded536" class="i property">Items</a>.<a href="@0@mscorlib/A.html#5c61cc24de82f7e7" class="i method">Add</a> (<b>new</b> <a href="#9a29ab765d18220a" class="t constructor">MyItemViewModel</a> { <a href="#5effb369cb492724" class="i property">Name</a> = <span class="s">&quot;B&quot;</span>, <a href="#6128c8947fd8492e" class="i property">IsStarted</a> = <b>false</b> });
				<a href="#5bb13c7506ded536" class="i property">Items</a>.<a href="@0@mscorlib/A.html#5c61cc24de82f7e7" class="i method">Add</a> (<b>new</b> <a href="#9a29ab765d18220a" class="t constructor">MyItemViewModel</a> { <a href="#5effb369cb492724" class="i property">Name</a> = <span class="s">&quot;C&quot;</span>, <a href="#6128c8947fd8492e" class="i property">IsStarted</a> = <b>false</b> });
			}
 
			<b>void</b> <a id="6a514a48c1895826" href="R/6a514a48c1895826.html" target="n" data-glyph="76,2" class="i method">OnItemTapped</a> (<a href="#9a29ab765d18220a" class="t t">MyItemViewModel</a> <span id="r0 rd" class="r0 r">model</span>)
			{
				<b>if</b> (<span class="r0 r">model</span>.<a href="#6128c8947fd8492e" class="i property">IsStarted</a>) {
					<a href="#5bb13c7506ded536" class="i property">Items</a>.<a href="@0@mscorlib/A.html#7ea53c2fa96a1c7d" class="i method">Remove</a> (<span class="r0 r">model</span>);
				} <b>else</b> {
					<span class="r0 r">model</span>.<a href="#6128c8947fd8492e" class="i property">IsStarted</a> = <b>true</b>;
				}
			}
		}
 
		[<a href="/Xamarin.Forms.Core/A.html#86e8cd96f62aab08" class="t constructor">Preserve</a> (<a href="/Xamarin.Forms.Core/A.html#1bacf10dafd22c73" class="i field">AllMembers</a> = <b>true</b>)]
		<b>public class</b> <a id="9a29ab765d18220a" href="R/9a29ab765d18220a.html" target="n" data-glyph="0,1" class="t t"><span id="2dad03388c873d58">MyItemViewModel</span></a> : <a href="@0@System/A.html#fd4b42d7e29d53e5" class="t t">INotifyPropertyChanged</a>
		{
			<b>public event</b> <a href="@0@System/A.html#670754815f6804ff" class="t t">PropertyChangedEventHandler</a> <a id="ed90cb544e138ea2" href="R/ed90cb544e138ea2.html" target="n" data-glyph="30,2" class="i">PropertyChanged</a>;
 
			<b>string</b> <a id="b4e0a9e5f0d5c108" href="R/b4e0a9e5f0d5c108.html" target="n" data-glyph="46,2" class="i field">_name</a>;
 
			<b>public string</b> <a id="5effb369cb492724" href="R/5effb369cb492724.html" target="n" data-glyph="102,2" class="i property">Name</a> {
				<b>get</b> { <b>return</b> <a href="#b4e0a9e5f0d5c108" class="i field">_name</a>; } 
				<b>set</b> {
					<a href="#b4e0a9e5f0d5c108" class="i field">_name</a> = <b>value</b>;
					<a href="#abb1d2f32d15f9e8" class="i method">OnPropertyChanged</a> (<span class="s">&quot;Name&quot;</span>);
				}
			}
 
			<b>bool</b> <a id="29a479c7d6112186" href="R/29a479c7d6112186.html" target="n" data-glyph="46,2" class="i field">_isStarted</a>;
 
			<b>public bool</b> <a id="6128c8947fd8492e" href="R/6128c8947fd8492e.html" target="n" data-glyph="102,2" class="i property">IsStarted</a> {
				<b>get</b> { <b>return</b> <a href="#29a479c7d6112186" class="i field">_isStarted</a>; } 
				<b>set</b> {
					<a href="#29a479c7d6112186" class="i field">_isStarted</a> = <b>value</b>;
					<a href="#abb1d2f32d15f9e8" class="i method">OnPropertyChanged</a> (<span class="s">&quot;IsStarted&quot;</span>);
				}
			}
 
			<b>void</b> <a id="abb1d2f32d15f9e8" href="R/abb1d2f32d15f9e8.html" target="n" data-glyph="76,2" class="i method">OnPropertyChanged</a> (<b>string</b> <span id="r1 rd" class="r1 r">propertyName</span>)
			{
				<b>if</b> (<a href="#ed90cb544e138ea2" class="i">PropertyChanged</a> != <b>null</b>) {
					<a href="#ed90cb544e138ea2" class="i">PropertyChanged</a> (<a href="#9a29ab765d18220a" class="k">this</a>, <b>new</b> <a href="@0@System/A.html#76958b0a96ed2a2e" class="t constructor">PropertyChangedEventArgs</a> (<span class="r1 r">propertyName</span>));
				}
			}
		}
	
		<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UITEST</span>
		[<span class="i">Test</span>]
		<b>public void</b> <a id="40bfe8f61df87641" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Issue2951Test</a> ()
		{
			<b>var</b> <span id="r2 rd" class="r2 r">bt</span> = <a href="TestPages.cs.html#4c064e8d618de9de" class="i property">RunningApp</a>.<span class="i">WaitForElement</span> (<span id="r3 rd" class="r3 r">c</span> =&gt; <span class="r3 r">c</span>.<span class="i">Marked</span> (<span class="s">&quot;btnChangeStatus&quot;</span>));
			<b>var</b> <span id="r4 rd" class="r4 r">buttons</span> = <a href="TestPages.cs.html#4c064e8d618de9de" class="i property">RunningApp</a>.<span class="i">Query</span> (<span id="r5 rd" class="r5 r">c</span> =&gt; <span class="r5 r">c</span>.<span class="i">Marked</span> (<span class="s">&quot;btnChangeStatus&quot;</span>));
			<span class="i">Assert</span>.<span class="i">That</span> (<span class="r4 r">buttons</span>.<span class="i">Length</span>, <span class="i">Is</span>.<span class="i">EqualTo</span> (3));
			<a href="TestPages.cs.html#4c064e8d618de9de" class="i property">RunningApp</a>.<span class="i">Tap</span>(<span id="r6 rd" class="r6 r">c</span> =&gt; <span class="r6 r">c</span>.<span class="i">Marked</span> (<span class="s">&quot;btnChangeStatus&quot;</span>).<span class="i">Index</span>(1));
			<span class="r4 r">buttons</span> = <a href="TestPages.cs.html#4c064e8d618de9de" class="i property">RunningApp</a>.<span class="i">Query</span> (<span id="r7 rd" class="r7 r">c</span> =&gt; <span class="r7 r">c</span>.<span class="i">Marked</span> (<span class="s">&quot;btnChangeStatus&quot;</span>));
			<b>var</b> <span id="r8 rd" class="r8 r">text</span> = <span class="r4 r">buttons</span> [1].<span class="i">Text</span> ?? <span class="r4 r">buttons</span> [1].<span class="i">Label</span>;
			<span class="i">Assert</span>.<span class="i">That</span> (<span class="r8 r">text</span>, <span class="i">Is</span>.<span class="i">EqualTo</span> (<span class="s">&quot;B&quot;</span>));
			<a href="TestPages.cs.html#4c064e8d618de9de" class="i property">RunningApp</a>.<span class="i">Tap</span>(<span id="r9 rd" class="r9 r">c</span> =&gt; <span class="r9 r">c</span>.<span class="i">Marked</span> (<span class="s">&quot;btnChangeStatus&quot;</span>).<span class="i">Index</span>(1));
			<span class="r4 r">buttons</span> = <a href="TestPages.cs.html#4c064e8d618de9de" class="i property">RunningApp</a>.<span class="i">Query</span> (<span id="r10 rd" class="r10 r">c</span> =&gt; <span class="r10 r">c</span>.<span class="i">Marked</span> (<span class="s">&quot;btnChangeStatus&quot;</span>));
			<span class="i">Assert</span>.<span class="i">That</span> (<span class="r4 r">buttons</span>.<span class="i">Length</span>, <span class="i">Is</span>.<span class="i">EqualTo</span> (2));
			<span class="c">//TODO: we should check the color of the button</span>
			<span class="c">//var buttonTextColor = GetProperty&lt;Color&gt; (&quot;btnChangeStatus&quot;, Button.BackgroundColorProperty);</span>
			<span class="c">//Assert.AreEqual (Color.Pink, buttonTextColor);</span>
		}
 
	
		<span class="k preprocess">#</span><span class="k preprocess">endif</span>
	}
}
 
<b>namespace</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Controls</span>
{
	[<a href="/Xamarin.Forms.Core/A.html#86e8cd96f62aab08" class="t constructor">Preserve</a>(<a href="/Xamarin.Forms.Core/A.html#1bacf10dafd22c73" class="i field">AllMembers</a> = <b>true</b>)]
	<b>public class</b> <a id="65a52ec359b99294" href="R/65a52ec359b99294.html" target="n" data-glyph="0,0" class="t t"><span id="0f9c3929d9d3c392">ButtonExtensions</span></a>
	{
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 618
		<b>public static readonly</b> <a href="/Xamarin.Forms.Core/A.html#743d6dd5177e1828" class="t t">BindableProperty</a> <a id="e4efe51e9c17af18" href="R/e4efe51e9c17af18.html" target="n" data-glyph="42,1" class="i field">IsPrimaryProperty</a> = <a href="/Xamarin.Forms.Core/A.html#743d6dd5177e1828" class="t t">BindableProperty</a>.<a href="/Xamarin.Forms.Core/A.html#7c5f459c806cb197" class="i method">CreateAttached</a>&lt;<a href="#65a52ec359b99294" class="t t">ButtonExtensions</a>, <b>bool</b>&gt;(
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 618
																		<span id="r11 rd" class="r11 r">bindable</span> =&gt; <a href="#bef87ca9ef0ea69c" class="i method">GetIsPrimary</a>(<span class="r11 r">bindable</span>),
																		<b>false</b>,
																		<a href="/Xamarin.Forms.Core/A.html#fc1bd67c74123628" class="t t">BindingMode</a>.<a href="/Xamarin.Forms.Core/A.html#5b5de329b5adbce9" class="i field">TwoWay</a>,
																		<b>null</b>,
																		<b>null</b>,
																		<b>null</b>,
																		<b>null</b>);
 
		<b>public static bool</b> <a id="bef87ca9ef0ea69c" href="R/bef87ca9ef0ea69c.html" target="n" data-glyph="72,1" class="i method">GetIsPrimary</a>(<a href="/Xamarin.Forms.Core/A.html#804aed41f6e6b7c8" class="t t">BindableObject</a> <span id="r12 rd" class="r12 r">bo</span>)
		{
			<b>return</b> (<b>bool</b>)<span class="r12 r">bo</span>.<a href="/Xamarin.Forms.Core/A.html#00e81fee0b400c43" class="i method">GetValue</a>(<a href="#e4efe51e9c17af18" class="i field">IsPrimaryProperty</a>);
		}
 
		<b>public static void</b> <a id="ed050d711bc3454f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetIsPrimary</a>(<a href="/Xamarin.Forms.Core/A.html#804aed41f6e6b7c8" class="t t">BindableObject</a> <span id="r13 rd" class="r13 r">bo</span>, <b>bool</b> <span id="r14 rd" class="r14 r">value</span>)
		{
			<span class="r13 r">bo</span>.<a href="/Xamarin.Forms.Core/A.html#71f22f51364ed0e1" class="i method">SetValue</a>(<a href="#e4efe51e9c17af18" class="i field">IsPrimaryProperty</a>, <span class="r14 r">value</span>);
		}
	}
}</pre></td></tr></table></div></body></html>
