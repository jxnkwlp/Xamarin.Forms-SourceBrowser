<!DOCTYPE html>
<html><head><title>PageRenderer.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(108);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="Xamarin.Forms.Platform.Android/Renderers/PageRenderer.cs" target="_top">Renderers\PageRenderer.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xamarin.Forms.Platform.Android" target="_top">Xamarin.Forms.Platform.Android\Xamarin.Forms.Platform.Android.csproj</a> (Xamarin.Forms.Platform.Android)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Views</span>;
 
<b>namespace</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Platform</span>.<span class="i n">Android</span>
{
	<b>public class</b> <a id="6865490a635efa0c" href="../R/6865490a635efa0c.html" target="n" data-glyph="0,0" class="t t"><span id="653bca6bfd5ee4d4">PageRenderer</span></a> : <a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="t t">VisualElementRenderer</a>&lt;<a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a>&gt;
	{
		<b>public override bool</b> <a id="c036cc5e1484330f" href="../R/c036cc5e1484330f.html" target="n" data-glyph="72,1" class="i method">OnTouchEvent</a>(<span class="i">MotionEvent</span> <span id="r0 rd" class="r0 r">e</span>)
		{
			<a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="k">base</a>.<a href="../VisualElementRenderer.cs.html#3fc7ac71dca07dbc" class="i method">OnTouchEvent</a>(<span class="r0 r">e</span>);
 
			<b>return true</b>;
		}
 
		<a href="/Xamarin.Forms.Core/A.html#b23cf6cd1d6182c9" class="t t">IPageController</a> <a id="680fcb2850ec2cfd" href="../R/680fcb2850ec2cfd.html" target="n" data-glyph="106,1" class="i property">PageController</a> =&gt; <a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#b23cf6cd1d6182c9" class="t t">IPageController</a>;
 
		<b>double</b> <a id="92899895f6ac95d0" href="../R/92899895f6ac95d0.html" target="n" data-glyph="46,1" class="i field">_previousHeight</a>;
 
		<b>protected override void</b> <a id="81b6a803272bde65" href="../R/81b6a803272bde65.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r1 rd" class="r1 r">disposing</span>)
		{
			<a href="#680fcb2850ec2cfd" class="i property">PageController</a>?.<span class="i">SendDisappearing</span>();
			<a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="k">base</a>.<a href="../VisualElementRenderer.cs.html#7e4c679353a39ac7" class="i method">Dispose</a>(<span class="r1 r">disposing</span>);
		}
 
		<b>protected override void</b> <a id="bfd2e076f9a5b69e" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">OnAttachedToWindow</a>()
		{
			<a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="k">base</a>.<span class="i">OnAttachedToWindow</span>();
			<a href="PageContainer.cs.html#850efedae0cd1f03" class="k">var</a> <span id="r2 rd" class="r2 r">pageContainer</span> = <span class="i">Parent</span> <b>as</b> <a href="PageContainer.cs.html#850efedae0cd1f03" class="t t">PageContainer</a>;
			<b>if</b> (<span class="r2 r">pageContainer</span> != <b>null</b> &amp;&amp; (<span class="r2 r">pageContainer</span>.<a href="PageContainer.cs.html#3c2096d71a1b3e6b" class="i property">IsInFragment</a> || <span class="r2 r">pageContainer</span>.<span class="i">Visibility</span> == <span class="i">ViewStates</span>.<span class="i">Gone</span>))
				<b>return</b>;
			<a href="#680fcb2850ec2cfd" class="i property">PageController</a>.<span class="i">SendAppearing</span>();
		}
 
		<b>protected override void</b> <a id="21027bba7646706d" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">OnDetachedFromWindow</a>()
		{
			<a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="k">base</a>.<span class="i">OnDetachedFromWindow</span>();
			<a href="PageContainer.cs.html#850efedae0cd1f03" class="k">var</a> <span id="r3 rd" class="r3 r">pageContainer</span> = <span class="i">Parent</span> <b>as</b> <a href="PageContainer.cs.html#850efedae0cd1f03" class="t t">PageContainer</a>;
			<b>if</b> (<span class="r3 r">pageContainer</span> != <b>null</b> &amp;&amp; <span class="r3 r">pageContainer</span>.<a href="PageContainer.cs.html#3c2096d71a1b3e6b" class="i property">IsInFragment</a>)
				<b>return</b>;
			<a href="#680fcb2850ec2cfd" class="i property">PageController</a>.<span class="i">SendDisappearing</span>();
		}
 
		<b>protected override void</b> <a id="502f4e5c1d781e7b" href="../R/502f4e5c1d781e7b.html" target="n" data-glyph="75,1" class="i method">OnElementChanged</a>(<a href="../ElementChangedEventArgs.cs.html#9a1366c2961f4fde" class="t t">ElementChangedEventArgs</a>&lt;<a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a>&gt; <span id="r4 rd" class="r4 r">e</span>)
		{
			<a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a> <span id="r5 rd" class="r5 r">view</span> = <span class="r4 r">e</span>.<a href="../ElementChangedEventArgs.cs.html#791644a1727a7988" class="i property">NewElement</a>;
			<a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="k">base</a>.<a href="../VisualElementRenderer.cs.html#48f7eabe0c8c2b33" class="i method">OnElementChanged</a>(<span class="r4 r">e</span>);
 
			<b>if</b> (<span class="i">Id</span> == <span class="i">NoId</span>)
			{
				<span class="i">Id</span> = <a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#9fd6596afa9dfc79" class="i method">GenerateViewId</a>();
			}
 
			<a href="#702a1e519c61c5e6" class="i method">UpdateBackgroundColor</a>(<span class="r5 r">view</span>);
			<a href="#b5a44820a5b27869" class="i method">UpdateBackgroundImage</a>(<span class="r5 r">view</span>);
 
			<span class="i">Clickable</span> = <b>true</b>;
		}
 
		<b>protected override void</b> <a id="03c24bec20b1f707" href="../R/03c24bec20b1f707.html" target="n" data-glyph="75,1" class="i method">OnElementPropertyChanged</a>(<b>object</b> <span id="r6 rd" class="r6 r">sender</span>, <span class="i">PropertyChangedEventArgs</span> <span id="r7 rd" class="r7 r">e</span>)
		{
			<a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="k">base</a>.<a href="../VisualElementRenderer.cs.html#a2a35e77093e6122" class="i method">OnElementPropertyChanged</a>(<span class="r6 r">sender</span>, <span class="r7 r">e</span>);
			<b>if</b> (<span class="r7 r">e</span>.<span class="i">PropertyName</span> == <a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a>.<a href="/Xamarin.Forms.Core/A.html#5fa4b1c7af0e0fd6" class="i field">BackgroundImageProperty</a>.<a href="/Xamarin.Forms.Core/A.html#3e8a9f30dd5c9578" class="i property">PropertyName</a>)
				<a href="#b5a44820a5b27869" class="i method">UpdateBackgroundImage</a>(<a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a>);
			<b>else if</b> (<span class="r7 r">e</span>.<span class="i">PropertyName</span> == <a href="/Xamarin.Forms.Core/A.html#daf307b67182d7d7" class="t t">VisualElement</a>.<a href="/Xamarin.Forms.Core/A.html#4d5a7481d6e7289d" class="i field">BackgroundColorProperty</a>.<a href="/Xamarin.Forms.Core/A.html#3e8a9f30dd5c9578" class="i property">PropertyName</a>)
				<a href="#702a1e519c61c5e6" class="i method">UpdateBackgroundColor</a>(<a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a>);
			<b>else if</b> (<span class="r7 r">e</span>.<span class="i">PropertyName</span> == <a href="/Xamarin.Forms.Core/A.html#daf307b67182d7d7" class="t t">VisualElement</a>.<a href="/Xamarin.Forms.Core/A.html#bd8332aab95ecbe7" class="i field">HeightProperty</a>.<a href="/Xamarin.Forms.Core/A.html#3e8a9f30dd5c9578" class="i property">PropertyName</a>)
				<a href="#b7e456974cda7602" class="i method">UpdateHeight</a>();
		}
 
		<b>void</b> <a id="b7e456974cda7602" href="../R/b7e456974cda7602.html" target="n" data-glyph="76,1" class="i method">UpdateHeight</a>()
		{
			<span class="c">// Handle size changes because of the soft keyboard (there&#39;s probably a more elegant solution to this)</span>
 
			<span class="c">// This is only necessary if:</span>
			<span class="c">// - we&#39;re navigating back from a page where the soft keyboard was open when the user hit the Navigation Bar &#39;back&#39; button</span>
			<span class="c">// - the Application&#39;s content height has changed because WindowSoftInputModeAdjust was set to Resize</span>
			<span class="c">// - the height has increased (in other words, the last layout was with the keyboard open, and now it&#39;s closed)</span>
			<b>var</b> <span id="r8 rd" class="r8 r">newHeight</span> = <a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a>.<a href="/Xamarin.Forms.Core/A.html#5d4bfa7087771a1d" class="i property">Height</a>;
 
			<b>if</b> (<a href="#92899895f6ac95d0" class="i field">_previousHeight</a> &gt; 0 &amp;&amp; <span class="r8 r">newHeight</span> &gt; <a href="#92899895f6ac95d0" class="i field">_previousHeight</a>)
			{
				<a href="/Xamarin.Forms.Core/A.html#e1264a5a1d22c3f2" class="k">var</a> <span id="r9 rd" class="r9 r">nav</span> = <a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a>.<a href="/Xamarin.Forms.Core/A.html#0621720042f94078" class="i property">Navigation</a>;
 
				<span class="c">// This update check will fire for all the pages on the stack, but we only need to request a layout for the top one</span>
				<b>if</b> (<span class="r9 r">nav</span>?.<a href="/Xamarin.Forms.Core/A.html#483e2a08ed160ea4" class="i property">NavigationStack</a> != <b>null</b> &amp;&amp; <span class="r9 r">nav</span>.<a href="/Xamarin.Forms.Core/A.html#483e2a08ed160ea4" class="i property">NavigationStack</a>.<span class="i">Count</span> &gt; 0 &amp;&amp; <a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a> == <span class="r9 r">nav</span>.<a href="/Xamarin.Forms.Core/A.html#483e2a08ed160ea4" class="i property">NavigationStack</a>[<span class="r9 r">nav</span>.<a href="/Xamarin.Forms.Core/A.html#483e2a08ed160ea4" class="i property">NavigationStack</a>.<span class="i">Count</span> - 1])
				{
					<span class="c">// The Forms layout stuff is already correct, we just need to force Android to catch up</span>
					<span class="i">RequestLayout</span>();
				}
			}
 
			<span class="c">// Cache the height for next time</span>
			<a href="#92899895f6ac95d0" class="i field">_previousHeight</a> = <span class="r8 r">newHeight</span>;
		}
 
		<b>void</b> <a id="702a1e519c61c5e6" href="../R/702a1e519c61c5e6.html" target="n" data-glyph="76,1" class="i method">UpdateBackgroundColor</a>(<a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a> <span id="r10 rd" class="r10 r">view</span>)
		{
			<b>if</b> (<span class="r10 r">view</span>.<a href="/Xamarin.Forms.Core/A.html#8c7f2e13366d12d5" class="i property">BackgroundColor</a> != <a href="/Xamarin.Forms.Core/A.html#8a6a061540451ec4" class="t t">Color</a>.<a href="/Xamarin.Forms.Core/A.html#78f150ac7d83a2c8" class="i property">Default</a>)
				<span class="i">SetBackgroundColor</span>(<span class="r10 r">view</span>.<a href="/Xamarin.Forms.Core/A.html#8c7f2e13366d12d5" class="i property">BackgroundColor</a>.<a href="../ColorExtensions.cs.html#268d9eb79e3a1fda" class="i method">ToAndroid</a>());
		}
 
		<b>void</b> <a id="b5a44820a5b27869" href="../R/b5a44820a5b27869.html" target="n" data-glyph="76,1" class="i method">UpdateBackgroundImage</a>(<a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a> <span id="r11 rd" class="r11 r">view</span>)
		{
			<b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r11 r">view</span>.<a href="/Xamarin.Forms.Core/A.html#b18578f2d0fac208" class="i property">BackgroundImage</a>))
				<a href="#6865490a635efa0c" class="k">this</a>.<span class="i">SetBackground</span>(<span class="i">Context</span>.<span class="i">Resources</span>.<span class="i">GetDrawable</span>(<span class="r11 r">view</span>.<a href="/Xamarin.Forms.Core/A.html#b18578f2d0fac208" class="i property">BackgroundImage</a>));
		}
	}
}</pre></td></tr></table></div></body></html>
