<!DOCTYPE html>
<html><head><title>CarouselPageAdapter.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(158);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="Xamarin.Forms.Platform.Android/Renderers/CarouselPageAdapter.cs" target="_top">Renderers\CarouselPageAdapter.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xamarin.Forms.Platform.Android" target="_top">Xamarin.Forms.Platform.Android\Xamarin.Forms.Platform.Android.csproj</a> (Xamarin.Forms.Platform.Android)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Specialized</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Content</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Support</span>.<span class="i">V4</span>.<span class="i">View</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Views</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Internals</span>;
<b>using</b> <span class="i">Object</span> = <span class="i n">Java</span>.<span class="i">Lang</span>.<span class="i">Object</span>;
 
<b>namespace</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Platform</span>.<span class="i n">Android</span>
{
	<b>internal class</b> <a id="a339ec8b46241a77" href="../R/a339ec8b46241a77.html" target="n" data-glyph="2,0" class="t t">CarouselPageAdapter</a> : <span class="i">PagerAdapter</span>, <span class="i">ViewPager</span>.<span class="i">IOnPageChangeListener</span>
	{
		<b>readonly</b> <span class="i">Context</span> <a id="d897604cee84640f" href="../R/d897604cee84640f.html" target="n" data-glyph="46,1" class="i field">_context</a>;
		<b>readonly</b> <span class="i">ViewPager</span> <a id="4b45187daef9ac80" href="../R/4b45187daef9ac80.html" target="n" data-glyph="46,1" class="i field">_pager</a>;
		<b>bool</b> <a id="22db5fcc6de93fa7" href="../R/22db5fcc6de93fa7.html" target="n" data-glyph="46,1" class="i field">_ignoreAndroidSelection</a>;
		<a href="/Xamarin.Forms.Core/A.html#efe3ef8da06691e9" class="t t">CarouselPage</a> <a id="0b971bc8263485cb" href="../R/0b971bc8263485cb.html" target="n" data-glyph="46,1" class="i field">_page</a>;
 
		<a href="/Xamarin.Forms.Core/A.html#abc33db1a216ce31" class="t t">IElementController</a> <a id="7b978f6ff4eaf6fe" href="../R/7b978f6ff4eaf6fe.html" target="n" data-glyph="106,1" class="i property">ElementController</a> =&gt; <a href="#0b971bc8263485cb" class="i field">_page</a> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#abc33db1a216ce31" class="t t">IElementController</a>;
 
		<b>public</b> <a id="a5db557565ab7703" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i constructor">CarouselPageAdapter</a>(<span class="i">ViewPager</span> <span id="r0 rd" class="r0 r">pager</span>, <a href="/Xamarin.Forms.Core/A.html#efe3ef8da06691e9" class="t t">CarouselPage</a> <span id="r1 rd" class="r1 r">page</span>, <span class="i">Context</span> <span id="r2 rd" class="r2 r">context</span>)
		{
			<a href="#4b45187daef9ac80" class="i field">_pager</a> = <span class="r0 r">pager</span>;
			<a href="#0b971bc8263485cb" class="i field">_page</a> = <span class="r1 r">page</span>;
			<a href="#d897604cee84640f" class="i field">_context</a> = <span class="r2 r">context</span>;
 
			<span class="r1 r">page</span>.<a href="/Xamarin.Forms.Core/A.html#439505adc80c62bd" class="i">PagesChanged</a> += <span class="i">OnPagesChanged</span>;
		}
 
		<b>public override int</b> <a id="44f6d54f50cce088" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Count</a>
		{
			<b>get</b> { <b>return</b> <a href="#0b971bc8263485cb" class="i field">_page</a>.<a href="/Xamarin.Forms.Core/A.html#a42e2d50a9c517c2" class="i property">Children</a>.<span class="i">Count</span>(); }
		}
 
		<b>public void</b> <a id="8d65597c23029cd9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OnPageScrolled</a>(<b>int</b> <span id="r3 rd" class="r3 r">position</span>, <b>float</b> <span id="r4 rd" class="r4 r">positionOffset</span>, <b>int</b> <span id="r5 rd" class="r5 r">positionOffsetPixels</span>)
		{
		}
 
		<b>public void</b> <a id="f4117c77d8219c07" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OnPageScrollStateChanged</a>(<b>int</b> <span id="r6 rd" class="r6 r">state</span>)
		{
		}
 
		<b>public void</b> <a id="6a0d760abc76c48e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">OnPageSelected</a>(<b>int</b> <span id="r7 rd" class="r7 r">position</span>)
		{
			<b>if</b> (<a href="#22db5fcc6de93fa7" class="i field">_ignoreAndroidSelection</a>)
				<b>return</b>;
 
			<b>int</b> <span id="r8 rd" class="r8 r">currentItem</span> = <a href="#4b45187daef9ac80" class="i field">_pager</a>.<span class="i">CurrentItem</span>;
			<a href="#0b971bc8263485cb" class="i field">_page</a>.<span class="i">CurrentPage</span> = <span class="r8 r">currentItem</span> &gt;= 0 &amp;&amp; <span class="r8 r">currentItem</span> &lt; <a href="#7b978f6ff4eaf6fe" class="i property">ElementController</a>.<a href="/Xamarin.Forms.Core/A.html#cbe8ebab3c282a32" class="i property">LogicalChildren</a>.<span class="i">Count</span> ? <a href="#7b978f6ff4eaf6fe" class="i property">ElementController</a>.<a href="/Xamarin.Forms.Core/A.html#cbe8ebab3c282a32" class="i property">LogicalChildren</a>[<span class="r8 r">currentItem</span>] <b>as</b> <a href="/Xamarin.Forms.Core/A.html#2f77fd3b834f8534" class="t t">ContentPage</a> : <b>null</b>;
		}
 
		<b>public override void</b> <a id="5cec2d1cd8515cde" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DestroyItem</a>(<span class="i">ViewGroup</span> <span id="r9 rd" class="r9 r">p0</span>, <b>int</b> <span id="r10 rd" class="r10 r">p1</span>, <span class="i">Object</span> <span id="r11 rd" class="r11 r">p2</span>)
		{
			<a href="ObjectJavaBox.cs.html#f73354f0f1492f47" class="k">var</a> <span id="r12 rd" class="r12 r">holder</span> = (<a href="ObjectJavaBox.cs.html#f73354f0f1492f47" class="t t">ObjectJavaBox</a>&lt;<span class="i">Tuple</span>&lt;<span class="i">ViewGroup</span>, <a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a>, <b>int</b>&gt;&gt;)<span class="r11 r">p2</span>;
			<a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a> <span id="r13 rd" class="r13 r">destroyedPage</span> = <span class="r12 r">holder</span>.<a href="ObjectJavaBox.cs.html#12eca4d745994d9f" class="i property">Instance</a>.<span class="i">Item2</span>;
 
			<a href="../IVisualElementRenderer.cs.html#0736b5467d596326" class="t t">IVisualElementRenderer</a> <span id="r14 rd" class="r14 r">renderer</span> = <a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#1b78ee69c66639c4" class="i method">GetRenderer</a>(<span class="r13 r">destroyedPage</span>);
			<span class="r14 r">renderer</span>.<a href="../IVisualElementRenderer.cs.html#0c96abedd7d8e58d" class="i property">View</a>.<a href="../ViewExtensions.cs.html#ed54340ae84abc92" class="i method">RemoveFromParent</a>();
			<span class="r12 r">holder</span>.<a href="ObjectJavaBox.cs.html#12eca4d745994d9f" class="i property">Instance</a>.<span class="i">Item1</span>.<span class="i">RemoveFromParent</span>();
		}
 
		<b>public override int</b> <a id="440eacece1cd2c66" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetItemPosition</a>(<span class="i">Object</span> <span id="r15 rd" class="r15 r">item</span>)
		{
			<span class="c">// The int is the current index.</span>
			<a href="ObjectJavaBox.cs.html#f73354f0f1492f47" class="k">var</a> <span id="r16 rd" class="r16 r">holder</span> = (<a href="ObjectJavaBox.cs.html#f73354f0f1492f47" class="t t">ObjectJavaBox</a>&lt;<span class="i">Tuple</span>&lt;<span class="i">ViewGroup</span>, <a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a>, <b>int</b>&gt;&gt;)<span class="r15 r">item</span>;
			<a href="/Xamarin.Forms.Core/A.html#76098df8350c0484" class="t t">Element</a> <span id="r17 rd" class="r17 r">parent</span> = <span class="r16 r">holder</span>.<a href="ObjectJavaBox.cs.html#12eca4d745994d9f" class="i property">Instance</a>.<span class="i">Item2</span>.<span class="i">RealParent</span>;
			<b>if</b> (<span class="r17 r">parent</span> == <b>null</b>)
				<b>return</b> <span class="i">PositionNone</span>;
 
			<span class="c">// Unfortunately we can&#39;t just call CarouselPage.GetIndex, because we need to know</span>
			<span class="c">// if the item has been removed. We could update MultiPage&lt;T&gt; to set removed items&#39; index</span>
			<span class="c">// to -1 to support this if it ever becomes an issue.</span>
			<b>int</b> <span id="r18 rd" class="r18 r">index</span> = ((<a href="/Xamarin.Forms.Core/A.html#efe3ef8da06691e9" class="t t">CarouselPage</a>)<span class="r17 r">parent</span>).<a href="/Xamarin.Forms.Core/A.html#a42e2d50a9c517c2" class="i property">Children</a>.<span class="i">IndexOf</span>(<span class="r16 r">holder</span>.<a href="ObjectJavaBox.cs.html#12eca4d745994d9f" class="i property">Instance</a>.<span class="i">Item2</span>);
			<b>if</b> (<span class="r18 r">index</span> == -1)
				<b>return</b> <span class="i">PositionNone</span>;
 
			<b>if</b> (<span class="r18 r">index</span> != <span class="r16 r">holder</span>.<a href="ObjectJavaBox.cs.html#12eca4d745994d9f" class="i property">Instance</a>.<span class="i">Item3</span>)
			{
				<span class="r16 r">holder</span>.<a href="ObjectJavaBox.cs.html#12eca4d745994d9f" class="i property">Instance</a> = <b>new</b> <span class="i">Tuple</span>&lt;<span class="i">ViewGroup</span>, <a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a>, <b>int</b>&gt;(<span class="r16 r">holder</span>.<a href="ObjectJavaBox.cs.html#12eca4d745994d9f" class="i property">Instance</a>.<span class="i">Item1</span>, <span class="r16 r">holder</span>.<a href="ObjectJavaBox.cs.html#12eca4d745994d9f" class="i property">Instance</a>.<span class="i">Item2</span>, <span class="r18 r">index</span>);
				<b>return</b> <span class="r18 r">index</span>;
			}
 
			<b>return</b> <span class="i">PositionUnchanged</span>;
		}
 
		<b>public override</b> <span class="i">Object</span> <a id="060c11dba1c59b53" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">InstantiateItem</a>(<span class="i">ViewGroup</span> <span id="r19 rd" class="r19 r">container</span>, <b>int</b> <span id="r20 rd" class="r20 r">position</span>)
		{
			<a href="/Xamarin.Forms.Core/A.html#2f77fd3b834f8534" class="t t">ContentPage</a> <span id="r21 rd" class="r21 r">child</span> = <a href="#0b971bc8263485cb" class="i field">_page</a>.<a href="/Xamarin.Forms.Core/A.html#a42e2d50a9c517c2" class="i property">Children</a>.<span class="i">ElementAt</span>(<span class="r20 r">position</span>);
			<b>if</b> (<a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#1b78ee69c66639c4" class="i method">GetRenderer</a>(<span class="r21 r">child</span>) == <b>null</b>)
				<a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#fd4d9b7c2836c5e6" class="i method">SetRenderer</a>(<span class="r21 r">child</span>, <a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#4ec2143da4c61d5f" class="i method">CreateRenderer</a>(<span class="r21 r">child</span>));
 
			<a href="../IVisualElementRenderer.cs.html#0736b5467d596326" class="t t">IVisualElementRenderer</a> <span id="r22 rd" class="r22 r">renderer</span> = <a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#1b78ee69c66639c4" class="i method">GetRenderer</a>(<span class="r21 r">child</span>);
			<span class="r22 r">renderer</span>.<a href="../IVisualElementRenderer.cs.html#0c96abedd7d8e58d" class="i property">View</a>.<a href="../ViewExtensions.cs.html#ed54340ae84abc92" class="i method">RemoveFromParent</a>();
 
			<span class="i">ViewGroup</span> <span id="r23 rd" class="r23 r">frame</span> = <b>new</b> <a href="PageContainer.cs.html#e454d48dc90f8658" class="t constructor">PageContainer</a>(<a href="#d897604cee84640f" class="i field">_context</a>, <span class="r22 r">renderer</span>);
 
			<span class="r19 r">container</span>.<span class="i">AddView</span>(<span class="r23 r">frame</span>);
 
			<b>return</b> <b>new</b> <a href="ObjectJavaBox.cs.html#f711b2ccc03ef70c" class="t constructor">ObjectJavaBox</a>&lt;<span class="i">Tuple</span>&lt;<span class="i">ViewGroup</span>, <a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a>, <b>int</b>&gt;&gt;(<b>new</b> <span class="i">Tuple</span>&lt;<span class="i">ViewGroup</span>, <a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a>, <b>int</b>&gt;(<span class="r23 r">frame</span>, <span class="r21 r">child</span>, <span class="r20 r">position</span>));
		}
 
		<b>public override bool</b> <a id="b91712c55e9a97f1" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IsViewFromObject</a>(<b>global</b>::<span class="i">Android</span>.<span class="i">Views</span>.<span class="i">View</span> <span id="r24 rd" class="r24 r">p0</span>, <span class="i">Object</span> <span id="r25 rd" class="r25 r">p1</span>)
		{
			<a href="ObjectJavaBox.cs.html#f73354f0f1492f47" class="k">var</a> <span id="r26 rd" class="r26 r">holder</span> = (<a href="ObjectJavaBox.cs.html#f73354f0f1492f47" class="t t">ObjectJavaBox</a>&lt;<span class="i">Tuple</span>&lt;<span class="i">ViewGroup</span>, <a href="/Xamarin.Forms.Core/A.html#d2450da355a1c8f2" class="t t">Page</a>, <b>int</b>&gt;&gt;)<span class="r25 r">p1</span>;
			<span class="i">ViewGroup</span> <span id="r27 rd" class="r27 r">frame</span> = <span class="r26 r">holder</span>.<a href="ObjectJavaBox.cs.html#12eca4d745994d9f" class="i property">Instance</a>.<span class="i">Item1</span>;
			<b>return</b> <span class="r24 r">p0</span> == <span class="r27 r">frame</span>;
		}
 
		<b>public void</b> <a id="7e260f837a604a26" href="../R/7e260f837a604a26.html" target="n" data-glyph="72,1" class="i method">UpdateCurrentItem</a>()
		{
			<b>if</b> (<a href="#0b971bc8263485cb" class="i field">_page</a>.<a href="/Xamarin.Forms.Core/A.html#ffbdb21cfc058aa9" class="i property">CurrentPage</a> == <b>null</b>)
				<b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="s">&quot;CarouselPage has no children.&quot;</span>);
 
			<b>int</b> <span id="r28 rd" class="r28 r">index</span> = <a href="/Xamarin.Forms.Core/A.html#efe3ef8da06691e9" class="t t">CarouselPage</a>.<span class="i">GetIndex</span>(<a href="#0b971bc8263485cb" class="i field">_page</a>.<a href="/Xamarin.Forms.Core/A.html#ffbdb21cfc058aa9" class="i property">CurrentPage</a>);
			<b>if</b> (<span class="r28 r">index</span> &gt;= 0 &amp;&amp; <span class="r28 r">index</span> &lt; <a href="#0b971bc8263485cb" class="i field">_page</a>.<a href="/Xamarin.Forms.Core/A.html#a42e2d50a9c517c2" class="i property">Children</a>.<span class="i">Count</span>)
				<a href="#4b45187daef9ac80" class="i field">_pager</a>.<span class="i">CurrentItem</span> = <span class="r28 r">index</span>;
		}
 
		<b>protected override void</b> <a id="43eb9a43ee03e5ae" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r29 rd" class="r29 r">disposing</span>)
		{
			<b>if</b> (<span class="r29 r">disposing</span> &amp;&amp; <a href="#0b971bc8263485cb" class="i field">_page</a> != <b>null</b>)
			{
				<b>foreach</b> (<a href="/Xamarin.Forms.Core/A.html#76098df8350c0484" class="t t">Element</a> <span id="r30 rd" class="r30 r">element</span> <b>in</b> <a href="#7b978f6ff4eaf6fe" class="i property">ElementController</a>.<a href="/Xamarin.Forms.Core/A.html#cbe8ebab3c282a32" class="i property">LogicalChildren</a>)
				{
					<a href="/Xamarin.Forms.Core/A.html#daf307b67182d7d7" class="k">var</a> <span id="r31 rd" class="r31 r">childPage</span> = <span class="r30 r">element</span> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#daf307b67182d7d7" class="t t">VisualElement</a>;
 
					<b>if</b> (<span class="r31 r">childPage</span> == <b>null</b>)
						<b>continue</b>;
 
					<a href="../IVisualElementRenderer.cs.html#0736b5467d596326" class="t t">IVisualElementRenderer</a> <span id="r32 rd" class="r32 r">childPageRenderer</span> = <a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#1b78ee69c66639c4" class="i method">GetRenderer</a>(<span class="r31 r">childPage</span>);
					<b>if</b> (<span class="r32 r">childPageRenderer</span> != <b>null</b>)
					{
						<span class="r32 r">childPageRenderer</span>.<a href="../IVisualElementRenderer.cs.html#0c96abedd7d8e58d" class="i property">View</a>.<a href="../ViewExtensions.cs.html#ed54340ae84abc92" class="i method">RemoveFromParent</a>();
						<span class="r32 r">childPageRenderer</span>.<span class="i">Dispose</span>();
						<a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#fd4d9b7c2836c5e6" class="i method">SetRenderer</a>(<span class="r31 r">childPage</span>, <b>null</b>);
					}
				}
				<a href="#0b971bc8263485cb" class="i field">_page</a>.<a href="/Xamarin.Forms.Core/A.html#439505adc80c62bd" class="i">PagesChanged</a> -= <span class="i">OnPagesChanged</span>;
				<a href="#0b971bc8263485cb" class="i field">_page</a> = <b>null</b>;
			}
			<b>base</b>.<span class="i">Dispose</span>(<span class="r29 r">disposing</span>);
		}
 
		<b>void</b> <a id="c410b42a048e2cf8" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">OnPagesChanged</a>(<b>object</b> <span id="r33 rd" class="r33 r">sender</span>, <span class="i">NotifyCollectionChangedEventArgs</span> <span id="r34 rd" class="r34 r">e</span>)
		{
			<a href="#22db5fcc6de93fa7" class="i field">_ignoreAndroidSelection</a> = <b>true</b>;
 
			<span class="i">NotifyDataSetChanged</span>();
 
			<a href="#22db5fcc6de93fa7" class="i field">_ignoreAndroidSelection</a> = <b>false</b>;
 
			<b>if</b> (<a href="#0b971bc8263485cb" class="i field">_page</a>.<a href="/Xamarin.Forms.Core/A.html#ffbdb21cfc058aa9" class="i property">CurrentPage</a> == <b>null</b>)
				<b>return</b>;
 
			<a href="#7e260f837a604a26" class="i method">UpdateCurrentItem</a>();
		}
	}
}</pre></td></tr></table></div></body></html>
