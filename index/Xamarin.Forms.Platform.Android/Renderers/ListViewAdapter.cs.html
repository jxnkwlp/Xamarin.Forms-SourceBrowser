<!DOCTYPE html>
<html><head><title>ListViewAdapter.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(656);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="Xamarin.Forms.Platform.Android/Renderers/ListViewAdapter.cs" target="_top">Renderers\ListViewAdapter.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xamarin.Forms.Platform.Android" target="_top">Xamarin.Forms.Platform.Android\Xamarin.Forms.Platform.Android.csproj</a> (Xamarin.Forms.Platform.Android)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Specialized</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Content</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Util</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Views</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Widget</span>;
<b>using</b> <span class="i">AView</span> = <span class="i">Android</span>.<span class="i">Views</span>.<span class="i">View</span>;
<b>using</b> <span class="i">AListView</span> = <span class="i">Android</span>.<span class="i">Widget</span>.<span class="i">ListView</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Internals</span>;
 
<b>namespace</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Platform</span>.<span class="i n">Android</span>
{
	<b>internal class</b> <a id="b87f4edfd60d1b0d" href="../R/b87f4edfd60d1b0d.html" target="n" data-glyph="2,0" class="t t">ListViewAdapter</a> : <a href="../CellAdapter.cs.html#1eafcf74c856323d" class="t t">CellAdapter</a>
	{
		<b>const int</b> <a id="6d410543f3db6c9c" href="../R/6d410543f3db6c9c.html" target="n" data-glyph="10,1" class="i field">DefaultGroupHeaderTemplateId</a> = 0;
		<b>const int</b> <a id="258067e84a8aa9d3" href="../R/258067e84a8aa9d3.html" target="n" data-glyph="10,1" class="i field">DefaultItemTemplateId</a> = 1;
 
		<b>static int</b> <a id="a0ae2593d2cf1c64" href="../R/a0ae2593d2cf1c64.html" target="n" data-glyph="46,1" class="i field">s_dividerHorizontalDarkId</a> = <b>int</b>.<span class="i">MinValue</span>;
 
		<b>internal static readonly</b> <a href="/Xamarin.Forms.Core/A.html#743d6dd5177e1828" class="t t">BindableProperty</a> <a id="332639fb2b3caf3d" href="../R/332639fb2b3caf3d.html" target="n" data-glyph="44,1" class="i field">IsSelectedProperty</a> = <a href="/Xamarin.Forms.Core/A.html#743d6dd5177e1828" class="t t">BindableProperty</a>.<span class="i">CreateAttached</span>(<span class="s">&quot;IsSelected&quot;</span>, <b>typeof</b>(<b>bool</b>), <b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>), <b>false</b>);
 
		<b>readonly</b> <span class="i">Context</span> <a id="e2a08c19f2601d45" href="../R/e2a08c19f2601d45.html" target="n" data-glyph="46,1" class="i field">_context</a>;
		<b>protected readonly</b> <a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="t t">ListView</a> <a id="3cec959272d1802e" href="../R/3cec959272d1802e.html" target="n" data-glyph="45,1" class="i field">_listView</a>;
		<b>readonly</b> <span class="i">AListView</span> <a id="a6cd07d4e29ffd87" href="../R/a6cd07d4e29ffd87.html" target="n" data-glyph="46,1" class="i field">_realListView</a>;
		<b>readonly</b> <span class="i">Dictionary</span>&lt;<a href="/Xamarin.Forms.Core/A.html#8bb08c0913bdfc63" class="t t">DataTemplate</a>, <b>int</b>&gt; <a id="6cc9dd721ec405bb" href="../R/6cc9dd721ec405bb.html" target="n" data-glyph="46,1" class="i field">_templateToId</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<a href="/Xamarin.Forms.Core/A.html#8bb08c0913bdfc63" class="t t">DataTemplate</a>, <b>int</b>&gt;();
		<b>int</b> <a id="5c043f1d54702cb4" href="../R/5c043f1d54702cb4.html" target="n" data-glyph="46,1" class="i field">_dataTemplateIncrementer</a> = 2; <span class="c">// lets start at not 0 because ... </span>
 
		<span class="c">// We will use _dataTemplateIncrementer to get the proper ViewType key for the item&#39;s DataTemplate and store these keys in  _templateToId.</span>
		<span class="c">// If an item does _not_ use a DataTemplate, then the ViewType key will be DefaultItemTemplateId (1) or DefaultGroupHeaderTemplateId (0).</span>
		<span class="c">// To prevent a conflict in the event that a ListView supports both templates and non-templates, we will start the DataTemplate key at 2.</span>
 
		<b>int</b> <a id="5d2f76e3dfbaf81f" href="../R/5d2f76e3dfbaf81f.html" target="n" data-glyph="46,1" class="i field">_listCount</a> = -1; <span class="c">// -1 we need to get count from the list</span>
		<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a> <a id="c9cb0879826d26ad" href="../R/c9cb0879826d26ad.html" target="n" data-glyph="46,1" class="i field">_enabledCheckCell</a>;
 
		<b>bool</b> <a id="1c41ba8cc986a1ee" href="../R/1c41ba8cc986a1ee.html" target="n" data-glyph="46,1" class="i field">_fromNative</a>;
		<span class="i">AView</span> <a id="0a8320a19f0b5354" href="../R/0a8320a19f0b5354.html" target="n" data-glyph="46,1" class="i field">_lastSelected</a>;
		<span class="i">WeakReference</span>&lt;<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt; <a id="14f795ec3797c272" href="../R/14f795ec3797c272.html" target="n" data-glyph="46,1" class="i field">_selectedCell</a>;
 
		<a href="/Xamarin.Forms.Core/A.html#1720dc26cd820061" class="t t">IListViewController</a> <a id="4b3be66f1bf2e802" href="../R/4b3be66f1bf2e802.html" target="n" data-glyph="106,1" class="i property">Controller</a> =&gt; <a href="#3cec959272d1802e" class="i field">_listView</a>;
		<b>protected</b> <a href="/Xamarin.Forms.Core/A.html#7d7c0ddfee2f7ca3" class="t t">ITemplatedItemsView</a>&lt;<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt; <a id="c031c4a6b8882eb9" href="../R/c031c4a6b8882eb9.html" target="n" data-glyph="105,1" class="i property">TemplatedItemsView</a> =&gt; <a href="#3cec959272d1802e" class="i field">_listView</a>;
 
		<b>public</b> <a id="68f680272636384d" href="../R/68f680272636384d.html" target="n" data-glyph="72,1" class="i constructor">ListViewAdapter</a>(<span class="i">Context</span> <span id="r0 rd" class="r0 r">context</span>, <span class="i">AListView</span> <span id="r1 rd" class="r1 r">realListView</span>, <a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="t t">ListView</a> <span id="r2 rd" class="r2 r">listView</span>) : <a href="../CellAdapter.cs.html#65feae30f68bae5c" class="k">base</a>(<span class="r0 r">context</span>)
		{
			<a href="#e2a08c19f2601d45" class="i field">_context</a> = <span class="r0 r">context</span>;
			<a href="#a6cd07d4e29ffd87" class="i field">_realListView</a> = <span class="r1 r">realListView</span>;
			<a href="#3cec959272d1802e" class="i field">_listView</a> = <span class="r2 r">listView</span>;
 
			<b>if</b> (<span class="r2 r">listView</span>.<a href="/Xamarin.Forms.Core/A.html#dfce6372456ec083" class="i property">SelectedItem</a> != <b>null</b>)
				<span class="i">SelectItem</span>(<span class="r2 r">listView</span>.<a href="/Xamarin.Forms.Core/A.html#dfce6372456ec083" class="i property">SelectedItem</a>);
 
			<a href="/Xamarin.Forms.Core/A.html#5fafd275375b1472" class="k">var</a> <span id="r3 rd" class="r3 r">templatedItems</span> = ((<a href="/Xamarin.Forms.Core/A.html#7d7c0ddfee2f7ca3" class="t t">ITemplatedItemsView</a>&lt;<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt;)<span class="r2 r">listView</span>).<a href="/Xamarin.Forms.Core/A.html#5c03fae343562417" class="i property">TemplatedItems</a>;
			<span class="r3 r">templatedItems</span>.<span class="i">CollectionChanged</span> += <span class="i">OnCollectionChanged</span>;
			<span class="r3 r">templatedItems</span>.<a href="/Xamarin.Forms.Core/A.html#8b023baeda1bdf2a" class="i">GroupedCollectionChanged</a> += <span class="i">OnGroupedCollectionChanged</span>;
			<span class="r2 r">listView</span>.<a href="/Xamarin.Forms.Core/A.html#b7f2960fb90d27ad" class="i">ItemSelected</a> += <span class="i">OnItemSelected</span>;
 
			<span class="r1 r">realListView</span>.<span class="i">OnItemClickListener</span> = <a href="#b87f4edfd60d1b0d" class="k">this</a>;
			<span class="r1 r">realListView</span>.<span class="i">OnItemLongClickListener</span> = <a href="#b87f4edfd60d1b0d" class="k">this</a>;
 
			<a href="/Xamarin.Forms.Core/A.html#2acea58e362089cf" class="k">var</a> <span id="r4 rd" class="r4 r">platform</span> = <a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#1b1e73276f1d0e92" class="i property">Platform</a>;
			<b>if</b> (<span class="r4 r">platform</span>.<span class="i">GetType</span>() == <b>typeof</b>(<span class="i n">AppCompat</span>.<a href="../AppCompat/Platform.cs.html#2431577fc7669ff2" class="t t">Platform</a>))
				<a href="/Xamarin.Forms.Core/A.html#68162056f69c1f2c" class="t t">MessagingCenter</a>.<span class="i">Subscribe</span>&lt;<span class="i n">AppCompat</span>.<a href="../AppCompat/Platform.cs.html#2431577fc7669ff2" class="t t">Platform</a>&gt;(<a href="#b87f4edfd60d1b0d" class="k">this</a>, <span class="i n">AppCompat</span>.<a href="../AppCompat/Platform.cs.html#2431577fc7669ff2" class="t t">Platform</a>.<a href="../AppCompat/Platform.cs.html#9cf35a9c7ab0b1fd" class="i field">CloseContextActionsSignalName</a>, <span id="r5 rd" class="r5 r">p</span> =&gt; <a href="../CellAdapter.cs.html#e814aed80e64ece4" class="i method">CloseContextActions</a>());
			<b>else</b>
				<a href="/Xamarin.Forms.Core/A.html#68162056f69c1f2c" class="t t">MessagingCenter</a>.<span class="i">Subscribe</span>&lt;<a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>&gt;(<a href="#b87f4edfd60d1b0d" class="k">this</a>, <a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#e84a19ea8295c04b" class="i field">CloseContextActionsSignalName</a>, <span id="r6 rd" class="r6 r">p</span> =&gt; <a href="../CellAdapter.cs.html#e814aed80e64ece4" class="i method">CloseContextActions</a>());
			<a href="#8cdf734c44cd57a3" class="i method">InvalidateCount</a>();
		}
 
		<b>public override int</b> <a id="69e09904557bd08c" href="../R/69e09904557bd08c.html" target="n" data-glyph="102,1" class="i property">Count</a>
		{
			<b>get</b>
			{
				<b>if</b> (<a href="#5d2f76e3dfbaf81f" class="i field">_listCount</a> == -1)
				{
					<a href="/Xamarin.Forms.Core/A.html#5fafd275375b1472" class="k">var</a> <span id="r7 rd" class="r7 r">templatedItems</span> = <a href="#c031c4a6b8882eb9" class="i property">TemplatedItemsView</a>.<a href="/Xamarin.Forms.Core/A.html#5c03fae343562417" class="i property">TemplatedItems</a>;
					<b>int</b> <span id="r8 rd" class="r8 r">count</span> = <span class="r7 r">templatedItems</span>.<span class="i">Count</span>;
 
					<b>if</b> (<a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#0b780b61bce76534" class="i property">IsGroupingEnabled</a>)
					{
						<b>for</b> (<b>var</b> <span id="r9 rd" class="r9 r">i</span> = 0; <span class="r9 r">i</span> &lt; <span class="r7 r">templatedItems</span>.<span class="i">Count</span>; <span class="r9 r">i</span>++)
							<span class="r8 r">count</span> += <span class="r7 r">templatedItems</span>.<span class="i">GetGroup</span>(<span class="r9 r">i</span>).<span class="i">Count</span>;
					}
 
					<a href="#5d2f76e3dfbaf81f" class="i field">_listCount</a> = <span class="r8 r">count</span>;
				}
				<b>return</b> <a href="#5d2f76e3dfbaf81f" class="i field">_listCount</a>;
			}
		}
 
		<b>public</b> <span class="i">AView</span> <a id="0e044392d76ff2dd" href="../R/0e044392d76ff2dd.html" target="n" data-glyph="102,1" class="i property">FooterView</a> { <b>get</b>; <b>set</b>; }
 
		<b>public override bool</b> <a id="ed585b18596f9c17" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">HasStableIds</a>
		{
			<b>get</b> { <b>return false</b>; }
		}
 
		<b>public</b> <span class="i">AView</span> <a id="8e20eba3448efe27" href="../R/8e20eba3448efe27.html" target="n" data-glyph="102,1" class="i property">HeaderView</a> { <b>get</b>; <b>set</b>; }
 
		<b>public bool</b> <a id="475bd1335ac9ea0a" href="../R/475bd1335ac9ea0a.html" target="n" data-glyph="102,1" class="i property">IsAttachedToWindow</a> { <b>get</b>; <b>set</b>; }
 
		<b>public override object</b> <a id="8396a617ceffcdfc" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="k">this</a>[<b>int</b> <span id="r10 rd" class="r10 r">index</span>]
		{
			<b>get</b>
			{
				<b>if</b> (<a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#0b780b61bce76534" class="i property">IsGroupingEnabled</a>)
				{
					<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a> <span id="r11 rd" class="r11 r">cell</span> = <a href="#d4d82e1086205bd0" class="i method">GetCellForPosition</a>(<span class="r10 r">index</span>);
					<b>return</b> <span class="r11 r">cell</span>.<a href="/Xamarin.Forms.Core/A.html#ec31b23be1ce91d4" class="i property">BindingContext</a>;
				}
 
				<b>return</b> <a href="#c031c4a6b8882eb9" class="i property">TemplatedItemsView</a>.<a href="/Xamarin.Forms.Core/A.html#0e47ced570157038" class="i property">ListProxy</a>[<span class="r10 r">index</span>];
			}
		}
 
		<b>public override int</b> <a id="dba210c03aa65726" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ViewTypeCount</a>
		{
			<b>get</b>
			{
				<span class="c">// We have a documented limit of 20 templates on Android.</span>
				<span class="c">// ViewTypes are selected on a zero-based index, so this count must be at least 20 + 1.</span>
				<span class="c">// Plus, we arbitrarily increased the index of the DataTemplate index by 2 (see _dataTemplateIncrementer).</span>
				<b>return</b> 23;
			}
		}
 
		<b>public override bool</b> <a id="a6da05bbb95a1718" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">AreAllItemsEnabled</a>()
		{
			<b>return false</b>;
		}
 
		<b>public override long</b> <a id="5501f1e234eac100" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetItemId</a>(<b>int</b> <span id="r12 rd" class="r12 r">position</span>)
		{
			<b>return</b> <span class="r12 r">position</span>;
		}
 
		<b>public override int</b> <a id="72c35368cf8afe6f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetItemViewType</a>(<b>int</b> <span id="r13 rd" class="r13 r">position</span>)
		{
			<b>var</b> <span id="r14 rd" class="r14 r">group</span> = 0;
			<b>var</b> <span id="r15 rd" class="r15 r">row</span> = 0;
			<a href="/Xamarin.Forms.Core/A.html#8bb08c0913bdfc63" class="t t">DataTemplate</a> <span id="r16 rd" class="r16 r">itemTemplate</span>;
			<b>if</b> (!<a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#0b780b61bce76534" class="i property">IsGroupingEnabled</a>)
				<span class="r16 r">itemTemplate</span> = <a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#e714497888d14198" class="i property">ItemTemplate</a>;
			<b>else</b>
			{
				<span class="r14 r">group</span> = <a href="#c031c4a6b8882eb9" class="i property">TemplatedItemsView</a>.<a href="/Xamarin.Forms.Core/A.html#5c03fae343562417" class="i property">TemplatedItems</a>.<span class="i">GetGroupIndexFromGlobal</span>(<span class="r13 r">position</span>, <b>out</b> <span class="r15 r">row</span>);
 
				<b>if</b> (<span class="r15 r">row</span> == 0)
				{
					<span class="r16 r">itemTemplate</span> = <a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#37d541414cc573e1" class="i property">GroupHeaderTemplate</a>;
					<b>if</b> (<span class="r16 r">itemTemplate</span> == <b>null</b>)
						<b>return</b> <a href="#6d410543f3db6c9c" class="i field">DefaultGroupHeaderTemplateId</a>;
				}
				<b>else</b>
				{
					<span class="r16 r">itemTemplate</span> = <a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#e714497888d14198" class="i property">ItemTemplate</a>;
					<span class="r15 r">row</span>--;
				}
			}
 
			<b>if</b> (<span class="r16 r">itemTemplate</span> == <b>null</b>)
				<b>return</b> <a href="#258067e84a8aa9d3" class="i field">DefaultItemTemplateId</a>;
 
			<a href="/Xamarin.Forms.Core/A.html#7935887479ca6f68" class="k">var</a> <span id="r17 rd" class="r17 r">selector</span> = <span class="r16 r">itemTemplate</span> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#7935887479ca6f68" class="t t">DataTemplateSelector</a>;
			<b>if</b> (<span class="r17 r">selector</span> != <b>null</b>)
			{
				<b>object</b> <span id="r18 rd" class="r18 r">item</span> = <b>null</b>;
				<b>if</b> (<a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#0b780b61bce76534" class="i property">IsGroupingEnabled</a>)
					<span class="r18 r">item</span> = <a href="#c031c4a6b8882eb9" class="i property">TemplatedItemsView</a>.<a href="/Xamarin.Forms.Core/A.html#5c03fae343562417" class="i property">TemplatedItems</a>.<span class="i">GetGroup</span>(<span class="r14 r">group</span>).<a href="/Xamarin.Forms.Core/A.html#95cf81e423c7f190" class="i property">ListProxy</a>[<span class="r15 r">row</span>];
				<b>else</b>
					<span class="r18 r">item</span> = <a href="#c031c4a6b8882eb9" class="i property">TemplatedItemsView</a>.<a href="/Xamarin.Forms.Core/A.html#5c03fae343562417" class="i property">TemplatedItems</a>.<a href="/Xamarin.Forms.Core/A.html#95cf81e423c7f190" class="i property">ListProxy</a>[<span class="r13 r">position</span>];
				<span class="r16 r">itemTemplate</span> = <span class="r17 r">selector</span>.<span class="i">SelectTemplate</span>(<span class="r18 r">item</span>, <a href="#3cec959272d1802e" class="i field">_listView</a>);
			}
			<b>int</b> <span id="r19 rd" class="r19 r">key</span>;
			<b>if</b> (!<a href="#6cc9dd721ec405bb" class="i field">_templateToId</a>.<span class="i">TryGetValue</span>(<span class="r16 r">itemTemplate</span>, <b>out</b> <span class="r19 r">key</span>))
			{
				<a href="#5c043f1d54702cb4" class="i field">_dataTemplateIncrementer</a>++;
				<span class="r19 r">key</span> = <a href="#5c043f1d54702cb4" class="i field">_dataTemplateIncrementer</a>;
				<a href="#6cc9dd721ec405bb" class="i field">_templateToId</a>[<span class="r16 r">itemTemplate</span>] = <span class="r19 r">key</span>;
			}
			<b>return</b> <span class="r19 r">key</span>;
		}
 
		<b>public override</b> <span class="i">AView</span> <a id="736723a953c6ec2b" href="../R/736723a953c6ec2b.html" target="n" data-glyph="72,1" class="i method">GetView</a>(<b>int</b> <span id="r20 rd" class="r20 r">position</span>, <span class="i">AView</span> <span id="r21 rd" class="r21 r">convertView</span>, <span class="i">ViewGroup</span> <span id="r22 rd" class="r22 r">parent</span>)
		{
			<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a> <span id="r23 rd" class="r23 r">cell</span> = <b>null</b>;
 
			<a href="/Xamarin.Forms.Core/A.html#527d949c0649c863" class="t t">Performance</a>.<span class="i">Start</span>();
 
			<a href="/Xamarin.Forms.Core/A.html#7325a6e87ebf132d" class="t t">ListViewCachingStrategy</a> <span id="r24 rd" class="r24 r">cachingStrategy</span> = <a href="#4b3be66f1bf2e802" class="i property">Controller</a>.<a href="/Xamarin.Forms.Core/A.html#2e24013a5f1a1226" class="i property">CachingStrategy</a>;
			<b>var</b> <span id="r25 rd" class="r25 r">nextCellIsHeader</span> = <b>false</b>;
			<b>if</b> (<span class="r24 r">cachingStrategy</span> == <a href="/Xamarin.Forms.Core/A.html#7325a6e87ebf132d" class="t t">ListViewCachingStrategy</a>.<a href="/Xamarin.Forms.Core/A.html#4e662ce81571ed35" class="i field">RetainElement</a> || <span class="r21 r">convertView</span> == <b>null</b>)
			{
				<b>if</b> (<a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#0b780b61bce76534" class="i property">IsGroupingEnabled</a>)
				{
					<span class="i">List</span>&lt;<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt; <span id="r26 rd" class="r26 r">cells</span> = <a href="#6106c74d0a8508cf" class="i method">GetCellsFromPosition</a>(<span class="r20 r">position</span>, 2);
					<b>if</b> (<span class="r26 r">cells</span>.<span class="i">Count</span> &gt; 0)
						<span class="r23 r">cell</span> = <span class="r26 r">cells</span>[0];
 
					<b>if</b> (<span class="r26 r">cells</span>.<span class="i">Count</span> == 2)
						<span class="r25 r">nextCellIsHeader</span> = <span class="r26 r">cells</span>[1].<span class="i">GetIsGroupHeader</span>&lt;<a href="/Xamarin.Forms.Core/A.html#e6e9068bbee42f54" class="t t">ItemsView</a>&lt;<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt;, <a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt;();
				}
 
				<b>if</b> (<span class="r23 r">cell</span> == <b>null</b>)
				{
					<span class="r23 r">cell</span> = <a href="#d4d82e1086205bd0" class="i method">GetCellForPosition</a>(<span class="r20 r">position</span>);
					<b>if</b> (<span class="r23 r">cell</span> == <b>null</b>)
						<b>return</b> <b>new</b> <span class="i">AView</span>(<a href="#e2a08c19f2601d45" class="i field">_context</a>);
				}
			}
 
			<b>var</b> <span id="r27 rd" class="r27 r">cellIsBeingReused</span> = <b>false</b>;
			<a href="ConditionalFocusLayout.cs.html#0e142ec5b1e2f3e3" class="k">var</a> <span id="r28 rd" class="r28 r">layout</span> = <span class="r21 r">convertView</span> <b>as</b> <a href="ConditionalFocusLayout.cs.html#0e142ec5b1e2f3e3" class="t t">ConditionalFocusLayout</a>;
			<b>if</b> (<span class="r28 r">layout</span> != <b>null</b>)
			{
				<span class="r27 r">cellIsBeingReused</span> = <b>true</b>;
				<span class="r21 r">convertView</span> = <span class="r28 r">layout</span>.<span class="i">GetChildAt</span>(0);
			}
			<b>else</b>
				<span class="r28 r">layout</span> = <b>new</b> <a href="ConditionalFocusLayout.cs.html#4b5701ea71cbcda5" class="t constructor">ConditionalFocusLayout</a>(<a href="#e2a08c19f2601d45" class="i field">_context</a>) { <span class="i">Orientation</span> = <span class="i">Orientation</span>.<span class="i">Vertical</span> };
 
			<b>if</b> (((<span class="r24 r">cachingStrategy</span> &amp; <a href="/Xamarin.Forms.Core/A.html#7325a6e87ebf132d" class="t t">ListViewCachingStrategy</a>.<a href="/Xamarin.Forms.Core/A.html#791a8ea6a96061a0" class="i field">RecycleElement</a>) != 0) &amp;&amp; <span class="r21 r">convertView</span> != <b>null</b>)
			{
				<a href="/Xamarin.Forms.Core/A.html#71fbb484073b15d1" class="k">var</a> <span id="r29 rd" class="r29 r">boxedCell</span> = <span class="r21 r">convertView</span> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#71fbb484073b15d1" class="t t">INativeElementView</a>;
				<b>if</b> (<span class="r29 r">boxedCell</span> == <b>null</b>)
				{
					<b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="s">$&quot;</span><span class="s">View for cell must implement </span>{<b>nameof</b>(<a href="/Xamarin.Forms.Core/A.html#71fbb484073b15d1" class="t t">INativeElementView</a>)}<span class="s"> to enable recycling.</span><span class="s">&quot;</span>);
				}
				<span class="r23 r">cell</span> = (<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>)<span class="r29 r">boxedCell</span>.<a href="/Xamarin.Forms.Core/A.html#2bd1b4b350c894af" class="i property">Element</a>;
 
				<span class="c">// We are going to re-set the Platform here because in some cases (headers mostly) its possible this is unset and</span>
				<span class="c">// when the binding context gets updated the measure passes will all fail. By applying this here the Update call</span>
				<span class="c">// further down will result in correct layouts.</span>
				<span class="r23 r">cell</span>.<span class="i">Platform</span> = <a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#1b1e73276f1d0e92" class="i property">Platform</a>;
 
				<a href="/Xamarin.Forms.Core/A.html#445c706db7510364" class="t t">ICellController</a> <span id="r30 rd" class="r30 r">cellController</span> = <span class="r23 r">cell</span>;
				<span class="r30 r">cellController</span>.<span class="i">SendDisappearing</span>();
 
				<b>int</b> <span id="r31 rd" class="r31 r">row</span> = <span class="r20 r">position</span>;
				<b>var</b> <span id="r32 rd" class="r32 r">group</span> = 0;
				<a href="/Xamarin.Forms.Core/A.html#5fafd275375b1472" class="k">var</a> <span id="r33 rd" class="r33 r">templatedItems</span> = <a href="#c031c4a6b8882eb9" class="i property">TemplatedItemsView</a>.<a href="/Xamarin.Forms.Core/A.html#5c03fae343562417" class="i property">TemplatedItems</a>;
				<b>if</b> (<a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#0b780b61bce76534" class="i property">IsGroupingEnabled</a>)
					<span class="r32 r">group</span> = <span class="r33 r">templatedItems</span>.<span class="i">GetGroupIndexFromGlobal</span>(<span class="r20 r">position</span>, <b>out</b> <span class="r31 r">row</span>);
 
				<a href="/Xamarin.Forms.Core/A.html#5fafd275375b1472" class="k">var</a> <span id="r34 rd" class="r34 r">templatedList</span> = <span class="r33 r">templatedItems</span>.<span class="i">GetGroup</span>(<span class="r32 r">group</span>);
 
				<b>if</b> (<a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#0b780b61bce76534" class="i property">IsGroupingEnabled</a>)
				{
					<b>if</b> (<span class="r31 r">row</span> == 0)
						<span class="r34 r">templatedList</span>.<span class="i">UpdateHeader</span>(<span class="r23 r">cell</span>, <span class="r32 r">group</span>);
					<b>else</b>
						<span class="r34 r">templatedList</span>.<span class="i">UpdateContent</span>(<span class="r23 r">cell</span>, <span class="r31 r">row</span> - 1);
				}
				<b>else</b>
					<span class="r34 r">templatedList</span>.<span class="i">UpdateContent</span>(<span class="r23 r">cell</span>, <span class="r31 r">row</span>);
 
				<span class="r30 r">cellController</span>.<span class="i">SendAppearing</span>();
 
				<b>if</b> (<span class="r23 r">cell</span>.<a href="/Xamarin.Forms.Core/A.html#ec31b23be1ce91d4" class="i property">BindingContext</a> == <a href="../CellAdapter.cs.html#2efde428e1c8aeb4" class="i property">ActionModeObject</a>)
				{
					<a href="../CellAdapter.cs.html#8e5cd0fd8cf704fa" class="i property">ActionModeContext</a> = <span class="r23 r">cell</span>;
					<a href="../CellAdapter.cs.html#b85e419687e53fd8" class="i property">ContextView</a> = <span class="r28 r">layout</span>;
				}
 
				<b>if</b> (<span class="i">ReferenceEquals</span>(<a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#dfce6372456ec083" class="i property">SelectedItem</a>, <span class="r23 r">cell</span>.<a href="/Xamarin.Forms.Core/A.html#ec31b23be1ce91d4" class="i property">BindingContext</a>))
					<span class="i">Select</span>(<a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#0b780b61bce76534" class="i property">IsGroupingEnabled</a> ? <span class="r31 r">row</span> - 1 : <span class="r31 r">row</span>, <span class="r28 r">layout</span>);
				<b>else if</b> (<span class="r23 r">cell</span>.<a href="/Xamarin.Forms.Core/A.html#ec31b23be1ce91d4" class="i property">BindingContext</a> == <a href="../CellAdapter.cs.html#2efde428e1c8aeb4" class="i property">ActionModeObject</a>)
					<span class="i">SetSelectedBackground</span>(<span class="r28 r">layout</span>, <b>true</b>);
				<b>else</b>
					<span class="i">UnsetSelectedBackground</span>(<span class="r28 r">layout</span>);
 
				<a href="/Xamarin.Forms.Core/A.html#527d949c0649c863" class="t t">Performance</a>.<span class="i">Stop</span>();
				<b>return</b> <span class="r28 r">layout</span>;
			}
 
			<span class="i">AView</span> <span id="r35 rd" class="r35 r">view</span> = <a href="../Cells/CellFactory.cs.html#596b29076b5af656" class="t t">CellFactory</a>.<a href="../Cells/CellFactory.cs.html#15504fe89a45dbad" class="i method">GetCell</a>(<span class="r23 r">cell</span>, <span class="r21 r">convertView</span>, <span class="r22 r">parent</span>, <a href="#e2a08c19f2601d45" class="i field">_context</a>, <a href="#3cec959272d1802e" class="i field">_listView</a>);
 
			<a href="/Xamarin.Forms.Core/A.html#527d949c0649c863" class="t t">Performance</a>.<span class="i">Start</span>(<span class="s">&quot;AddView&quot;</span>);
 
			<b>if</b> (<span class="r27 r">cellIsBeingReused</span>)
			{
				<b>if</b> (<span class="r21 r">convertView</span> != <span class="r35 r">view</span>)
				{
					<span class="r28 r">layout</span>.<span class="i">RemoveViewAt</span>(0);
					<span class="r28 r">layout</span>.<span class="i">AddView</span>(<span class="r35 r">view</span>, 0);
				}
			}
			<b>else</b>
				<span class="r28 r">layout</span>.<span class="i">AddView</span>(<span class="r35 r">view</span>, 0);
 
			<a href="/Xamarin.Forms.Core/A.html#527d949c0649c863" class="t t">Performance</a>.<span class="i">Stop</span>(<span class="s">&quot;AddView&quot;</span>);
 
			<b>bool</b> <span id="r36 rd" class="r36 r">isHeader</span> = <span class="r23 r">cell</span>.<span class="i">GetIsGroupHeader</span>&lt;<a href="/Xamarin.Forms.Core/A.html#e6e9068bbee42f54" class="t t">ItemsView</a>&lt;<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt;, <a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt;();
 
			<span class="i">AView</span> <span id="r37 rd" class="r37 r">bline</span>;
 
			<a href="#d1edb521da4082c7" class="i method">UpdateSeparatorVisibility</a>(<span class="r23 r">cell</span>, <span class="r27 r">cellIsBeingReused</span>, <span class="r36 r">isHeader</span>, <span class="r25 r">nextCellIsHeader</span>, <span class="r28 r">layout</span>, <b>out</b> <span class="r37 r">bline</span>);
 
			<a href="#9f5af43192b823ae" class="i method">UpdateSeparatorColor</a>(<span class="r36 r">isHeader</span>, <span class="r37 r">bline</span>);
 
			<b>if</b> ((<b>bool</b>)<span class="r23 r">cell</span>.<span class="i">GetValue</span>(<a href="#332639fb2b3caf3d" class="i field">IsSelectedProperty</a>))
				<span class="i">Select</span>(<span class="r20 r">position</span>, <span class="r28 r">layout</span>);
			<b>else</b>
				<span class="i">UnsetSelectedBackground</span>(<span class="r28 r">layout</span>);
 
			<span class="r28 r">layout</span>.<a href="ConditionalFocusLayout.cs.html#7a8c2614bd5dc3d6" class="i method">ApplyTouchListenersToSpecialCells</a>(<span class="r23 r">cell</span>);
 
			<a href="/Xamarin.Forms.Core/A.html#527d949c0649c863" class="t t">Performance</a>.<span class="i">Stop</span>();
 
			<b>return</b> <span class="r28 r">layout</span>;
		}
 
		<b>public override bool</b> <a id="c0dd7afc710a7ac6" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IsEnabled</a>(<b>int</b> <span id="r38 rd" class="r38 r">position</span>)
		{
			<a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="t t">ListView</a> <span id="r39 rd" class="r39 r">list</span> = <a href="#3cec959272d1802e" class="i field">_listView</a>;
 
			<a href="/Xamarin.Forms.Core/A.html#7d7c0ddfee2f7ca3" class="t t">ITemplatedItemsView</a>&lt;<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt; <span id="r40 rd" class="r40 r">templatedItemsView</span> = <span class="r39 r">list</span>;
			<b>if</b> (<span class="r39 r">list</span>.<a href="/Xamarin.Forms.Core/A.html#0b780b61bce76534" class="i property">IsGroupingEnabled</a>)
			{
				<b>int</b> <span id="r41 rd" class="r41 r">leftOver</span>;
				<span class="r40 r">templatedItemsView</span>.<a href="/Xamarin.Forms.Core/A.html#5c03fae343562417" class="i property">TemplatedItems</a>.<span class="i">GetGroupIndexFromGlobal</span>(<span class="r38 r">position</span>, <b>out</b> <span class="r41 r">leftOver</span>);
				<b>return</b> <span class="r41 r">leftOver</span> &gt; 0;
			}
 
			<a href="/Xamarin.Forms.Core/A.html#7325a6e87ebf132d" class="k">var</a> <span id="r42 rd" class="r42 r">strategy</span> = ((<a href="/Xamarin.Forms.Core/A.html#1720dc26cd820061" class="t t">IListViewController</a>)<span class="r39 r">list</span>).<a href="/Xamarin.Forms.Core/A.html#2e24013a5f1a1226" class="i property">CachingStrategy</a>;
			<b>if</b> ((<span class="r42 r">strategy</span> &amp; <a href="/Xamarin.Forms.Core/A.html#7325a6e87ebf132d" class="t t">ListViewCachingStrategy</a>.<a href="/Xamarin.Forms.Core/A.html#791a8ea6a96061a0" class="i field">RecycleElement</a>) != 0)
			{
				<b>if</b> (<a href="#c9cb0879826d26ad" class="i field">_enabledCheckCell</a> == <b>null</b>)
					<a href="#c9cb0879826d26ad" class="i field">_enabledCheckCell</a> = <a href="#d4d82e1086205bd0" class="i method">GetCellForPosition</a>(<span class="r38 r">position</span>);
				<b>else</b>
					<span class="r40 r">templatedItemsView</span>.<a href="/Xamarin.Forms.Core/A.html#5c03fae343562417" class="i property">TemplatedItems</a>.<span class="i">UpdateContent</span>(<a href="#c9cb0879826d26ad" class="i field">_enabledCheckCell</a>, <span class="r38 r">position</span>);
				<b>return</b> <a href="#c9cb0879826d26ad" class="i field">_enabledCheckCell</a>.<a href="/Xamarin.Forms.Core/A.html#b8771aed49c9b0ce" class="i property">IsEnabled</a>;
			}
 
			<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a> <span id="r43 rd" class="r43 r">item</span> = <a href="#d4d82e1086205bd0" class="i method">GetCellForPosition</a>(<span class="r38 r">position</span>);
			<b>return</b> <span class="r43 r">item</span>.<a href="/Xamarin.Forms.Core/A.html#b8771aed49c9b0ce" class="i property">IsEnabled</a>;
		}
 
		<b>protected override void</b> <a id="85b8fbb185bdf02e" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r44 rd" class="r44 r">disposing</span>)
		{
			<b>if</b> (<span class="r44 r">disposing</span>)
			{
				<a href="../CellAdapter.cs.html#e814aed80e64ece4" class="i method">CloseContextActions</a>();
 
				<a href="/Xamarin.Forms.Core/A.html#2acea58e362089cf" class="k">var</a> <span id="r45 rd" class="r45 r">platform</span> = <a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#1b1e73276f1d0e92" class="i property">Platform</a>;
				<b>if</b> (<span class="r45 r">platform</span>.<span class="i">GetType</span>() == <b>typeof</b>(<span class="i n">AppCompat</span>.<a href="../AppCompat/Platform.cs.html#2431577fc7669ff2" class="t t">Platform</a>))
					<a href="/Xamarin.Forms.Core/A.html#68162056f69c1f2c" class="t t">MessagingCenter</a>.<span class="i">Unsubscribe</span>&lt;<span class="i n">AppCompat</span>.<a href="../AppCompat/Platform.cs.html#2431577fc7669ff2" class="t t">Platform</a>&gt;(<a href="#b87f4edfd60d1b0d" class="k">this</a>, <a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#e84a19ea8295c04b" class="i field">CloseContextActionsSignalName</a>);
				<b>else</b>
					<a href="/Xamarin.Forms.Core/A.html#68162056f69c1f2c" class="t t">MessagingCenter</a>.<span class="i">Unsubscribe</span>&lt;<a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>&gt;(<a href="#b87f4edfd60d1b0d" class="k">this</a>, <a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#e84a19ea8295c04b" class="i field">CloseContextActionsSignalName</a>);
 
				<a href="#a6cd07d4e29ffd87" class="i field">_realListView</a>.<span class="i">OnItemClickListener</span> = <b>null</b>;
				<a href="#a6cd07d4e29ffd87" class="i field">_realListView</a>.<span class="i">OnItemLongClickListener</span> = <b>null</b>;
 
				<a href="/Xamarin.Forms.Core/A.html#5fafd275375b1472" class="k">var</a> <span id="r46 rd" class="r46 r">templatedItems</span> = <a href="#c031c4a6b8882eb9" class="i property">TemplatedItemsView</a>.<a href="/Xamarin.Forms.Core/A.html#5c03fae343562417" class="i property">TemplatedItems</a>;
				<span class="r46 r">templatedItems</span>.<span class="i">CollectionChanged</span> -= <span class="i">OnCollectionChanged</span>;
				<span class="r46 r">templatedItems</span>.<a href="/Xamarin.Forms.Core/A.html#8b023baeda1bdf2a" class="i">GroupedCollectionChanged</a> -= <span class="i">OnGroupedCollectionChanged</span>;
				<a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#b7f2960fb90d27ad" class="i">ItemSelected</a> -= <span class="i">OnItemSelected</span>;
 
				<b>if</b> (<a href="#0a8320a19f0b5354" class="i field">_lastSelected</a> != <b>null</b>)
				{
					<a href="#0a8320a19f0b5354" class="i field">_lastSelected</a>.<span class="i">Dispose</span>();
					<a href="#0a8320a19f0b5354" class="i field">_lastSelected</a> = <b>null</b>;
				}
 
				<a href="#2b78dccb58e5a98e" class="i method">DisposeCells</a>();
			}
 
			<a href="../CellAdapter.cs.html#1eafcf74c856323d" class="k">base</a>.<span class="i">Dispose</span>(<span class="r44 r">disposing</span>);
		}
 
		<b>protected override</b> <a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a> <a id="d4d82e1086205bd0" href="../R/d4d82e1086205bd0.html" target="n" data-glyph="75,1" class="i method">GetCellForPosition</a>(<b>int</b> <span id="r47 rd" class="r47 r">position</span>)
		{
			<b>return</b> <a href="#6106c74d0a8508cf" class="i method">GetCellsFromPosition</a>(<span class="r47 r">position</span>, 1).<span class="i">FirstOrDefault</span>();
		}
 
		<b>protected override void</b> <a id="ce69671178bad67d" href="../R/ce69671178bad67d.html" target="n" data-glyph="75,1" class="i method">HandleItemClick</a>(<span class="i">AdapterView</span> <span id="r48 rd" class="r48 r">parent</span>, <span class="i">AView</span> <span id="r49 rd" class="r49 r">view</span>, <b>int</b> <span id="r50 rd" class="r50 r">position</span>, <b>long</b> <span id="r51 rd" class="r51 r">id</span>)
		{
			<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a> <span id="r52 rd" class="r52 r">cell</span> = <b>null</b>;
 
			<b>if</b> ((<a href="#4b3be66f1bf2e802" class="i property">Controller</a>.<a href="/Xamarin.Forms.Core/A.html#2e24013a5f1a1226" class="i property">CachingStrategy</a> &amp; <a href="/Xamarin.Forms.Core/A.html#7325a6e87ebf132d" class="t t">ListViewCachingStrategy</a>.<a href="/Xamarin.Forms.Core/A.html#791a8ea6a96061a0" class="i field">RecycleElement</a>) != 0)
			{
				<span class="i">AView</span> <span id="r53 rd" class="r53 r">cellOwner</span> = <span class="r49 r">view</span>;
				<a href="ConditionalFocusLayout.cs.html#0e142ec5b1e2f3e3" class="k">var</a> <span id="r54 rd" class="r54 r">layout</span> = <span class="r53 r">cellOwner</span> <b>as</b> <a href="ConditionalFocusLayout.cs.html#0e142ec5b1e2f3e3" class="t t">ConditionalFocusLayout</a>;
				<b>if</b> (<span class="r54 r">layout</span> != <b>null</b>)
					<span class="r53 r">cellOwner</span> = <span class="r54 r">layout</span>.<span class="i">GetChildAt</span>(0);
				<span class="r52 r">cell</span> = (<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>)((<a href="/Xamarin.Forms.Core/A.html#71fbb484073b15d1" class="t t">INativeElementView</a>)<span class="r53 r">cellOwner</span>).<a href="/Xamarin.Forms.Core/A.html#2bd1b4b350c894af" class="i property">Element</a>;
			}
 
			<span class="c">// All our ListView&#39;s have called AddHeaderView. This effectively becomes index 0, so our index 0 is index 1 to the listView.</span>
			<span class="r50 r">position</span>--;
 
			<b>if</b> (<span class="r50 r">position</span> &lt; 0 || <span class="r50 r">position</span> &gt;= <a href="#69e09904557bd08c" class="i property">Count</a>)
				<b>return</b>;
 
			<b>if</b> (<a href="#0a8320a19f0b5354" class="i field">_lastSelected</a> != <span class="r49 r">view</span>)
				<a href="#1c41ba8cc986a1ee" class="i field">_fromNative</a> = <b>true</b>;
			<a href="#5e48b51f180df933" class="i method">Select</a>(<span class="r50 r">position</span>, <span class="r49 r">view</span>);
			<a href="#4b3be66f1bf2e802" class="i property">Controller</a>.<span class="i">NotifyRowTapped</span>(<span class="r50 r">position</span>, <span class="r52 r">cell</span>);
		}
 
		<b>void</b> <a id="2b78dccb58e5a98e" href="../R/2b78dccb58e5a98e.html" target="n" data-glyph="76,1" class="i method">DisposeCells</a>()
		{
			<b>var</b> <span id="r55 rd" class="r55 r">cellCount</span> = <a href="#a6cd07d4e29ffd87" class="i field">_realListView</a>?.<span class="i">ChildCount</span> ?? 0;
			<b>for</b> (<b>int</b> <span id="r56 rd" class="r56 r">i</span> = 0; <span class="r56 r">i</span> &lt; <span class="r55 r">cellCount</span>; <span class="r56 r">i</span>++)
			{
				<a href="ConditionalFocusLayout.cs.html#0e142ec5b1e2f3e3" class="k">var</a> <span id="r57 rd" class="r57 r">layout</span> = <a href="#a6cd07d4e29ffd87" class="i field">_realListView</a>.<span class="i">GetChildAt</span>(<span class="r56 r">i</span>) <b>as</b> <a href="ConditionalFocusLayout.cs.html#0e142ec5b1e2f3e3" class="t t">ConditionalFocusLayout</a>;
 
				<span class="c">// Headers and footers will be skipped. They are disposed elsewhere.</span>
				<b>if</b> (<span class="r57 r">layout</span> == <b>null</b> || <span class="r57 r">layout</span>.<span class="i">IsDisposed</span>())
					<b>continue</b>;
 
				<b>var</b> <span id="r58 rd" class="r58 r">renderedView</span> = <span class="r57 r">layout</span>?.<span class="i">GetChildAt</span>(0);
 
				<b>var</b> <span id="r59 rd" class="r59 r">element</span> = (<span class="r58 r">renderedView</span> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#71fbb484073b15d1" class="t t">INativeElementView</a>)?.<a href="/Xamarin.Forms.Core/A.html#2bd1b4b350c894af" class="i property">Element</a>;
 
				<b>var</b> <span id="r60 rd" class="r60 r">view</span> = (<span class="r59 r">element</span> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#080f860d2adf2a57" class="t t">ViewCell</a>)?.<a href="/Xamarin.Forms.Core/A.html#7e0120b037b3522c" class="i property">View</a>;
 
				<b>if</b> (<span class="r60 r">view</span> != <b>null</b>)
				{
					<a href="../IVisualElementRenderer.cs.html#0736b5467d596326" class="k">var</a> <span id="r61 rd" class="r61 r">renderer</span> = <a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<span class="i">GetRenderer</span>(<span class="r60 r">view</span>);
 
					<b>if</b> (<span class="r61 r">renderer</span> == <span class="r58 r">renderedView</span>)
						<span class="r59 r">element</span>.<span class="i">ClearValue</span>(<a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#cda3e6f7841c17d4" class="i field">RendererProperty</a>);
 
					<span class="r61 r">renderer</span>?.<span class="i">Dispose</span>();
					<span class="r61 r">renderer</span> = <b>null</b>;
				}
 
				<span class="r58 r">renderedView</span>?.<span class="i">Dispose</span>();
				<span class="r58 r">renderedView</span> = <b>null</b>;
			}
		}
 
		<span class="c">// TODO: We can optimize this by storing the last position, group index and global index</span>
		<span class="c">// and increment/decrement from that starting place.	</span>
		<span class="i">List</span>&lt;<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt; <a id="6106c74d0a8508cf" href="../R/6106c74d0a8508cf.html" target="n" data-glyph="76,1" class="i method">GetCellsFromPosition</a>(<b>int</b> <span id="r62 rd" class="r62 r">position</span>, <b>int</b> <span id="r63 rd" class="r63 r">take</span>)
		{
			<b>var</b> <span id="r64 rd" class="r64 r">cells</span> = <b>new</b> <span class="i">List</span>&lt;<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt;(<span class="r63 r">take</span>);
			<b>if</b> (<span class="r62 r">position</span> &lt; 0)
				<b>return</b> <span class="r64 r">cells</span>;
 
			<a href="/Xamarin.Forms.Core/A.html#5fafd275375b1472" class="k">var</a> <span id="r65 rd" class="r65 r">templatedItems</span> = <a href="#c031c4a6b8882eb9" class="i property">TemplatedItemsView</a>.<a href="/Xamarin.Forms.Core/A.html#5c03fae343562417" class="i property">TemplatedItems</a>;
			<b>var</b> <span id="r66 rd" class="r66 r">templatedItemsCount</span> = <span class="r65 r">templatedItems</span>.<span class="i">Count</span>;
			<b>if</b> (!<a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#0b780b61bce76534" class="i property">IsGroupingEnabled</a>)
			{
				<b>for</b> (<b>var</b> <span id="r67 rd" class="r67 r">x</span> = 0; <span class="r67 r">x</span> &lt; <span class="r63 r">take</span>; <span class="r67 r">x</span>++)
				{
					<b>if</b> (<span class="r62 r">position</span> + <span class="r67 r">x</span> &gt;= <span class="r66 r">templatedItemsCount</span>)
						<b>return</b> <span class="r64 r">cells</span>;
 
					<span class="r64 r">cells</span>.<span class="i">Add</span>(<span class="r65 r">templatedItems</span>[<span class="r67 r">x</span> + <span class="r62 r">position</span>]);
				}
 
				<b>return</b> <span class="r64 r">cells</span>;
			}
 
			<b>var</b> <span id="r68 rd" class="r68 r">i</span> = 0;
			<b>var</b> <span id="r69 rd" class="r69 r">global</span> = 0;
			<b>for</b> (; <span class="r68 r">i</span> &lt; <span class="r66 r">templatedItemsCount</span>; <span class="r68 r">i</span>++)
			{
				<a href="/Xamarin.Forms.Core/A.html#5fafd275375b1472" class="k">var</a> <span id="r70 rd" class="r70 r">group</span> = <span class="r65 r">templatedItems</span>.<span class="i">GetGroup</span>(<span class="r68 r">i</span>);
 
				<b>if</b> (<span class="r69 r">global</span> == <span class="r62 r">position</span> || <span class="r64 r">cells</span>.<span class="i">Count</span> &gt; 0)
				{
					<span class="c">//Always create a new cell if we are using the RecycleElement strategy</span>
					<b>var</b> <span id="r71 rd" class="r71 r">recycleElement</span> = (<a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#853e43c3430ca1d5" class="i property">CachingStrategy</a> &amp; <a href="/Xamarin.Forms.Core/A.html#7325a6e87ebf132d" class="t t">ListViewCachingStrategy</a>.<a href="/Xamarin.Forms.Core/A.html#791a8ea6a96061a0" class="i field">RecycleElement</a>) != 0;
					<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="k">var</a> <span id="r72 rd" class="r72 r">headerCell</span> = <span class="r71 r">recycleElement</span> ? <a href="#2f5c50f00bebc57c" class="i method">GetNewGroupHeaderCell</a>(<span class="r70 r">group</span>) : <span class="r70 r">group</span>.<a href="/Xamarin.Forms.Core/A.html#fa8a74b57ada932c" class="i property">HeaderContent</a>;
					<span class="r64 r">cells</span>.<span class="i">Add</span>(<span class="r72 r">headerCell</span>);
 
					<b>if</b> (<span class="r64 r">cells</span>.<span class="i">Count</span> == <span class="r63 r">take</span>)
						<b>return</b> <span class="r64 r">cells</span>;
				}
 
				<span class="r69 r">global</span>++;
 
				<b>if</b> (<span class="r69 r">global</span> + <span class="r70 r">group</span>.<span class="i">Count</span> &lt; <span class="r62 r">position</span>)
				{
					<span class="r69 r">global</span> += <span class="r70 r">group</span>.<span class="i">Count</span>;
					<b>continue</b>;
				}
 
				<b>for</b> (<b>var</b> <span id="r73 rd" class="r73 r">g</span> = 0; <span class="r73 r">g</span> &lt; <span class="r70 r">group</span>.<span class="i">Count</span>; <span class="r73 r">g</span>++)
				{
					<b>if</b> (<span class="r69 r">global</span> == <span class="r62 r">position</span> || <span class="r64 r">cells</span>.<span class="i">Count</span> &gt; 0)
					{
						<span class="r64 r">cells</span>.<span class="i">Add</span>(<span class="r70 r">group</span>[<span class="r73 r">g</span>]);
						<b>if</b> (<span class="r64 r">cells</span>.<span class="i">Count</span> == <span class="r63 r">take</span>)
							<b>return</b> <span class="r64 r">cells</span>;
					}
 
					<span class="r69 r">global</span>++;
				}
			}
 
			<b>return</b> <span class="r64 r">cells</span>;
		}
 
		<b>void</b> <a id="e9e9117419f04994" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">OnCollectionChanged</a>(<b>object</b> <span id="r74 rd" class="r74 r">sender</span>, <span class="i">NotifyCollectionChangedEventArgs</span> <span id="r75 rd" class="r75 r">e</span>)
		{
			<a href="#3ab31efee466bb9f" class="i method">OnDataChanged</a>();
		}
 
		<b>void</b> <a id="3ab31efee466bb9f" href="../R/3ab31efee466bb9f.html" target="n" data-glyph="76,1" class="i method">OnDataChanged</a>()
		{
			<a href="#8cdf734c44cd57a3" class="i method">InvalidateCount</a>();
			<b>if</b> (<a href="../CellAdapter.cs.html#8e5cd0fd8cf704fa" class="i property">ActionModeContext</a> != <b>null</b> &amp;&amp; !<a href="#c031c4a6b8882eb9" class="i property">TemplatedItemsView</a>.<a href="/Xamarin.Forms.Core/A.html#5c03fae343562417" class="i property">TemplatedItems</a>.<span class="i">Contains</span>(<a href="../CellAdapter.cs.html#8e5cd0fd8cf704fa" class="i property">ActionModeContext</a>))
				<a href="../CellAdapter.cs.html#e814aed80e64ece4" class="i method">CloseContextActions</a>();
 
			<b>if</b> (<a href="#475bd1335ac9ea0a" class="i property">IsAttachedToWindow</a>)
				<span class="i">NotifyDataSetChanged</span>();
			<b>else</b>
			{
				<span class="c">// In a TabbedPage page with two pages, Page A and Page B with ListView, if A changes B&#39;s ListView,</span>
				<span class="c">// we need to reset the ListView&#39;s adapter to reflect the changes on page B</span>
				<span class="c">// If there header and footer are present at the reset time of the adapter</span>
				<span class="c">// they will be DOUBLE added to the ViewGround (the ListView) causing indexes to be off by one. </span>
				<a href="#a6cd07d4e29ffd87" class="i field">_realListView</a>.<span class="i">RemoveHeaderView</span>(<a href="#8e20eba3448efe27" class="i property">HeaderView</a>);
				<a href="#a6cd07d4e29ffd87" class="i field">_realListView</a>.<span class="i">RemoveFooterView</span>(<a href="#0e044392d76ff2dd" class="i property">FooterView</a>);
				<a href="#a6cd07d4e29ffd87" class="i field">_realListView</a>.<span class="i">Adapter</span> = <a href="#a6cd07d4e29ffd87" class="i field">_realListView</a>.<span class="i">Adapter</span>;
				<a href="#a6cd07d4e29ffd87" class="i field">_realListView</a>.<span class="i">AddHeaderView</span>(<a href="#8e20eba3448efe27" class="i property">HeaderView</a>);
				<a href="#a6cd07d4e29ffd87" class="i field">_realListView</a>.<span class="i">AddFooterView</span>(<a href="#0e044392d76ff2dd" class="i property">FooterView</a>);
			}
		}
 
		<b>void</b> <a id="50e8de760135f110" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">OnGroupedCollectionChanged</a>(<b>object</b> <span id="r76 rd" class="r76 r">sender</span>, <span class="i">NotifyCollectionChangedEventArgs</span> <span id="r77 rd" class="r77 r">e</span>)
		{
			<a href="#3ab31efee466bb9f" class="i method">OnDataChanged</a>();
		}
 
		<b>void</b> <a id="096745d5be7934ee" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">OnItemSelected</a>(<b>object</b> <span id="r78 rd" class="r78 r">sender</span>, <a href="/Xamarin.Forms.Core/A.html#8b9f8c714f679914" class="t t">SelectedItemChangedEventArgs</a> <span id="r79 rd" class="r79 r">eventArg</span>)
		{
			<b>if</b> (<a href="#1c41ba8cc986a1ee" class="i field">_fromNative</a>)
			{
				<a href="#1c41ba8cc986a1ee" class="i field">_fromNative</a> = <b>false</b>;
				<b>return</b>;
			}
 
			<span class="i">SelectItem</span>(<span class="r79 r">eventArg</span>.<a href="/Xamarin.Forms.Core/A.html#e555c9eb6c2cbc99" class="i property">SelectedItem</a>);
		}
 
		<b>void</b> <a id="5e48b51f180df933" href="../R/5e48b51f180df933.html" target="n" data-glyph="76,1" class="i method">Select</a>(<b>int</b> <span id="r80 rd" class="r80 r">index</span>, <span class="i">AView</span> <span id="r81 rd" class="r81 r">view</span>)
		{
			<b>if</b> (<a href="#0a8320a19f0b5354" class="i field">_lastSelected</a> != <b>null</b>)
			{
				<a href="../CellAdapter.cs.html#c2c6c8f12e4dad9e" class="i method">UnsetSelectedBackground</a>(<a href="#0a8320a19f0b5354" class="i field">_lastSelected</a>);
				<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a> <span id="r82 rd" class="r82 r">previousCell</span>;
				<b>if</b> (<a href="#14f795ec3797c272" class="i field">_selectedCell</a>.<span class="i">TryGetTarget</span>(<b>out</b> <span class="r82 r">previousCell</span>))
					<span class="r82 r">previousCell</span>.<span class="i">SetValue</span>(<a href="#332639fb2b3caf3d" class="i field">IsSelectedProperty</a>, <b>false</b>);
			}
 
			<a href="#0a8320a19f0b5354" class="i field">_lastSelected</a> = <span class="r81 r">view</span>;
 
			<b>if</b> (<span class="r80 r">index</span> == -1)
				<b>return</b>;
 
			<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a> <span id="r83 rd" class="r83 r">cell</span> = <a href="#d4d82e1086205bd0" class="i method">GetCellForPosition</a>(<span class="r80 r">index</span>);
			<span class="r83 r">cell</span>.<span class="i">SetValue</span>(<a href="#332639fb2b3caf3d" class="i field">IsSelectedProperty</a>, <b>true</b>);
			<a href="#14f795ec3797c272" class="i field">_selectedCell</a> = <b>new</b> <span class="i">WeakReference</span>&lt;<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt;(<span class="r83 r">cell</span>);
 
			<b>if</b> (<span class="r81 r">view</span> != <b>null</b>)
				<a href="../CellAdapter.cs.html#e2bbf9c2d3eb831f" class="i method">SetSelectedBackground</a>(<span class="r81 r">view</span>);
		}
 
		<b>void</b> <a id="02083721dbe482d0" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">SelectItem</a>(<b>object</b> <span id="r84 rd" class="r84 r">item</span>)
		{
			<b>if</b> (<a href="#3cec959272d1802e" class="i field">_listView</a> == <b>null</b>)
				<b>return</b>;
 
			<b>int</b> <span id="r85 rd" class="r85 r">position</span> = <a href="#c031c4a6b8882eb9" class="i property">TemplatedItemsView</a>.<a href="/Xamarin.Forms.Core/A.html#5c03fae343562417" class="i property">TemplatedItems</a>.<span class="i">GetGlobalIndexOfItem</span>(<span class="r84 r">item</span>);
			<span class="i">AView</span> <span id="r86 rd" class="r86 r">view</span> = <b>null</b>;
			<b>if</b> (<span class="r85 r">position</span> != -1)
				<span class="r86 r">view</span> = <a href="#a6cd07d4e29ffd87" class="i field">_realListView</a>.<span class="i">GetChildAt</span>(<span class="r85 r">position</span> + 1 - <a href="#a6cd07d4e29ffd87" class="i field">_realListView</a>.<span class="i">FirstVisiblePosition</span>);
 
			<a href="#5e48b51f180df933" class="i method">Select</a>(<span class="r85 r">position</span>, <span class="r86 r">view</span>);
		}
 
		<b>void</b> <a id="d1edb521da4082c7" href="../R/d1edb521da4082c7.html" target="n" data-glyph="76,1" class="i method">UpdateSeparatorVisibility</a>(<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a> <span id="r87 rd" class="r87 r">cell</span>, <b>bool</b> <span id="r88 rd" class="r88 r">cellIsBeingReused</span>, <b>bool</b> <span id="r89 rd" class="r89 r">isHeader</span>, <b>bool</b> <span id="r90 rd" class="r90 r">nextCellIsHeader</span>, <a href="ConditionalFocusLayout.cs.html#0e142ec5b1e2f3e3" class="t t">ConditionalFocusLayout</a> <span id="r91 rd" class="r91 r">layout</span>, <b>out</b> <span class="i">AView</span> <span id="r92 rd" class="r92 r">bline</span>)
		{
			<span class="r92 r">bline</span> = <b>null</b>;
			<b>if</b> (<span class="r88 r">cellIsBeingReused</span>)
				<b>return</b>;
			<b>bool</b> <span id="r93 rd" class="r93 r">isSeparatorVisible</span> = <a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#13ecaa648f4c9b20" class="i property">SeparatorVisibility</a> == <a href="/Xamarin.Forms.Core/A.html#a9cb5fa58c2bf8a3" class="t t">SeparatorVisibility</a>.<a href="/Xamarin.Forms.Core/A.html#dfd27206bef098f5" class="i field">Default</a>;
			<b>var</b> <span id="r94 rd" class="r94 r">makeBline</span> = <span class="r93 r">isSeparatorVisible</span> || <span class="r89 r">isHeader</span> &amp;&amp; <span class="r93 r">isSeparatorVisible</span> &amp;&amp; !<span class="r90 r">nextCellIsHeader</span>;
			<b>if</b> (<span class="r94 r">makeBline</span>)
			{
				<span class="r92 r">bline</span> = <b>new</b> <span class="i">AView</span>(<a href="#e2a08c19f2601d45" class="i field">_context</a>) { <span class="i">LayoutParameters</span> = <b>new</b> <span class="i">LinearLayout</span>.<span class="i">LayoutParams</span>(<span class="i">ViewGroup</span>.<span class="i">LayoutParams</span>.<span class="i">MatchParent</span>, 1) };
				<span class="r91 r">layout</span>.<span class="i">AddView</span>(<span class="r92 r">bline</span>);
			}
			<b>else if</b> (<span class="r91 r">layout</span>.<span class="i">ChildCount</span> &gt; 1)
			{
				<span class="r91 r">layout</span>.<span class="i">RemoveViewAt</span>(1);
			}
		}
 
 
		<b>void</b> <a id="9f5af43192b823ae" href="../R/9f5af43192b823ae.html" target="n" data-glyph="76,1" class="i method">UpdateSeparatorColor</a>(<b>bool</b> <span id="r95 rd" class="r95 r">isHeader</span>, <span class="i">AView</span> <span id="r96 rd" class="r96 r">bline</span>)
		{
			<b>if</b> (<span class="r96 r">bline</span> == <b>null</b>)
				<b>return</b>;
 
			<a href="/Xamarin.Forms.Core/A.html#8a6a061540451ec4" class="t t">Color</a> <span id="r97 rd" class="r97 r">separatorColor</span> = <a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#180e6578be529d41" class="i property">SeparatorColor</a>;
 
			<b>if</b> (<span class="r95 r">isHeader</span> || !<span class="r97 r">separatorColor</span>.<a href="/Xamarin.Forms.Core/A.html#8625c30a5ad855a0" class="i property">IsDefault</a>)
				<span class="r96 r">bline</span>.<span class="i">SetBackgroundColor</span>(<span class="r97 r">separatorColor</span>.<span class="i">ToAndroid</span>(<a href="/Xamarin.Forms.Core/A.html#8a6a061540451ec4" class="t t">Color</a>.<a href="/Xamarin.Forms.Core/A.html#20ed50b13a0f4f97" class="i property">Accent</a>));
			<b>else</b>
			{
				<b>if</b> (<a href="#a0ae2593d2cf1c64" class="i field">s_dividerHorizontalDarkId</a> == <b>int</b>.<span class="i">MinValue</span>)
				{
					<b>using</b> (<b>var</b> <span id="r98 rd" class="r98 r">value</span> = <b>new</b> <span class="i">TypedValue</span>())
					{
						<b>int</b> <span id="r99 rd" class="r99 r">id</span> = <b>global</b>::<span class="i">Android</span>.<span class="i">Resource</span>.<span class="i">Drawable</span>.<span class="i">DividerHorizontalDark</span>;
						<b>if</b> (<a href="#e2a08c19f2601d45" class="i field">_context</a>.<span class="i">Theme</span>.<span class="i">ResolveAttribute</span>(<b>global</b>::<span class="i">Android</span>.<span class="i">Resource</span>.<span class="i">Attribute</span>.<span class="i">ListDivider</span>, <span class="r98 r">value</span>, <b>true</b>))
							<span class="r99 r">id</span> = <span class="r98 r">value</span>.<span class="i">ResourceId</span>;
						<b>else if</b> (<a href="#e2a08c19f2601d45" class="i field">_context</a>.<span class="i">Theme</span>.<span class="i">ResolveAttribute</span>(<b>global</b>::<span class="i">Android</span>.<span class="i">Resource</span>.<span class="i">Attribute</span>.<span class="i">Divider</span>, <span class="r98 r">value</span>, <b>true</b>))
							<span class="r99 r">id</span> = <span class="r98 r">value</span>.<span class="i">ResourceId</span>;
 
						<a href="#a0ae2593d2cf1c64" class="i field">s_dividerHorizontalDarkId</a> = <span class="r99 r">id</span>;
					}
				}
 
				<span class="r96 r">bline</span>.<span class="i">SetBackgroundResource</span>(<a href="#a0ae2593d2cf1c64" class="i field">s_dividerHorizontalDarkId</a>);
			}
		}
 
		<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a> <a id="2f5c50f00bebc57c" href="../R/2f5c50f00bebc57c.html" target="n" data-glyph="76,1" class="i method">GetNewGroupHeaderCell</a>(<a href="/Xamarin.Forms.Core/A.html#5fafd275375b1472" class="t t">ITemplatedItemsList</a>&lt;<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt; <span id="r100 rd" class="r100 r">group</span>)
		{
			<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="k">var</a> <span id="r101 rd" class="r101 r">groupHeaderCell</span> = <a href="#3cec959272d1802e" class="i field">_listView</a>.<a href="/Xamarin.Forms.Core/A.html#93c3512107256101" class="i property">TemplatedItems</a>.<a href="/Xamarin.Forms.Core/A.html#e74a990ce6574f9c" class="i property">GroupHeaderTemplate</a>?.<span class="i">CreateContent</span>(<span class="r100 r">group</span>.<a href="/Xamarin.Forms.Core/A.html#ca765c504701ad64" class="i property">ItemsSource</a>, <a href="#3cec959272d1802e" class="i field">_listView</a>) <b>as</b> <a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>;
 
			<b>if</b> (<span class="r101 r">groupHeaderCell</span> != <b>null</b>)
			{
				<span class="r101 r">groupHeaderCell</span>.<a href="/Xamarin.Forms.Core/A.html#ec31b23be1ce91d4" class="i property">BindingContext</a> = <span class="r100 r">group</span>.<a href="/Xamarin.Forms.Core/A.html#ca765c504701ad64" class="i property">ItemsSource</a>;
			}
			<b>else</b>
			{
				<span class="r101 r">groupHeaderCell</span> = <b>new</b> <span class="t">TextCell</span>();
				<span class="r101 r">groupHeaderCell</span>.<span class="i">SetBinding</span>(<a href="/Xamarin.Forms.Core/A.html#ba9b70b0224a44cd" class="t t">TextCell</a>.<a href="/Xamarin.Forms.Core/A.html#90f39da3bd0f1868" class="i field">TextProperty</a>, <b>nameof</b>(<span class="r100 r">group</span>.<a href="/Xamarin.Forms.Core/A.html#0b91d67893219a3c" class="i property">Name</a>));
				<span class="r101 r">groupHeaderCell</span>.<a href="/Xamarin.Forms.Core/A.html#ec31b23be1ce91d4" class="i property">BindingContext</a> = <span class="r100 r">group</span>;
			}
 
			<span class="r101 r">groupHeaderCell</span>.<span class="i">Parent</span> = <a href="#3cec959272d1802e" class="i field">_listView</a>;
			<span class="r101 r">groupHeaderCell</span>.<span class="i">SetIsGroupHeader</span>&lt;<a href="/Xamarin.Forms.Core/A.html#e6e9068bbee42f54" class="t t">ItemsView</a>&lt;<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt;, <a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a>&gt;(<b>true</b>);
			<b>return</b> <span class="r101 r">groupHeaderCell</span>;
		}
 
		<b>enum</b> <a id="3c3b74bebf761ea9" href="../R/../../0000000000.html" target="n" data-glyph="22,1" class="t t"><span id="634056799221fded">CellType</span></a>
		{
			<a id="d22f60ceadf0ad2d" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Row</a>,
			<a id="a78297dc55081d9f" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Header</a>
		}
 
		<b>protected virtual void</b> <a id="8cdf734c44cd57a3" href="../R/8cdf734c44cd57a3.html" target="n" data-glyph="75,1" class="i method">InvalidateCount</a>()
		{
			<a href="#5d2f76e3dfbaf81f" class="i field">_listCount</a> = -1;
		}
	}
 
}</pre></td></tr></table></div></body></html>
