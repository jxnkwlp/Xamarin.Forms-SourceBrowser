<!DOCTYPE html>
<html><head><title>CarouselPageRenderer.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(148);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="Xamarin.Forms.Platform.Android/AppCompat/CarouselPageRenderer.cs" target="_top">AppCompat\CarouselPageRenderer.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xamarin.Forms.Platform.Android" target="_top">Xamarin.Forms.Platform.Android\Xamarin.Forms.Platform.Android.csproj</a> (Xamarin.Forms.Platform.Android)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Specialized</span>;
<b>using</b> <span class="i">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Content</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Support</span>.<span class="i">V4</span>.<span class="i">View</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Views</span>;
 
<b>namespace</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Platform</span>.<span class="i n">Android</span>.<span class="i n">AppCompat</span>
{
	<b>public class</b> <a id="c30edce3e90bec0a" href="../R/c30edce3e90bec0a.html" target="n" data-glyph="0,0" class="t t">CarouselPageRenderer</a> : <a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="t t">VisualElementRenderer</a>&lt;<a href="/Xamarin.Forms.Core/A.html#efe3ef8da06691e9" class="t t">CarouselPage</a>&gt;, <span class="i">ViewPager</span>.<span class="i">IOnPageChangeListener</span>
	{
		<b>bool</b> <a id="663c79e33c821929" href="../R/663c79e33c821929.html" target="n" data-glyph="46,1" class="i field">_disposed</a>;
		<a href="FormsViewPager.cs.html#2c9d6ce6e845edb0" class="t t">FormsViewPager</a> <a id="2dbdf84cb6dcd9e5" href="../R/2dbdf84cb6dcd9e5.html" target="n" data-glyph="46,1" class="i field">_viewPager</a>;
 
		<b>public</b> <a id="ce64462673763c7f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i constructor">CarouselPageRenderer</a>()
		{
			<a href="../VisualElementRenderer.cs.html#51c5d397dcb4f87a" class="i property">AutoPackage</a> = <b>false</b>;
		}
 
		<b>void</b> <span class="i">ViewPager</span>.<span class="i">IOnPageChangeListener</span>.<a id="c871e563e7d280c8" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">OnPageScrolled</a>(<b>int</b> <span id="r0 rd" class="r0 r">position</span>, <b>float</b> <span id="r1 rd" class="r1 r">positionOffset</span>, <b>int</b> <span id="r2 rd" class="r2 r">positionOffsetPixels</span>)
		{
		}
 
		<b>void</b> <span class="i">ViewPager</span>.<span class="i">IOnPageChangeListener</span>.<a id="157cc9afbc181385" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">OnPageScrollStateChanged</a>(<b>int</b> <span id="r3 rd" class="r3 r">state</span>)
		{
		}
 
		<a href="/Xamarin.Forms.Core/A.html#b23cf6cd1d6182c9" class="t t">IPageController</a> <a id="99df7a917b50764a" href="../R/99df7a917b50764a.html" target="n" data-glyph="106,1" class="i property">PageController</a> =&gt; <a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#b23cf6cd1d6182c9" class="t t">IPageController</a>;
 
		<b>void</b> <span class="i">ViewPager</span>.<span class="i">IOnPageChangeListener</span>.<a id="b2944f80e4e126a1" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">OnPageSelected</a>(<b>int</b> <span id="r4 rd" class="r4 r">position</span>)
		{
			<a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a>.<span class="i">CurrentPage</span> = <a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a>.<a href="/Xamarin.Forms.Core/A.html#a42e2d50a9c517c2" class="i property">Children</a>[<span class="r4 r">position</span>];
		}
 
		<b>protected override void</b> <a id="f7bfefa409e92107" href="../R/f7bfefa409e92107.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r5 rd" class="r5 r">disposing</span>)
		{
			<b>if</b> (<span class="r5 r">disposing</span> &amp;&amp; !<a href="#663c79e33c821929" class="i field">_disposed</a>)
			{
				<a href="#663c79e33c821929" class="i field">_disposed</a> = <b>true</b>;
				<span class="i">RemoveAllViews</span>();
				<b>foreach</b> (<a href="/Xamarin.Forms.Core/A.html#2f77fd3b834f8534" class="t t">ContentPage</a> <span id="r6 rd" class="r6 r">pageToRemove</span> <b>in</b> <a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a>.<a href="/Xamarin.Forms.Core/A.html#a42e2d50a9c517c2" class="i property">Children</a>)
				{
					<a href="../IVisualElementRenderer.cs.html#0736b5467d596326" class="t t">IVisualElementRenderer</a> <span id="r7 rd" class="r7 r">pageRenderer</span> = <span class="i n">Android</span>.<a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#1b78ee69c66639c4" class="i method">GetRenderer</a>(<span class="r6 r">pageToRemove</span>);
					<b>if</b> (<span class="r7 r">pageRenderer</span> != <b>null</b>)
					{
						<span class="r7 r">pageRenderer</span>.<a href="../IVisualElementRenderer.cs.html#0c96abedd7d8e58d" class="i property">View</a>.<a href="../ViewExtensions.cs.html#ed54340ae84abc92" class="i method">RemoveFromParent</a>();
						<span class="r7 r">pageRenderer</span>.<span class="i">Dispose</span>();
					}
					<span class="r6 r">pageToRemove</span>.<span class="i">ClearValue</span>(<span class="i n">Android</span>.<a href="../Platform.cs.html#479e712741d44fa2" class="t t">Platform</a>.<a href="../Platform.cs.html#cda3e6f7841c17d4" class="i field">RendererProperty</a>);
				}
 
				<b>if</b> (<a href="#2dbdf84cb6dcd9e5" class="i field">_viewPager</a> != <b>null</b>)
				{
					<a href="#2dbdf84cb6dcd9e5" class="i field">_viewPager</a>.<span class="i">Adapter</span>.<span class="i">Dispose</span>();
					<a href="#2dbdf84cb6dcd9e5" class="i field">_viewPager</a>.<span class="i">Dispose</span>();
					<a href="#2dbdf84cb6dcd9e5" class="i field">_viewPager</a> = <b>null</b>;
				}
 
				<b>if</b> (<a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a> != <b>null</b>)
					<a href="#99df7a917b50764a" class="i property">PageController</a>.<a href="/Xamarin.Forms.Core/A.html#58cca3d6af33124c" class="i property">InternalChildren</a>.<span class="i">CollectionChanged</span> -= <span class="i">OnChildrenCollectionChanged</span>;
			}
 
			<a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="k">base</a>.<a href="../VisualElementRenderer.cs.html#7e4c679353a39ac7" class="i method">Dispose</a>(<span class="r5 r">disposing</span>);
		}
 
		<b>protected override void</b> <a id="04f11e93a00a1910" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">OnAttachedToWindow</a>()
		{
			<a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="k">base</a>.<span class="i">OnAttachedToWindow</span>();
			<a href="#99df7a917b50764a" class="i property">PageController</a>.<span class="i">SendAppearing</span>();
		}
 
		<b>protected override void</b> <a id="d92bdaaf342287d9" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">OnDetachedFromWindow</a>()
		{
			<a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="k">base</a>.<span class="i">OnDetachedFromWindow</span>();
			<a href="#99df7a917b50764a" class="i property">PageController</a>.<span class="i">SendDisappearing</span>();
		}
 
		<b>protected override void</b> <a id="4dd56df2ee916cee" href="../R/4dd56df2ee916cee.html" target="n" data-glyph="75,1" class="i method">OnElementChanged</a>(<a href="../ElementChangedEventArgs.cs.html#9a1366c2961f4fde" class="t t">ElementChangedEventArgs</a>&lt;<a href="/Xamarin.Forms.Core/A.html#efe3ef8da06691e9" class="t t">CarouselPage</a>&gt; <span id="r8 rd" class="r8 r">e</span>)
		{
			<a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="k">base</a>.<a href="../VisualElementRenderer.cs.html#48f7eabe0c8c2b33" class="i method">OnElementChanged</a>(<span class="r8 r">e</span>);
 
			<a href="FormsAppCompatActivity.cs.html#73a28a031ead4b7d" class="k">var</a> <span id="r9 rd" class="r9 r">activity</span> = (<a href="FormsAppCompatActivity.cs.html#73a28a031ead4b7d" class="t t">FormsAppCompatActivity</a>)<span class="i">Context</span>;
 
			<b>if</b> (<span class="r8 r">e</span>.<a href="../ElementChangedEventArgs.cs.html#3ce3d81b001baec9" class="i property">OldElement</a> != <b>null</b>)
				((<a href="/Xamarin.Forms.Core/A.html#b23cf6cd1d6182c9" class="t t">IPageController</a>)<span class="r8 r">e</span>.<a href="../ElementChangedEventArgs.cs.html#3ce3d81b001baec9" class="i property">OldElement</a>).<a href="/Xamarin.Forms.Core/A.html#58cca3d6af33124c" class="i property">InternalChildren</a>.<span class="i">CollectionChanged</span> -= <span class="i">OnChildrenCollectionChanged</span>;
 
			<b>if</b> (<span class="r8 r">e</span>.<a href="../ElementChangedEventArgs.cs.html#791644a1727a7988" class="i property">NewElement</a> != <b>null</b>)
			{
				<a href="FormsViewPager.cs.html#2c9d6ce6e845edb0" class="t t">FormsViewPager</a> <span id="r10 rd" class="r10 r">pager</span> =
					<a href="#2dbdf84cb6dcd9e5" class="i field">_viewPager</a> =
					<b>new</b> <span class="t">FormsViewPager</span>(<span class="r9 r">activity</span>)
					{
						<span class="i">OverScrollMode</span> = <span class="i">OverScrollMode</span>.<span class="i">Never</span>,
						<a href="FormsViewPager.cs.html#2327d16e05fb1baa" class="i property">EnableGesture</a> = <b>true</b>,
						<span class="i">LayoutParameters</span> = <b>new</b> <span class="i">ViewGroup</span>.<span class="i">LayoutParams</span>(<a href="../VisualElementRenderer.cs.html#c5e6b65d09848291" class="i property">ViewGroup</a>.<span class="i">LayoutParams</span>.<span class="i">MatchParent</span>, <a href="../VisualElementRenderer.cs.html#c5e6b65d09848291" class="i property">ViewGroup</a>.<span class="i">LayoutParams</span>.<span class="i">MatchParent</span>),
						<span class="i">Adapter</span> = <b>new</b> <span class="t">FormsFragmentPagerAdapter</span>&lt;<a href="/Xamarin.Forms.Core/A.html#2f77fd3b834f8534" class="t t">ContentPage</a>&gt;(<span class="r8 r">e</span>.<a href="../ElementChangedEventArgs.cs.html#791644a1727a7988" class="i property">NewElement</a>, <span class="r9 r">activity</span>.<span class="i">SupportFragmentManager</span>) { <a href="FormsFragmentPagerAdapter.cs.html#c8bb1c90cd62dea8" class="i property">CountOverride</a> = <span class="r8 r">e</span>.<a href="../ElementChangedEventArgs.cs.html#791644a1727a7988" class="i property">NewElement</a>.<a href="/Xamarin.Forms.Core/A.html#a42e2d50a9c517c2" class="i property">Children</a>.<span class="i">Count</span> }
					};
				<span class="r10 r">pager</span>.<span class="i">Id</span> = <a href="Platform.cs.html#2431577fc7669ff2" class="t t">Platform</a>.<a href="Platform.cs.html#d1ae339db7fd1f7c" class="i method">GenerateViewId</a>();
				<span class="r10 r">pager</span>.<span class="i">AddOnPageChangeListener</span>(<a href="#c30edce3e90bec0a" class="k">this</a>);
 
				<a href="../VisualElementRenderer.cs.html#c5e6b65d09848291" class="i property">ViewGroup</a>.<span class="i">AddView</span>(<span class="r10 r">pager</span>);
				<a href="/Xamarin.Forms.Core/A.html#efe3ef8da06691e9" class="t t">CarouselPage</a> <span id="r11 rd" class="r11 r">carouselPage</span> = <span class="r8 r">e</span>.<a href="../ElementChangedEventArgs.cs.html#791644a1727a7988" class="i property">NewElement</a>;
				<b>if</b> (<span class="r11 r">carouselPage</span>.<a href="/Xamarin.Forms.Core/A.html#ffbdb21cfc058aa9" class="i property">CurrentPage</a> != <b>null</b>)
					<a href="#b739465a7d933620" class="i method">ScrollToCurrentPage</a>();
 
				((<a href="/Xamarin.Forms.Core/A.html#b23cf6cd1d6182c9" class="t t">IPageController</a>)<span class="r11 r">carouselPage</span>).<a href="/Xamarin.Forms.Core/A.html#58cca3d6af33124c" class="i property">InternalChildren</a>.<span class="i">CollectionChanged</span> += <span class="i">OnChildrenCollectionChanged</span>;
			}
		}
 
		<b>protected override void</b> <a id="e4e17885c1a59f14" href="../R/e4e17885c1a59f14.html" target="n" data-glyph="75,1" class="i method">OnElementPropertyChanged</a>(<b>object</b> <span id="r12 rd" class="r12 r">sender</span>, <span class="i">PropertyChangedEventArgs</span> <span id="r13 rd" class="r13 r">e</span>)
		{
			<a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="k">base</a>.<a href="../VisualElementRenderer.cs.html#a2a35e77093e6122" class="i method">OnElementPropertyChanged</a>(<span class="r12 r">sender</span>, <span class="r13 r">e</span>);
 
			<b>if</b> (<span class="r13 r">e</span>.<span class="i">PropertyName</span> == <span class="s">&quot;CurrentPage&quot;</span>)
				<a href="#b739465a7d933620" class="i method">ScrollToCurrentPage</a>();
		}
 
		<b>protected override void</b> <a id="46a217a172a1c889" href="../R/46a217a172a1c889.html" target="n" data-glyph="75,1" class="i method">OnLayout</a>(<b>bool</b> <span id="r14 rd" class="r14 r">changed</span>, <b>int</b> <span id="r15 rd" class="r15 r">l</span>, <b>int</b> <span id="r16 rd" class="r16 r">t</span>, <b>int</b> <span id="r17 rd" class="r17 r">r</span>, <b>int</b> <span id="r18 rd" class="r18 r">b</span>)
		{
			<a href="FormsViewPager.cs.html#2c9d6ce6e845edb0" class="t t">FormsViewPager</a> <span id="r19 rd" class="r19 r">pager</span> = <a href="#2dbdf84cb6dcd9e5" class="i field">_viewPager</a>;
			<span class="i">Context</span> <span id="r20 rd" class="r20 r">context</span> = <span class="i">Context</span>;
			<b>int</b> <span id="r21 rd" class="r21 r">width</span> = <span class="r17 r">r</span> - <span class="r15 r">l</span>;
			<b>int</b> <span id="r22 rd" class="r22 r">height</span> = <span class="r18 r">b</span> - <span class="r16 r">t</span>;
 
			<span class="r19 r">pager</span>.<span class="i">Measure</span>(<a href="../MeasureSpecFactory.cs.html#97f047ff5333943b" class="t t">MeasureSpecFactory</a>.<span class="i">MakeMeasureSpec</span>(<span class="r21 r">width</span>, <span class="i">MeasureSpecMode</span>.<span class="i">AtMost</span>), <a href="../MeasureSpecFactory.cs.html#97f047ff5333943b" class="t t">MeasureSpecFactory</a>.<span class="i">MakeMeasureSpec</span>(<span class="r22 r">height</span>, <span class="i">MeasureSpecMode</span>.<span class="i">AtMost</span>));
 
			<b>if</b> (<span class="r21 r">width</span> &gt; 0 &amp;&amp; <span class="r22 r">height</span> &gt; 0)
			{
				<a href="#99df7a917b50764a" class="i property">PageController</a>.<span class="i">ContainerArea</span> = <b>new</b> <span class="t">Rectangle</span>(0, 0, <span class="r20 r">context</span>.<a href="../ContextExtensions.cs.html#cce5139585f8ebc7" class="i method">FromPixels</a>(<span class="r21 r">width</span>), <span class="r20 r">context</span>.<a href="../ContextExtensions.cs.html#cce5139585f8ebc7" class="i method">FromPixels</a>(<span class="r22 r">height</span>));
				<span class="r19 r">pager</span>.<span class="i">Layout</span>(0, 0, <span class="r21 r">width</span>, <span class="r18 r">b</span>);
			}
 
			<a href="../VisualElementRenderer.cs.html#2d9d0e6565735db7" class="k">base</a>.<a href="../VisualElementRenderer.cs.html#33c4b945470fa7ab" class="i method">OnLayout</a>(<span class="r14 r">changed</span>, <span class="r15 r">l</span>, <span class="r16 r">t</span>, <span class="r17 r">r</span>, <span class="r18 r">b</span>);
		}
 
		<b>void</b> <a id="549de3b7f8a56989" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">OnChildrenCollectionChanged</a>(<b>object</b> <span id="r23 rd" class="r23 r">sender</span>, <span class="i">NotifyCollectionChangedEventArgs</span> <span id="r24 rd" class="r24 r">e</span>)
		{
			<a href="FormsViewPager.cs.html#2c9d6ce6e845edb0" class="t t">FormsViewPager</a> <span id="r25 rd" class="r25 r">pager</span> = <a href="#2dbdf84cb6dcd9e5" class="i field">_viewPager</a>;
 
			((<a href="FormsFragmentPagerAdapter.cs.html#2bb10e2b552622a6" class="t t">FormsFragmentPagerAdapter</a>&lt;<a href="/Xamarin.Forms.Core/A.html#2f77fd3b834f8534" class="t t">ContentPage</a>&gt;)<span class="r25 r">pager</span>.<span class="i">Adapter</span>).<a href="FormsFragmentPagerAdapter.cs.html#c8bb1c90cd62dea8" class="i property">CountOverride</a> = <a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a>.<a href="/Xamarin.Forms.Core/A.html#a42e2d50a9c517c2" class="i property">Children</a>.<span class="i">Count</span>;
			<span class="r25 r">pager</span>.<span class="i">Adapter</span>.<span class="i">NotifyDataSetChanged</span>();
		}
 
		<b>void</b> <a id="b739465a7d933620" href="../R/b739465a7d933620.html" target="n" data-glyph="76,1" class="i method">ScrollToCurrentPage</a>()
		{
			<a href="#2dbdf84cb6dcd9e5" class="i field">_viewPager</a>.<span class="i">SetCurrentItem</span>(<a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a>.<a href="/Xamarin.Forms.Core/A.html#a42e2d50a9c517c2" class="i property">Children</a>.<span class="i">IndexOf</span>(<a href="../VisualElementRenderer.cs.html#37a572695e51b5a8" class="i property">Element</a>.<a href="/Xamarin.Forms.Core/A.html#ffbdb21cfc058aa9" class="i property">CurrentPage</a>), <b>true</b>);
		}
	}
}</pre></td></tr></table></div></body></html>
