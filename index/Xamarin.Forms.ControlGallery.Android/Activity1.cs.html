<!DOCTYPE html>
<html><head><title>Activity1.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(177);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="Xamarin.Forms.ControlGallery.Android/Activity1.cs" target="_top">Activity1.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xamarin.Forms.ControlGallery.Android" target="_top">Xamarin.Forms.ControlGallery.Android\Xamarin.Forms.ControlGallery.Android.csproj</a> (Xamarin.Forms.ControlGallery.Android)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Diagnostics</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">App</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Content</span>.<span class="i">PM</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">OS</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Widget</span>;
<b>using</b> <span class="i n">Java</span>.<span class="i n">Interop</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">ControlGallery</span>.<span class="i n">Android</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Controls</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Controls</span>.<span class="i n">Issues</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Platform</span>.<span class="i n">Android</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Platform</span>.<span class="i n">Android</span>.<span class="i n">AppLinks</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Content</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Content</span>.<span class="i">Res</span>;
<b>using</b> <span class="i">Android</span>.<span class="i">Views</span>;
<b>using</b> <span class="i">AColor</span> = <span class="i">Android</span>.<span class="i">Graphics</span>.<span class="i">Color</span>;
 
[<b>assembly</b>: <span class="i">Dependency</span> (<b>typeof</b> (<a href="CacheService.cs.html#d16f3c9decbf0525" class="t t">CacheService</a>))]
[<b>assembly</b>: <span class="i">Dependency</span> (<b>typeof</b> (<a href="TestCloudService.cs.html#157677ffb4510a54" class="t t">TestCloudService</a>))]
[<b>assembly</b>: <span class="i">Dependency</span> (<b>typeof</b> (<a href="StringProvider.cs.html#6106da08509999de" class="t t">StringProvider</a>))]
[<b>assembly</b>: <span class="i">ExportRenderer</span> (<b>typeof</b> (<a href="/Xamarin.Forms.Controls/A.html#cf0f8515aeabbba6" class="t t">DisposePage</a>), <b>typeof</b> (<a href="DisposePageRenderer.cs.html#1fce4243a3423579" class="t t">DisposePageRenderer</a>))]
[<b>assembly</b>: <span class="i">ExportRenderer</span> (<b>typeof</b> (<a href="/Xamarin.Forms.Controls/A.html#3fa617412e1b6554" class="t t">DisposeLabel</a>), <b>typeof</b> (<a href="DisposeLabelRenderer.cs.html#f479021d85955e3f" class="t t">DisposeLabelRenderer</a>))]
[<b>assembly</b>: <span class="i">ExportRenderer</span> (<b>typeof</b> (<a href="/Xamarin.Forms.Controls/A.html#3e441d3e70160820" class="t t">CustomButton</a>), <b>typeof</b> (<a href="CustomRenderers.cs.html#8c429a4c95af718c" class="t t">CustomButtonRenderer</a>))]
[<b>assembly</b>: <span class="i">ExportEffect</span> (<b>typeof</b> (<a href="BorderEffect.cs.html#b8bd2c8a464c0a45" class="t t">BorderEffect</a>), <span class="s">&quot;BorderEffect&quot;</span>)]
 
<b>namespace</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">ControlGallery</span>.<span class="i n">Android</span>
{
	<b>public</b> <a href="P/388ed8e2a27bd299.html" target="s" class="k">partial</a> <b>class</b> <a id="388ed8e2a27bd299" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="49239fd848b9bac4">Activity1</span></a> 
	{
		<a href="/Xamarin.Forms.Controls/A.html#12ba9bfb7ddfe7df" class="t t">App</a> <a id="ffaac6468612eb06" href="R/ffaac6468612eb06.html" target="n" data-glyph="46,1" class="i field">_app</a>;
 
		<b>void</b> <a id="488289303991e234" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">AddNativeControls</a> (<a href="/Xamarin.Forms.Controls/A.html#e84c069f0d08c612" class="t t">NestedNativeControlGalleryPage</a> <span id="r0 rd" class="r0 r">page</span>)
		{
			<b>if</b> (<span class="r0 r">page</span>.<a href="/Xamarin.Forms.Controls/A.html#aacf172416d19c6d" class="i property">NativeControlsAdded</a>) {
				<b>return</b>;
			}
 
			<a href="/Xamarin.Forms.Core/A.html#5c88f1e97bd1f520" class="t t">StackLayout</a> <span id="r1 rd" class="r1 r">sl</span> = <span class="r0 r">page</span>.<a href="/Xamarin.Forms.Controls/A.html#a397c931c6a6bc0f" class="i property">Layout</a>;
 
			<span class="c">// Create and add a native TextView</span>
			<b>var</b> <span id="r2 rd" class="r2 r">textView</span> = <b>new</b> <span class="i">TextView</span> (<a href="P/388ed8e2a27bd299.html#388ed8e2a27bd299" class="k">this</a>) { <span class="i">Text</span> = <span class="s">&quot;I am a native TextView&quot;</span>, <span class="i">TextSize</span> = 14 };
			<span class="r1 r">sl</span>?.<a href="/Xamarin.Forms.Core/A.html#5049824abac2f58c" class="i property">Children</a>.<span class="i">Add</span> (<span class="r2 r">textView</span>);
 
			<span class="c">// Create and add a native Button </span>
			<b>var</b> <span id="r3 rd" class="r3 r">button</span> = <b>new</b> <b>global</b>::<span class="i">Android</span>.<span class="i">Widget</span>.<span class="i">Button</span> (<a href="P/388ed8e2a27bd299.html#388ed8e2a27bd299" class="k">this</a>) { <span class="i">Text</span> = <span class="s">&quot;Click to change TextView font size&quot;</span> };
			<b>float</b> <span id="r4 rd" class="r4 r">originalSize</span> = <span class="r2 r">textView</span>.<span class="i">TextSize</span>;
			<span class="r3 r">button</span>.<span class="i">Click</span> += (<span id="r5 rd" class="r5 r">sender</span>, <span id="r6 rd" class="r6 r">args</span>) =&gt; { <span class="r2 r">textView</span>.<span class="i">TextSize</span> = <span class="r2 r">textView</span>.<span class="i">TextSize</span> == <span class="r4 r">originalSize</span> ? 24 : 14; };
 
			<span class="r1 r">sl</span>?.<a href="/Xamarin.Forms.Core/A.html#5049824abac2f58c" class="i property">Children</a>.<span class="i">Add</span> (<span class="r3 r">button</span>.<span class="i">ToView</span> ());
 
			<span class="c">// Create a control which we know doesn&#39;t behave correctly with regard to measurement</span>
			<a href="BrokenNativeControl.cs.html#cdd45804c3c9f6d1" class="k">var</a> <span id="r7 rd" class="r7 r">difficultControl0</span> = <b>new</b> <span class="t">BrokenNativeControl</span> (<a href="P/388ed8e2a27bd299.html#388ed8e2a27bd299" class="k">this</a>) {
				<span class="i">Text</span> = <span class="s">&quot;This native control doesn&#39;t play nice with sizing, which is why it&#39;s all squished to one side.&quot;</span>
			};
			<a href="BrokenNativeControl.cs.html#cdd45804c3c9f6d1" class="k">var</a> <span id="r8 rd" class="r8 r">difficultControl1</span> = <b>new</b> <span class="t">BrokenNativeControl</span> (<a href="P/388ed8e2a27bd299.html#388ed8e2a27bd299" class="k">this</a>) {
				<span class="i">Text</span> = <span class="s">&quot;Same control, but with a custom GetDesiredSize delegate to accomodate it&#39;s sizing problems.&quot;</span>
			};
 
			<span class="c">// Add a misbehaving control </span>
			<span class="r1 r">sl</span>?.<a href="/Xamarin.Forms.Core/A.html#5049824abac2f58c" class="i property">Children</a>.<span class="i">Add</span> (<span class="r7 r">difficultControl0</span>);
 
			<span class="c">// Add a misbehaving control with a custom delegate for GetDesiredSize</span>
			<span class="r1 r">sl</span>?.<a href="/Xamarin.Forms.Core/A.html#5049824abac2f58c" class="i property">Children</a>.<span class="i">Add</span> (<span class="r8 r">difficultControl1</span>, <span class="i">SizeBrokenControl</span>);
 
			<span class="r0 r">page</span>.<a href="/Xamarin.Forms.Controls/A.html#aacf172416d19c6d" class="i property">NativeControlsAdded</a> = <b>true</b>;
		}
 
		<b>static</b> <a href="/Xamarin.Forms.Core/A.html#76c9ea4b373db5b2" class="t t">SizeRequest</a>? <a id="227e1f27146d7bee" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">SizeBrokenControl</a> (<a href="/Xamarin.Forms.Platform.Android/A.html#e0a1c27bfe6e163e" class="t t">NativeViewWrapperRenderer</a> <span id="r9 rd" class="r9 r">renderer</span>,
			<b>int</b> <span id="r10 rd" class="r10 r">widthConstraint</span>, <b>int</b> <span id="r11 rd" class="r11 r">heightConstraint</span>)
		{
			<b>global</b>::<span class="i">Android</span>.<span class="i">Views</span>.<span class="i">View</span> <span id="r12 rd" class="r12 r">nativeView</span> = <span class="r9 r">renderer</span>.<a href="/Xamarin.Forms.Platform.Android/A.html#ae97bb4279742be5" class="i property">Control</a>;
 
			<b>if</b> ((<span class="r10 r">widthConstraint</span> == 0 &amp;&amp; <span class="r11 r">heightConstraint</span> == 0) || <span class="r12 r">nativeView</span> == <b>null</b>) {
				<b>return null</b>;
			}
 
			<b>int</b> <span id="r13 rd" class="r13 r">width</span> = <b>global</b>::<span class="i">Android</span>.<span class="i">Views</span>.<span class="i">View</span>.<span class="i">MeasureSpec</span>.<span class="i">GetSize</span> (<span class="r10 r">widthConstraint</span>);
			<b>int</b> <span id="r14 rd" class="r14 r">widthSpec</span> = <b>global</b>::<span class="i">Android</span>.<span class="i">Views</span>.<span class="i">View</span>.<span class="i">MeasureSpec</span>.<span class="i">MakeMeasureSpec</span> (<span class="r13 r">width</span> * 2,
				<b>global</b>::<span class="i">Android</span>.<span class="i">Views</span>.<span class="i">View</span>.<span class="i">MeasureSpec</span>.<span class="i">GetMode</span> (<span class="r10 r">widthConstraint</span>));
			<span class="r12 r">nativeView</span>.<span class="i">Measure</span> (<span class="r14 r">widthSpec</span>, <span class="r11 r">heightConstraint</span>);
			<a href="/Xamarin.Forms.Core/A.html#a940b381a4300f8b" class="k">var</a> <span id="r15 rd" class="r15 r">size</span> = <b>new</b> <span class="t">Size</span> (<span class="r12 r">nativeView</span>.<span class="i">MeasuredWidth</span>, <span class="r12 r">nativeView</span>.<span class="i">MeasuredHeight</span>);
			<b>return</b> <b>new</b> <span class="t">SizeRequest</span> (<span class="r15 r">size</span>);
		}
 
		<b>void</b> <a id="4cccf806c529d154" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">AddNativeBindings</a>(<a href="/Xamarin.Forms.Controls/A.html#0ebf3b0d6d57e852" class="t t">NativeBindingGalleryPage</a> <span id="r16 rd" class="r16 r">page</span>)
		{
			<b>if</b> (<span class="r16 r">page</span>.<a href="/Xamarin.Forms.Controls/A.html#6fda383a93d625a4" class="i property">NativeControlsAdded</a>)
				<b>return</b>;
 
			<a href="/Xamarin.Forms.Core/A.html#5c88f1e97bd1f520" class="t t">StackLayout</a> <span id="r17 rd" class="r17 r">sl</span> = <span class="r16 r">page</span>.<a href="/Xamarin.Forms.Controls/A.html#379ae7922bf377a9" class="i property">Layout</a>;
 
			<b>var</b> <span id="r18 rd" class="r18 r">textView</span> = <b>new</b> <span class="i">TextView</span>(<a href="P/388ed8e2a27bd299.html#388ed8e2a27bd299" class="k">this</a>)
			{
				<span class="i">TextSize</span> = 14,
				<span class="i">Text</span> = <span class="s">&quot;This will be text&quot;</span>
			};
 
			<b>var</b> <span id="r19 rd" class="r19 r">viewGroup</span> = <b>new</b> <span class="i">LinearLayout</span>(<a href="P/388ed8e2a27bd299.html#388ed8e2a27bd299" class="k">this</a>);
			<span class="r19 r">viewGroup</span>.<span class="i">AddView</span>(<span class="r18 r">textView</span>);
 
			<b>var</b> <span id="r20 rd" class="r20 r">buttonColor</span> = <b>new</b> <b>global</b>::<span class="i">Android</span>.<span class="i">Widget</span>.<span class="i">Button</span>(<a href="P/388ed8e2a27bd299.html#388ed8e2a27bd299" class="k">this</a>) { <span class="i">Text</span> = <span class="s">&quot;Change label Color&quot;</span> };
			<span class="r20 r">buttonColor</span>.<span class="i">Click</span> += (<span id="r21 rd" class="r21 r">sender</span>, <span id="r22 rd" class="r22 r">e</span>) =&gt; <span class="r18 r">textView</span>.<span class="i">SetTextColor</span>(<a href="/Xamarin.Forms.Core/A.html#8a6a061540451ec4" class="t t">Color</a>.<a href="/Xamarin.Forms.Core/A.html#0b58e2031b66a065" class="i field">Blue</a>.<span class="i">ToAndroid</span>());
 
			<a href="ColorPicker.cs.html#4ade1a546f7a3b47" class="k">var</a> <span id="r23 rd" class="r23 r">colorPicker</span> = <b>new</b> <span class="t">ColorPickerView</span>(<a href="P/388ed8e2a27bd299.html#388ed8e2a27bd299" class="k">this</a>, 200, 200);
 
			<span class="r18 r">textView</span>.<span class="i">SetBinding</span>(<b>nameof</b>(<span class="r18 r">textView</span>.<span class="i">Text</span>), <b>new</b> <span class="t">Binding</span>(<span class="s">&quot;NativeLabel&quot;</span>));
			<span class="c">//this doesn&#39;t work because there&#39;s not TextColor property</span>
			<span class="c">//textView.SetBinding(&quot;TextColor&quot;, new Binding(&quot;NativeLabelColor&quot;, converter: new ColorConverter()));</span>
			<span class="r23 r">colorPicker</span>.<span class="i">SetBinding</span>(<b>nameof</b>(<span class="r23 r">colorPicker</span>.<a href="ColorPicker.cs.html#632f749ed513b309" class="i property">SelectedColor</a>), <b>new</b> <span class="t">Binding</span>(<span class="s">&quot;NativeLabelColor&quot;</span>, <a href="/Xamarin.Forms.Core/A.html#fc1bd67c74123628" class="t t">BindingMode</a>.<a href="/Xamarin.Forms.Core/A.html#5b5de329b5adbce9" class="i field">TwoWay</a>, <b>new</b> <a href="#2fcf051477de65e7" class="t constructor">ColorConverter</a>()), <span class="s">&quot;ColorPicked&quot;</span>);
 
			<span class="r17 r">sl</span>?.<a href="/Xamarin.Forms.Core/A.html#5049824abac2f58c" class="i property">Children</a>.<span class="i">Add</span>(<span class="r19 r">viewGroup</span>);
			<span class="r17 r">sl</span>?.<a href="/Xamarin.Forms.Core/A.html#5049824abac2f58c" class="i property">Children</a>.<span class="i">Add</span>(<span class="r20 r">buttonColor</span>.<span class="i">ToView</span>());
			<span class="r17 r">sl</span>?.<a href="/Xamarin.Forms.Core/A.html#5049824abac2f58c" class="i property">Children</a>.<span class="i">Add</span>(<span class="r23 r">colorPicker</span>);
 
			<span class="r16 r">page</span>.<a href="/Xamarin.Forms.Controls/A.html#6fda383a93d625a4" class="i property">NativeControlsAdded</a> = <b>true</b>;
		}
 
		<b>public class</b> <a id="2fcf051477de65e7" href="R/2fcf051477de65e7.html" target="n" data-glyph="0,1" class="t t"><span id="637b9c7be1ba1c2c">ColorConverter</span></a> : <a href="/Xamarin.Forms.Core/A.html#8c54b2166c66ec65" class="t t">IValueConverter</a>
		{
			<b>public object</b> <a id="7130bf1e3439cb64" href="R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Convert</a>(<b>object</b> <span id="r24 rd" class="r24 r">value</span>, <span class="i">Type</span> <span id="r25 rd" class="r25 r">targetType</span>, <b>object</b> <span id="r26 rd" class="r26 r">parameter</span>, <span class="i">CultureInfo</span> <span id="r27 rd" class="r27 r">culture</span>)
			{
				<b>if</b> (<span class="r24 r">value</span> <b>is</b> <a href="/Xamarin.Forms.Core/A.html#8a6a061540451ec4" class="t t">Color</a>)
					<b>return</b> ((<a href="/Xamarin.Forms.Core/A.html#8a6a061540451ec4" class="t t">Color</a>)<span class="r24 r">value</span>).<span class="i">ToAndroid</span>();
 
				<b>return null</b>;
			}
 
			<b>public object</b> <a id="dcf1b700a89fc3ca" href="R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">ConvertBack</a>(<b>object</b> <span id="r28 rd" class="r28 r">value</span>, <span class="i">Type</span> <span id="r29 rd" class="r29 r">targetType</span>, <b>object</b> <span id="r30 rd" class="r30 r">parameter</span>, <span class="i">CultureInfo</span> <span id="r31 rd" class="r31 r">culture</span>)
			{
				<b>if</b> (<span class="r28 r">value</span> <b>is global</b>::<span class="i">Android</span>.<span class="i">Graphics</span>.<span class="i">Color</span>)
					<b>return</b> ((<b>global</b>::<span class="i">Android</span>.<span class="i">Graphics</span>.<span class="i">Color</span>)<span class="r28 r">value</span>).<span class="i">ToColor</span>();
 
				<b>return null</b>;
			}
		}
 
		[<span class="i">Export</span>(<span class="s">&quot;NavigateToTest&quot;</span>)]
		<b>public bool</b> <a id="f31d5d53336db005" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">NavigateToTest</a>(<b>string</b> <span id="r32 rd" class="r32 r">test</span>)
		{
			<b>return</b> <a href="#ffaac6468612eb06" class="i field">_app</a>.<span class="i">NavigateToTestPage</span>(<span class="r32 r">test</span>);
		}
 
		[<span class="i">Export</span>(<span class="s">&quot;Reset&quot;</span>)]
		<b>public void</b> <a id="0890b0f37dc6a000" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Reset</a>()
		{
			<a href="#ffaac6468612eb06" class="i field">_app</a>.<span class="i">Reset</span>();
		}
 
		<b>void</b> <a id="ea58e36af14973dd" href="R/ea58e36af14973dd.html" target="n" data-glyph="76,1" class="i method">SetUpForceRestartTest</a>()
		{
			<span class="c">// Listen for messages from the app restart test</span>
			<a href="/Xamarin.Forms.Core/A.html#68162056f69c1f2c" class="t t">MessagingCenter</a>.<span class="i">Subscribe</span>&lt;<a href="/Xamarin.Forms.Controls/A.html#9bba46118b2eea9c" class="t t">RestartAppTest</a>&gt;(<a href="P/388ed8e2a27bd299.html#388ed8e2a27bd299" class="k">this</a>, <a href="/Xamarin.Forms.Controls/A.html#9bba46118b2eea9c" class="t t">RestartAppTest</a>.<a href="/Xamarin.Forms.Controls/A.html#16ad97afa06cf9db" class="i field">ForceRestart</a>, (<span id="r33 rd" class="r33 r">e</span>) =&gt;
			{
				<span class="c">// We can force a restart by making a configuration change; in this case, we&#39;ll enter</span>
				<span class="c">// Car Mode. (The easy way to do this is to change the orientation, but ControlGallery</span>
				<span class="c">// handles orientation changes so they don&#39;t cause a restart.)</span>
 
				<b>var</b> <span id="r34 rd" class="r34 r">uiModeManager</span> = <span class="i">UiModeManager</span>.<span class="i">FromContext</span>(<a href="P/388ed8e2a27bd299.html#388ed8e2a27bd299" class="k">this</a>);
 
				<b>if</b> (<span class="r34 r">uiModeManager</span>.<span class="i">CurrentModeType</span> == <span class="i">UiMode</span>.<span class="i">TypeCar</span>)
				{
					<span class="c">// If for some reason we&#39;re already in car mode, disable it</span>
					<span class="r34 r">uiModeManager</span>.<span class="i">DisableCarMode</span>(<span class="i">DisableCarModeFlags</span>.<span class="i">None</span>);
				}
				
				<span class="r34 r">uiModeManager</span>.<span class="i">EnableCarMode</span>(<span class="i">EnableCarModeFlags</span>.<span class="i">None</span>);
 
				<span class="c">// And put things back to normal so we can keep running tests</span>
				<span class="r34 r">uiModeManager</span>.<span class="i">DisableCarMode</span>(<span class="i">DisableCarModeFlags</span>.<span class="i">None</span>);
			});
		}
	}
}
 
</pre></td></tr></table></div></body></html>
