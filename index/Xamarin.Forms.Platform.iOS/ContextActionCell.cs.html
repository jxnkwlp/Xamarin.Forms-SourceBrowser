<!DOCTYPE html>
<html><head><title>ContextActionCell.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(711);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="Xamarin.Forms.Platform.iOS/ContextActionCell.cs" target="_top">ContextActionCell.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xamarin.Forms.Platform.iOS" target="_top">Xamarin.Forms.Platform.iOS\Xamarin.Forms.Platform.iOS.csproj</a> (Xamarin.Forms.Platform.iOS)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Specialized</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>;
<b>using</b> <span class="i n">Foundation</span>;
<b>using</b> <span class="i n">UIKit</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Platform</span>.<span class="i n">iOS</span>.<span class="i n">Resources</span>;
<b>using</b> <span class="t">PointF</span> = <span class="i n">CoreGraphics</span>.<span class="t t">CGPoint</span>;
<b>using</b> <span class="t">RectangleF</span> = <span class="i n">CoreGraphics</span>.<span class="t t">CGRect</span>;
<b>using</b> <span class="t">SizeF</span> = <span class="i n">CoreGraphics</span>.<span class="t t">CGSize</span>;
 
<b>namespace</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Platform</span>.<span class="i n">iOS</span>
{
	<b>internal class</b> <a id="d2e23e4d18bf855d" href="R/d2e23e4d18bf855d.html" target="n" data-glyph="2,0" class="t t">ContextActionsCell</a> : <span class="t t">UITableViewCell</span>, <a href="/Xamarin.Forms.Core/A.html#71fbb484073b15d1" class="t t">INativeElementView</a>
	{
		<b>public const string</b> <a id="218267b154844685" href="R/218267b154844685.html" target="n" data-glyph="6,1" class="i field">Key</a> = <span class="s">&quot;ContextActionsCell&quot;</span>;
 
		<b>static readonly</b> <span class="t t">UIImage</span> <a id="5df6499ec79ede83" href="R/5df6499ec79ede83.html" target="n" data-glyph="46,1" class="i field">DestructiveBackground</a>;
		<b>static readonly</b> <span class="t t">UIImage</span> <a id="f2f855f4c6a2d618" href="R/f2f855f4c6a2d618.html" target="n" data-glyph="46,1" class="i field">NormalBackground</a>;
		<b>readonly</b> <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<span class="t t">UIButton</span>&gt; <a id="28aa3b97db70a43e" href="R/28aa3b97db70a43e.html" target="n" data-glyph="46,1" class="i field">_buttons</a> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<span class="t t">UIButton</span>&gt;();
		<b>readonly</b> <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="t t">MenuItem</a>&gt; <a id="dfd8948a4227dfd6" href="R/dfd8948a4227dfd6.html" target="n" data-glyph="46,1" class="i field">_menuItems</a> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="t t">MenuItem</a>&gt;();
 
		<a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a> <a id="4f244ba8561411bf" href="R/4f244ba8561411bf.html" target="n" data-glyph="46,1" class="i field">_cell</a>;
		<span class="t t">UIButton</span> <a id="e95acd008d3c3e43" href="R/e95acd008d3c3e43.html" target="n" data-glyph="46,1" class="i field">_moreButton</a>;
		<span class="t t">UIScrollView</span> <a id="69ad7f8aec67343b" href="R/69ad7f8aec67343b.html" target="n" data-glyph="46,1" class="i field">_scroller</a>;
		<span class="t t">UITableView</span> <a id="e6decb22778d48c0" href="R/e6decb22778d48c0.html" target="n" data-glyph="46,1" class="i field">_tableView</a>;
 
		<b>static</b> <a id="8580e329ef0347b6" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ContextActionsCell</a>()
		{
			<b>var</b> <span id="r0 rd" class="r0 r">rect</span> = <b>new</b> <span class="t constructor">RectangleF</span>(0, 0, 1, 1);
			<b>var</b> <span id="r1 rd" class="r1 r">size</span> = <span class="r0 r">rect</span>.<span class="i property">Size</span>;
 
			<span class="t t">UIGraphics</span>.<span class="i method">BeginImageContext</span>(<span class="r1 r">size</span>);
			<b>var</b> <span id="r2 rd" class="r2 r">context</span> = <span class="t t">UIGraphics</span>.<span class="i method">GetCurrentContext</span>();
			<span class="r2 r">context</span>.<span class="i method">SetFillColor</span>(1, 0, 0, 1);
			<span class="r2 r">context</span>.<span class="i method">FillRect</span>(<span class="r0 r">rect</span>);
			<a href="#5df6499ec79ede83" class="i field">DestructiveBackground</a> = <span class="t t">UIGraphics</span>.<span class="i method">GetImageFromCurrentImageContext</span>();
 
			<span class="r2 r">context</span>.<span class="i method">SetFillColor</span>(<span class="t t">UIColor</span>.<span class="i property">LightGray</span>.<a href="Extensions/ColorExtensions.cs.html#c31c7039f5c1c36b" class="i method">ToColor</a>().<a href="Extensions/ColorExtensions.cs.html#2cc83a768ee013c4" class="i method">ToCGColor</a>());
			<span class="r2 r">context</span>.<span class="i method">FillRect</span>(<span class="r0 r">rect</span>);
 
			<a href="#f2f855f4c6a2d618" class="i field">NormalBackground</a> = <span class="t t">UIGraphics</span>.<span class="i method">GetImageFromCurrentImageContext</span>();
 
			<span class="r2 r">context</span>.<span class="i method">Dispose</span>();
		}
 
		<b>public</b> <a id="b4f802f0224a6854" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i constructor">ContextActionsCell</a>() : <b>base</b>(<span class="t t">UITableViewCellStyle</span>.<span class="i field">Default</span>, <a href="#218267b154844685" class="i field">Key</a>)
		{
		}
 
		<b>public</b> <a id="74c8f8f4e1a53e62" href="R/74c8f8f4e1a53e62.html" target="n" data-glyph="72,1" class="i constructor">ContextActionsCell</a>(<b>string</b> <span id="r3 rd" class="r3 r">templateId</span>) : <b>base</b>(<span class="t t">UITableViewCellStyle</span>.<span class="i field">Default</span>, <a href="#218267b154844685" class="i field">Key</a> + <span class="r3 r">templateId</span>)
		{
		}
 
		<b>public</b> <span class="t t">UITableViewCell</span> <a id="afa1754f4117b8cf" href="R/afa1754f4117b8cf.html" target="n" data-glyph="102,1" class="i property">ContentCell</a> { <b>get</b>; <b>private set</b>; }
 
		<b>public bool</b> <a id="a6b6ebb0f29cd0bd" href="R/a6b6ebb0f29cd0bd.html" target="n" data-glyph="102,1" class="i property">IsOpen</a>
		{
			<b>get</b> { <b>return</b> <a href="#927d7db173a006e0" class="i property">ScrollDelegate</a>.<a href="ContextScrollViewDelegate.cs.html#930d7136cd2c5294" class="i property">IsOpen</a>; }
		}
 
		<a href="ContextScrollViewDelegate.cs.html#43bd7d4147f39e2c" class="t t">ContextScrollViewDelegate</a> <a id="927d7db173a006e0" href="R/927d7db173a006e0.html" target="n" data-glyph="106,1" class="i property">ScrollDelegate</a>
		{
			<b>get</b> { <b>return</b> (<a href="ContextScrollViewDelegate.cs.html#43bd7d4147f39e2c" class="t t">ContextScrollViewDelegate</a>)<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">Delegate</span>; }
		}
 
		<a href="/Xamarin.Forms.Core/A.html#76098df8350c0484" class="t t">Element</a> <a href="/Xamarin.Forms.Core/A.html#71fbb484073b15d1" class="t t">INativeElementView</a>.<a href="/Xamarin.Forms.Core/A.html#2bd1b4b350c894af" class="i property">Element</a>
		{
			<b>get</b>
			{
				<a href="/Xamarin.Forms.Core/A.html#71fbb484073b15d1" class="k">var</a> <span id="r4 rd" class="r4 r">boxedCell</span> = <a href="#afa1754f4117b8cf" class="i property">ContentCell</a> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#71fbb484073b15d1" class="t t">INativeElementView</a>;
				<b>if</b> (<span class="r4 r">boxedCell</span> == <b>null</b>)
				{
					<b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>(<span class="s">$&quot;</span><span class="s">Implement </span>{<b>nameof</b>(<a href="/Xamarin.Forms.Core/A.html#71fbb484073b15d1" class="t t">INativeElementView</a>)}<span class="s"> on cell renderer: </span>{<a href="#afa1754f4117b8cf" class="i property">ContentCell</a>.<a href="@0@mscorlib/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@0@mscorlib/A.html#760775dbd11fb354" class="i property">AssemblyQualifiedName</a>}<span class="s">&quot;</span>);
				}
 
				<b>return</b> <span class="r4 r">boxedCell</span>.<a href="/Xamarin.Forms.Core/A.html#2bd1b4b350c894af" class="i property">Element</a>;
			}
		}
 
		<b>public void</b> <a id="68169688eeda60d5" href="R/68169688eeda60d5.html" target="n" data-glyph="72,1" class="i method">Close</a>()
		{
			<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">ContentOffset</span> = <b>new</b> <span class="t constructor">PointF</span>(0, 0);
		}
 
		<b>public override void</b> <a id="c6b338bb37d0539e" href="R/c6b338bb37d0539e.html" target="n" data-glyph="72,1" class="i method">LayoutSubviews</a>()
		{
			<b>base</b>.<span class="i method">LayoutSubviews</span>();
 
			<span class="c">// Leave room for 1px of play because the border is 1 or .5px and must be accounted for.</span>
			<b>if</b> (<a href="#69ad7f8aec67343b" class="i field">_scroller</a> == <b>null</b> || (<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">Frame</span>.<span class="i property">Width</span> == <span class="i property">ContentView</span>.<span class="i property">Bounds</span>.<span class="i property">Width</span> &amp;&amp; <a href="@0@mscorlib/A.html#a4407e67b9a5afad" class="t t">Math</a>.<a href="@0@mscorlib/A.html#36d8f3b3bd14bad6" class="i method">Abs</a>(<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">Frame</span>.<span class="i property">Height</span> - <span class="i property">ContentView</span>.<span class="i property">Bounds</span>.<span class="i property">Height</span>) &lt; 1))
				<b>return</b>;
 
			<a href="#ca5cd44f123ed8a3" class="i method">Update</a>(<a href="#e6decb22778d48c0" class="i field">_tableView</a>, <a href="#4f244ba8561411bf" class="i field">_cell</a>, <a href="#afa1754f4117b8cf" class="i property">ContentCell</a>);
 
			<b>if</b> (<a href="#afa1754f4117b8cf" class="i property">ContentCell</a> <b>is</b> <a href="Cells/ViewCellRenderer.cs.html#6c2643c111649c05" class="t t">ViewCellRenderer</a>.<a href="Cells/ViewCellRenderer.cs.html#10b7ddd4c3401d3a" class="t t">ViewTableCell</a> &amp;&amp; <a href="#afa1754f4117b8cf" class="i property">ContentCell</a>.<span class="i property">Subviews</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0 &amp;&amp; <a href="@0@mscorlib/A.html#a4407e67b9a5afad" class="t t">Math</a>.<a href="@0@mscorlib/A.html#36d8f3b3bd14bad6" class="i method">Abs</a>(<a href="#afa1754f4117b8cf" class="i property">ContentCell</a>.<span class="i property">Subviews</span>[0].<span class="i property">Frame</span>.<span class="i property">Height</span> - <span class="i property">Bounds</span>.<span class="i property">Height</span>) &gt; 1)
			{
				<span class="c">// Something goes weird inside iOS where LayoutSubviews wont get called when updating the bounds if the user</span>
				<span class="c">// forces us to flip flop between a ContextActionCell and a normal cell in the middle of actually displaying the cell</span>
				<span class="c">// so here we are going to hack it a forced update. Leave room for 1px of play because the border is 1 or .5px and must</span>
				<span class="c">// be accounted for.</span>
				<span class="c">//</span>
				<span class="c">// Fixes https://bugzilla.xamarin.com/show_bug.cgi?id=39450</span>
				<a href="#afa1754f4117b8cf" class="i property">ContentCell</a>.<span class="i method">LayoutSubviews</span>();
			}
		}
 
		<b>public void</b> <a id="b879654a9ced4009" href="R/b879654a9ced4009.html" target="n" data-glyph="72,1" class="i method">PrepareForDeselect</a>()
		{
			<a href="#927d7db173a006e0" class="i property">ScrollDelegate</a>.<a href="ContextScrollViewDelegate.cs.html#2ef4eb7ae9fa3b2c" class="i method">PrepareForDeselect</a>(<a href="#69ad7f8aec67343b" class="i field">_scroller</a>);
		}
 
		<b>public override</b> <span class="t t">SizeF</span> <a id="1b4b883709b97eb0" href="R/1b4b883709b97eb0.html" target="n" data-glyph="72,1" class="i method">SizeThatFits</a>(<span class="t t">SizeF</span> <span id="r5 rd" class="r5 r">size</span>)
		{
			<b>return</b> <a href="#afa1754f4117b8cf" class="i property">ContentCell</a>.<span class="i method">SizeThatFits</span>(<span class="r5 r">size</span>);
		}
 
		<b>public void</b> <a id="ca5cd44f123ed8a3" href="R/ca5cd44f123ed8a3.html" target="n" data-glyph="72,1" class="i method">Update</a>(<span class="t t">UITableView</span> <span id="r6 rd" class="r6 r">tableView</span>, <a href="/Xamarin.Forms.Core/A.html#7706486019503b22" class="t t">Cell</a> <span id="r7 rd" class="r7 r">cell</span>, <span class="t t">UITableViewCell</span> <span id="r8 rd" class="r8 r">nativeCell</span>)
		{
			<a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="k">var</a> <span id="r9 rd" class="r9 r">parentListView</span> = <span class="r7 r">cell</span>.<a href="/Xamarin.Forms.Core/A.html#3a1e78d030ef9bf3" class="i property">RealParent</a> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="t t">ListView</a>;
			<a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r10 rd" class="r10 r">recycling</span> = <span class="r9 r">parentListView</span> != <b>null</b> &amp;&amp; 
				((<span class="r9 r">parentListView</span>.<a href="/Xamarin.Forms.Core/A.html#853e43c3430ca1d5" class="i property">CachingStrategy</a> &amp; <a href="/Xamarin.Forms.Core/A.html#7325a6e87ebf132d" class="t t">ListViewCachingStrategy</a>.<a href="/Xamarin.Forms.Core/A.html#791a8ea6a96061a0" class="i field">RecycleElement</a>) != 0);
			<b>if</b> (<a href="#4f244ba8561411bf" class="i field">_cell</a> != <span class="r7 r">cell</span> &amp;&amp; <span class="r10 r">recycling</span>)
			{
				<b>if</b> (<a href="#4f244ba8561411bf" class="i field">_cell</a> != <b>null</b>)
					((<a href="@0@System/A.html#c0af625dba98c968" class="t t">INotifyCollectionChanged</a>)<a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>).<a href="@0@System/A.html#26300c777385ef7c" class="i">CollectionChanged</a> -= <a href="#6d72a0858cd2f488" class="i method">OnContextItemsChanged</a>;
 
				((<a href="@0@System/A.html#c0af625dba98c968" class="t t">INotifyCollectionChanged</a>)<span class="r7 r">cell</span>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>).<a href="@0@System/A.html#26300c777385ef7c" class="i">CollectionChanged</a> += <a href="#6d72a0858cd2f488" class="i method">OnContextItemsChanged</a>;
			}
 
			<b>var</b> <span id="r11 rd" class="r11 r">height</span> = <span class="i property">Frame</span>.<span class="i property">Height</span> + (<span class="r9 r">parentListView</span> != <b>null</b> &amp;&amp; <span class="r9 r">parentListView</span>.<a href="/Xamarin.Forms.Core/A.html#13ecaa648f4c9b20" class="i property">SeparatorVisibility</a> == <a href="/Xamarin.Forms.Core/A.html#a9cb5fa58c2bf8a3" class="t t">SeparatorVisibility</a>.<a href="/Xamarin.Forms.Core/A.html#d4c90898b212f883" class="i field">None</a> ? 0.5f : 0f);
			<b>var</b> <span id="r12 rd" class="r12 r">width</span> = <span class="i property">ContentView</span>.<span class="i property">Frame</span>.<span class="i property">Width</span>;
 
			<span class="r8 r">nativeCell</span>.<span class="i property">Frame</span> = <b>new</b> <span class="t constructor">RectangleF</span>(0, 0, <span class="r12 r">width</span>, <span class="r11 r">height</span>);
			<span class="r8 r">nativeCell</span>.<span class="i method">SetNeedsLayout</span>();
 
			<a href="@0@System/A.html#670754815f6804ff" class="k">var</a> <span id="r13 rd" class="r13 r">handler</span> = <b>new</b> <span class="t">PropertyChangedEventHandler</span>(<a href="#62f1b7c6632822ce" class="i method">OnMenuItemPropertyChanged</a>);
 
			<a href="#e6decb22778d48c0" class="i field">_tableView</a> = <span class="r6 r">tableView</span>;
			<a href="#ad61a7e321f28360" class="i method">SetupSelection</a>(<span class="r6 r">tableView</span>);
 
			<b>if</b> (<a href="#4f244ba8561411bf" class="i field">_cell</a> != <b>null</b>)
			{
				<b>if</b> (!<span class="r10 r">recycling</span>)
					<a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#72c3e722cf6fa9ba" class="i">PropertyChanged</a> -= <a href="#7501d0d7dfb0f8f8" class="i method">OnCellPropertyChanged</a>;
				<b>if</b> (<a href="#dfd8948a4227dfd6" class="i field">_menuItems</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> &gt; 0)
				{
					<b>if</b> (!<span class="r10 r">recycling</span>)
						((<a href="@0@System/A.html#c0af625dba98c968" class="t t">INotifyCollectionChanged</a>)<a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>).<a href="@0@System/A.html#26300c777385ef7c" class="i">CollectionChanged</a> -= <a href="#6d72a0858cd2f488" class="i method">OnContextItemsChanged</a>;
 
					<b>foreach</b> (<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="k">var</a> <span id="r14 rd" class="r14 r">item</span> <b>in</b> <a href="#dfd8948a4227dfd6" class="i field">_menuItems</a>)
						<span class="r14 r">item</span>.<a href="/Xamarin.Forms.Core/A.html#72c3e722cf6fa9ba" class="i">PropertyChanged</a> -= <span class="r13 r">handler</span>;
				}
 
				<a href="#dfd8948a4227dfd6" class="i field">_menuItems</a>.<a href="@0@mscorlib/A.html#ca7bce81a50b0aeb" class="i method">Clear</a>();
			}
 
			<a href="#dfd8948a4227dfd6" class="i field">_menuItems</a>.<a href="@0@mscorlib/A.html#e569d850a66a1771" class="i method">AddRange</a>(<span class="r7 r">cell</span>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>);
 
			<a href="#4f244ba8561411bf" class="i field">_cell</a> = <span class="r7 r">cell</span>;
			<b>if</b> (!<span class="r10 r">recycling</span>)
			{
				<span class="r7 r">cell</span>.<a href="/Xamarin.Forms.Core/A.html#72c3e722cf6fa9ba" class="i">PropertyChanged</a> += <a href="#7501d0d7dfb0f8f8" class="i method">OnCellPropertyChanged</a>;
				((<a href="@0@System/A.html#c0af625dba98c968" class="t t">INotifyCollectionChanged</a>)<a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>).<a href="@0@System/A.html#26300c777385ef7c" class="i">CollectionChanged</a> += <a href="#6d72a0858cd2f488" class="i method">OnContextItemsChanged</a>;
			}
 
			<a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r15 rd" class="r15 r">isOpen</span> = <b>false</b>;
 
			<b>if</b> (<a href="#69ad7f8aec67343b" class="i field">_scroller</a> == <b>null</b>)
			{
				<a href="#69ad7f8aec67343b" class="i field">_scroller</a> = <b>new</b> <span class="t constructor">UIScrollView</span>(<b>new</b> <span class="t constructor">RectangleF</span>(0, 0, <span class="r12 r">width</span>, <span class="r11 r">height</span>));
				<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">ScrollsToTop</span> = <b>false</b>;
				<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">ShowsHorizontalScrollIndicator</span> = <b>false</b>;
				
				<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">PreservesSuperviewLayoutMargins</span> = <b>true</b>;
 
				<span class="i property">ContentView</span>.<span class="i method">AddSubview</span>(<a href="#69ad7f8aec67343b" class="i field">_scroller</a>);
			}
			<b>else</b>
			{
				<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">Frame</span> = <b>new</b> <span class="t constructor">RectangleF</span>(0, 0, <span class="r12 r">width</span>, <span class="r11 r">height</span>);
				<span class="r15 r">isOpen</span> = <a href="#927d7db173a006e0" class="i property">ScrollDelegate</a>.<a href="ContextScrollViewDelegate.cs.html#930d7136cd2c5294" class="i property">IsOpen</a>;
 
				<b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r16 rd" class="r16 r">i</span> = 0; <span class="r16 r">i</span> &lt; <a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a>; <span class="r16 r">i</span>++)
				{
					<b>var</b> <span id="r17 rd" class="r17 r">b</span> = <a href="#28aa3b97db70a43e" class="i field">_buttons</a><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r16 r">i</span>];
					<span class="r17 r">b</span>.<span class="i method">RemoveFromSuperview</span>();
					<span class="r17 r">b</span>.<span class="i method">Dispose</span>();
				}
 
				<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#ca7bce81a50b0aeb" class="i method">Clear</a>();
 
				<a href="#927d7db173a006e0" class="i property">ScrollDelegate</a>.<a href="ContextScrollViewDelegate.cs.html#7773ceb42b310f8d" class="i method">Unhook</a>(<a href="#69ad7f8aec67343b" class="i field">_scroller</a>);
				<a href="#927d7db173a006e0" class="i property">ScrollDelegate</a>.<span class="i method">Dispose</span>();
			}
 
			<b>if</b> (<a href="#afa1754f4117b8cf" class="i property">ContentCell</a> != <span class="r8 r">nativeCell</span>)
			{
				<b>if</b> (<a href="#afa1754f4117b8cf" class="i property">ContentCell</a> != <b>null</b>)
				{
					<a href="#afa1754f4117b8cf" class="i property">ContentCell</a>.<span class="i method">RemoveFromSuperview</span>();
					<a href="#afa1754f4117b8cf" class="i property">ContentCell</a> = <b>null</b>;
				}
 
				<a href="#afa1754f4117b8cf" class="i property">ContentCell</a> = <span class="r8 r">nativeCell</span>;
 
				<span class="c">//Hack: if we have a ImageCell the insets are slightly different,</span>
				<span class="c">//the inset numbers user below were taken using the Reveal app from the default cells</span>
				<b>if</b> ((<a href="#afa1754f4117b8cf" class="i property">ContentCell</a> <b>as</b> <a href="Cells/CellTableViewCell.cs.html#a1c676b356c83490" class="t t">CellTableViewCell</a>)?.<a href="Cells/CellTableViewCell.cs.html#59581dc60efbf6c3" class="i property">Cell</a> <b>is</b> <a href="/Xamarin.Forms.Core/A.html#a07d7ee901d718e8" class="t t">ImageCell</a>)
				{
					<span class="t t">nfloat</span> <span id="r18 rd" class="r18 r">imageCellInsetLeft</span> = 57;
					<span class="t t">nfloat</span> <span id="r19 rd" class="r19 r">imageCellInsetRight</span> = 0;
					<b>if</b> (<span class="t t">UIDevice</span>.<span class="i property">CurrentDevice</span>.<span class="i property">UserInterfaceIdiom</span> == <span class="t t">UIUserInterfaceIdiom</span>.<span class="i field">Pad</span>)
					{
						<span class="r18 r">imageCellInsetLeft</span> = 89;
						<span class="r19 r">imageCellInsetRight</span> = <span class="r18 r">imageCellInsetLeft</span> / 2;
					}
					<span class="i property">SeparatorInset</span> = <b>new</b> <span class="t constructor">UIEdgeInsets</span>(0, <span class="r18 r">imageCellInsetLeft</span>, 0, <span class="r19 r">imageCellInsetRight</span>);
				}
 
				<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i method">AddSubview</span>(<span class="r8 r">nativeCell</span>);
			}
 
			<a href="#db193b9dcd0c3f44" class="i method">SetupButtons</a>(<span class="r12 r">width</span>, <span class="r11 r">height</span>);
 
			<span class="t t">UIView</span> <span id="r20 rd" class="r20 r">container</span> = <b>null</b>;
 
			<b>var</b> <span id="r21 rd" class="r21 r">totalWidth</span> = <span class="r12 r">width</span>;
			<b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r22 rd" class="r22 r">i</span> = <a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1; <span class="r22 r">i</span> &gt;= 0; <span class="r22 r">i</span>--)
			{
				<b>var</b> <span id="r23 rd" class="r23 r">b</span> = <a href="#28aa3b97db70a43e" class="i field">_buttons</a><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r22 r">i</span>];
				<span class="r21 r">totalWidth</span> += <span class="r23 r">b</span>.<span class="i property">Frame</span>.<span class="i property">Width</span>;
 
				<b>if</b> (<span class="t t">UIDevice</span>.<span class="i property">CurrentDevice</span>.<span class="i method">CheckSystemVersion</span>(8, 0))
					<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i method">AddSubview</span>(<span class="r23 r">b</span>);
				<b>else</b>
				{
					<b>if</b> (<span class="r20 r">container</span> == <b>null</b>)
					{
						<span class="r20 r">container</span> = <b>new</b> <a href="ContextScrollViewDelegate.cs.html#77e0f45e8ec02f85" class="t constructor">iOS7ButtonContainer</a>(<span class="r23 r">b</span>.<span class="i property">Frame</span>.<span class="i property">Width</span>);
						<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i method">InsertSubview</span>(<span class="r20 r">container</span>, 0);
					}
 
					<span class="r20 r">container</span>.<span class="i method">AddSubview</span>(<span class="r23 r">b</span>);
				}
			}
 
			<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">Delegate</span> = <b>new</b> <a href="ContextScrollViewDelegate.cs.html#d28fe8acea42269f" class="t constructor">ContextScrollViewDelegate</a>(<span class="r20 r">container</span>, <a href="#28aa3b97db70a43e" class="i field">_buttons</a>, <span class="r15 r">isOpen</span>);
			<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">ContentSize</span> = <b>new</b> <span class="t constructor">SizeF</span>(<span class="r21 r">totalWidth</span>, <span class="r11 r">height</span>);
 
			<b>if</b> (<span class="r15 r">isOpen</span>)
				<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i method">SetContentOffset</span>(<b>new</b> <span class="t constructor">PointF</span>(<a href="#927d7db173a006e0" class="i property">ScrollDelegate</a>.<a href="ContextScrollViewDelegate.cs.html#526d5be0fb9e59ca" class="i property">ButtonsWidth</a>, 0), <b>false</b>);
			<b>else</b>
				<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i method">SetContentOffset</span>(<b>new</b> <span class="t constructor">PointF</span>(0, 0), <b>false</b>);
 
			<b>if</b> (<a href="#afa1754f4117b8cf" class="i property">ContentCell</a> != <b>null</b>)
			{
				<span class="i property">SelectionStyle</span> = <a href="#afa1754f4117b8cf" class="i property">ContentCell</a>.<span class="i property">SelectionStyle</span>;
			}
		}
 
		<b>protected override void</b> <a id="6e42615dd3599f7a" href="R/6e42615dd3599f7a.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r24 rd" class="r24 r">disposing</span>)
		{
			<b>if</b> (<span class="r24 r">disposing</span>)
			{
				<b>if</b> (<a href="#69ad7f8aec67343b" class="i field">_scroller</a> != <b>null</b>)
				{
					<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i method">Dispose</span>();
					<a href="#69ad7f8aec67343b" class="i field">_scroller</a> = <b>null</b>;
				}
 
				<a href="#e6decb22778d48c0" class="i field">_tableView</a> = <b>null</b>;
 
				<b>if</b> (<a href="#e95acd008d3c3e43" class="i field">_moreButton</a> != <b>null</b>)
				{
					<a href="#e95acd008d3c3e43" class="i field">_moreButton</a>.<span class="i method">Dispose</span>();
					<a href="#e95acd008d3c3e43" class="i field">_moreButton</a> = <b>null</b>;
				}
 
				<b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r25 rd" class="r25 r">i</span> = 0; <span class="r25 r">i</span> &lt; <a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a>; <span class="r25 r">i</span>++)
					<a href="#28aa3b97db70a43e" class="i field">_buttons</a><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r25 r">i</span>].<span class="i method">Dispose</span>();
 
				<a href="@0@System/A.html#670754815f6804ff" class="k">var</a> <span id="r26 rd" class="r26 r">handler</span> = <b>new</b> <span class="t">PropertyChangedEventHandler</span>(<a href="#62f1b7c6632822ce" class="i method">OnMenuItemPropertyChanged</a>);
 
				<b>foreach</b> (<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="k">var</a> <span id="r27 rd" class="r27 r">item</span> <b>in</b> <a href="#dfd8948a4227dfd6" class="i field">_menuItems</a>)
					<span class="r27 r">item</span>.<a href="/Xamarin.Forms.Core/A.html#72c3e722cf6fa9ba" class="i">PropertyChanged</a> -= <span class="r26 r">handler</span>;
 
				<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#ca7bce81a50b0aeb" class="i method">Clear</a>();
				<a href="#dfd8948a4227dfd6" class="i field">_menuItems</a>.<a href="@0@mscorlib/A.html#ca7bce81a50b0aeb" class="i method">Clear</a>();
 
				<b>if</b> (<a href="#4f244ba8561411bf" class="i field">_cell</a> != <b>null</b>)
				{
					<b>if</b> (<a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#c18f293b9c4fd7e6" class="i property">HasContextActions</a>)
						((<a href="@0@System/A.html#c0af625dba98c968" class="t t">INotifyCollectionChanged</a>)<a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>).<a href="@0@System/A.html#26300c777385ef7c" class="i">CollectionChanged</a> -= <a href="#6d72a0858cd2f488" class="i method">OnContextItemsChanged</a>;
					<a href="#4f244ba8561411bf" class="i field">_cell</a> = <b>null</b>;
				}
			}
 
			<b>base</b>.<span class="i method">Dispose</span>(<span class="r24 r">disposing</span>);
		}
 
		<b>void</b> <a id="1248d26a47a42807" href="R/1248d26a47a42807.html" target="n" data-glyph="76,1" class="i method">ActivateMore</a>()
		{
			<a href="@0@System.Core/A.html#2d265edc718b158b" class="k">var</a> <span id="r28 rd" class="r28 r">displayed</span> = <b>new</b> <a href="@0@System.Core/A.html#eca9ea30fa3b2c28" class="t constructor">HashSet</a>&lt;<span class="t t">nint</span>&gt;();
			<b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r29 rd" class="r29 r">i</span> = 0; <span class="r29 r">i</span> &lt; <a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a>; <span class="r29 r">i</span>++)
			{
				<b>var</b> <span id="r30 rd" class="r30 r">tag</span> = <a href="#28aa3b97db70a43e" class="i field">_buttons</a><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r29 r">i</span>].<span class="i property">Tag</span>;
				<b>if</b> (<span class="r30 r">tag</span> &gt;= 0)
					<span class="r28 r">displayed</span>.<a href="@0@System.Core/A.html#43a2b651926474a7" class="i method">Add</a>(<span class="r30 r">tag</span>);
			}
 
			<b>var</b> <span id="r31 rd" class="r31 r">frame</span> = <a href="#e95acd008d3c3e43" class="i field">_moreButton</a>.<span class="i property">Frame</span>;
 
			<b>var</b> <span id="r32 rd" class="r32 r">x</span> = <span class="r31 r">frame</span>.<span class="i property">X</span> - <a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">ContentOffset</span>.<span class="i property">X</span>;
 
			<b>var</b> <span id="r33 rd" class="r33 r">path</span> = <a href="#e6decb22778d48c0" class="i field">_tableView</a>.<span class="i method">IndexPathForCell</span>(<a href="#d2e23e4d18bf855d" class="k">this</a>);
			<b>var</b> <span id="r34 rd" class="r34 r">rowPosition</span> = <a href="#e6decb22778d48c0" class="i field">_tableView</a>.<span class="i method">RectForRowAtIndexPath</span>(<span class="r33 r">path</span>);
			<b>var</b> <span id="r35 rd" class="r35 r">sourceRect</span> = <b>new</b> <span class="t constructor">RectangleF</span>(<span class="r32 r">x</span>, <span class="r34 r">rowPosition</span>.<span class="i property">Y</span>, <span class="r34 r">rowPosition</span>.<span class="i property">Width</span>, <span class="r34 r">rowPosition</span>.<span class="i property">Height</span>);
 
			<b>if</b> (<span class="t t">UIDevice</span>.<span class="i property">CurrentDevice</span>.<span class="i method">CheckSystemVersion</span>(8, 0))
			{
				<a href="#a5a53e7b64035846" class="k">var</a> <span id="r36 rd" class="r36 r">actionSheet</span> = <b>new</b> <a href="#a5a53e7b64035846" class="t constructor">MoreActionSheetController</a>();
 
				<b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r37 rd" class="r37 r">i</span> = 0; <span class="r37 r">i</span> &lt; <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a>; <span class="r37 r">i</span>++)
				{
					<b>if</b> (<span class="r28 r">displayed</span>.<a href="@0@System.Core/A.html#06d905a0ac76e4f5" class="i method">Contains</a>(<span class="r37 r">i</span>))
						<b>continue</b>;
 
					<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="k">var</a> <span id="r38 rd" class="r38 r">item</span> = <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a><a href="@0@mscorlib/A.html#396bb785d31f5979">[</a><span class="r37 r">i</span>];
					<a href="@0@mscorlib/A.html#809df5135c2bec67" class="k">var</a> <span id="r39 rd" class="r39 r">weakItem</span> = <b>new</b> <a href="@0@mscorlib/A.html#0bcc5ece65ea67eb" class="t constructor">WeakReference</a>&lt;<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="t t">MenuItem</a>&gt;(<span class="r38 r">item</span>);
					<b>var</b> <span id="r40 rd" class="r40 r">action</span> = <span class="t t">UIAlertAction</span>.<span class="i method">Create</span>(<span class="r38 r">item</span>.<a href="/Xamarin.Forms.Core/A.html#2e0c5c546b8a8b5b" class="i property">Text</a>, <span class="t t">UIAlertActionStyle</span>.<span class="i field">Default</span>, <span id="r41 rd" class="r41 r">a</span> =&gt;
					{
						<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i method">SetContentOffset</span>(<b>new</b> <span class="t constructor">PointF</span>(0, 0), <b>true</b>);
						<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="t t">MenuItem</a> <span id="r42 rd" class="r42 r">mi</span>;
						<b>if</b> (<span class="r39 r">weakItem</span>.<a href="@0@mscorlib/A.html#655561bce79c86cd" class="i method">TryGetTarget</a>(<b>out</b> <span class="r42 r">mi</span>))
							<span class="r42 r">mi</span>.<a href="/Xamarin.Forms.Core/A.html#acfa69a60a16cf67" class="i method">Activate</a>();
					});
					<span class="r36 r">actionSheet</span>.<span class="i method">AddAction</span>(<span class="r40 r">action</span>);
				}
 
				<b>var</b> <span id="r43 rd" class="r43 r">controller</span> = <a href="#cfddbafd50bd4f19" class="i method">GetController</a>();
				<b>if</b> (<span class="r43 r">controller</span> == <b>null</b>)
					<b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#265d72f49e915224" class="t constructor">InvalidOperationException</a>(<span class="s">&quot;No UIViewController found to present.&quot;</span>);
 
				<b>if</b> (<span class="t t">UIDevice</span>.<span class="i property">CurrentDevice</span>.<span class="i property">UserInterfaceIdiom</span> == <span class="t t">UIUserInterfaceIdiom</span>.<span class="i field">Phone</span>)
				{
					<b>var</b> <span id="r44 rd" class="r44 r">cancel</span> = <span class="t t">UIAlertAction</span>.<span class="i method">Create</span>(<a href="Resources/StringResources.Designer.cs.html#90263a29ac0e4c3e" class="t t">StringResources</a>.<a href="Resources/StringResources.Designer.cs.html#49c4998af5e31498" class="i property">Cancel</a>, <span class="t t">UIAlertActionStyle</span>.<span class="i field">Cancel</span>, <b>null</b>);
					<span class="r36 r">actionSheet</span>.<span class="i method">AddAction</span>(<span class="r44 r">cancel</span>);
				}
				<b>else</b>
				{
					<span class="r36 r">actionSheet</span>.<span class="i property">PopoverPresentationController</span>.<span class="i property">SourceView</span> = <a href="#e6decb22778d48c0" class="i field">_tableView</a>;
					<span class="r36 r">actionSheet</span>.<span class="i property">PopoverPresentationController</span>.<span class="i property">SourceRect</span> = <span class="r35 r">sourceRect</span>;
				}
 
				<span class="r43 r">controller</span>.<span class="i method">PresentViewController</span>(<span class="r36 r">actionSheet</span>, <b>true</b>, <b>null</b>);
			}
			<b>else</b>
			{
				<a href="#90b816ab6d07387a" class="k">var</a> <span id="r45 rd" class="r45 r">d</span> = <b>new</b> <a href="#90b816ab6d07387a" class="t constructor">MoreActionSheetDelegate</a> { <a href="#3edb7748ea53d626" class="i field">Scroller</a> = <a href="#69ad7f8aec67343b" class="i field">_scroller</a>, <a href="#5479ca6fcc54e821" class="i field">Items</a> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="t t">MenuItem</a>&gt;() };
 
				<b>var</b> <span id="r46 rd" class="r46 r">actionSheet</span> = <b>new</b> <span class="t constructor">UIActionSheet</span>(<b>null</b>, (<span class="t t">IUIActionSheetDelegate</span>)<span class="r45 r">d</span>);
 
				<b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r47 rd" class="r47 r">i</span> = 0; <span class="r47 r">i</span> &lt; <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a>; <span class="r47 r">i</span>++)
				{
					<b>if</b> (<span class="r28 r">displayed</span>.<a href="@0@System.Core/A.html#06d905a0ac76e4f5" class="i method">Contains</a>(<span class="r47 r">i</span>))
						<b>continue</b>;
 
					<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="k">var</a> <span id="r48 rd" class="r48 r">item</span> = <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a><a href="@0@mscorlib/A.html#396bb785d31f5979">[</a><span class="r47 r">i</span>];
					<span class="r45 r">d</span>.<a href="#5479ca6fcc54e821" class="i field">Items</a>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r48 r">item</span>);
					<span class="r46 r">actionSheet</span>.<span class="i method">AddButton</span>(<span class="r48 r">item</span>.<a href="/Xamarin.Forms.Core/A.html#2e0c5c546b8a8b5b" class="i property">Text</a>);
				}
 
				<b>if</b> (<span class="t t">UIDevice</span>.<span class="i property">CurrentDevice</span>.<span class="i property">UserInterfaceIdiom</span> == <span class="t t">UIUserInterfaceIdiom</span>.<span class="i field">Phone</span>)
				{
					<b>var</b> <span id="r49 rd" class="r49 r">index</span> = <span class="r46 r">actionSheet</span>.<span class="i method">AddButton</span>(<a href="Resources/StringResources.Designer.cs.html#90263a29ac0e4c3e" class="t t">StringResources</a>.<a href="Resources/StringResources.Designer.cs.html#49c4998af5e31498" class="i property">Cancel</a>);
					<span class="r46 r">actionSheet</span>.<span class="i property">CancelButtonIndex</span> = <span class="r49 r">index</span>;
				}
 
				<span class="r46 r">actionSheet</span>.<span class="i method">ShowFrom</span>(<span class="r35 r">sourceRect</span>, <a href="#e6decb22778d48c0" class="i field">_tableView</a>, <b>true</b>);
			}
		}
 
		<b>void</b> <a id="1651146b3bef2928" href="R/1651146b3bef2928.html" target="n" data-glyph="76,1" class="i method">CullButtons</a>(<span class="t t">nfloat</span> <span id="r50 rd" class="r50 r">acceptableTotalWidth</span>, <b>ref bool</b> <span id="r51 rd" class="r51 r">needMoreButton</span>, <b>ref</b> <span class="t t">nfloat</span> <span id="r52 rd" class="r52 r">largestButtonWidth</span>)
		{
			<b>while</b> (<span class="r52 r">largestButtonWidth</span> * (<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> + (<span class="r51 r">needMoreButton</span> ? 1 : 0)) &gt; <span class="r50 r">acceptableTotalWidth</span> &amp;&amp; <a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> &gt; 1)
			{
				<span class="r51 r">needMoreButton</span> = <b>true</b>;
 
				<b>var</b> <span id="r53 rd" class="r53 r">button</span> = <a href="#28aa3b97db70a43e" class="i field">_buttons</a><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1];
				<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#3d46113cc199059a" class="i method">RemoveAt</a>(<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1);
 
				<b>if</b> (<span class="r52 r">largestButtonWidth</span> == <span class="r53 r">button</span>.<span class="i property">Frame</span>.<span class="i property">Width</span>)
					<span class="r52 r">largestButtonWidth</span> = <a href="#8305fbe6fa9e03b3" class="i method">GetLargestWidth</a>();
			}
 
			<b>if</b> (<span class="r51 r">needMoreButton</span> &amp;&amp; <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a> - <a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> == 1)
				<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#3d46113cc199059a" class="i method">RemoveAt</a>(<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1);
		}
 
		<span class="t t">UIButton</span> <a id="2797c53380a9a033" href="R/2797c53380a9a033.html" target="n" data-glyph="76,1" class="i method">GetButton</a>(<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="t t">MenuItem</a> <span id="r54 rd" class="r54 r">item</span>)
		{
			<b>var</b> <span id="r55 rd" class="r55 r">button</span> = <b>new</b> <span class="t constructor">UIButton</span>(<b>new</b> <span class="t constructor">RectangleF</span>(0, 0, 1, 1));
 
			<b>if</b> (!<span class="r54 r">item</span>.<a href="/Xamarin.Forms.Core/A.html#8aed7bad1663b80d" class="i property">IsDestructive</a>)
				<span class="r55 r">button</span>.<span class="i method">SetBackgroundImage</span>(<a href="#f2f855f4c6a2d618" class="i field">NormalBackground</a>, <span class="t t">UIControlState</span>.<span class="i field">Normal</span>);
			<b>else</b>
				<span class="r55 r">button</span>.<span class="i method">SetBackgroundImage</span>(<a href="#5df6499ec79ede83" class="i field">DestructiveBackground</a>, <span class="t t">UIControlState</span>.<span class="i field">Normal</span>);
 
			<span class="r55 r">button</span>.<span class="i method">SetTitle</span>(<span class="r54 r">item</span>.<a href="/Xamarin.Forms.Core/A.html#2e0c5c546b8a8b5b" class="i property">Text</a>, <span class="t t">UIControlState</span>.<span class="i field">Normal</span>);
			<span class="r55 r">button</span>.<span class="i property">TitleEdgeInsets</span> = <b>new</b> <span class="t constructor">UIEdgeInsets</span>(0, 15, 0, 15);
 
			<span class="r55 r">button</span>.<span class="i property">Enabled</span> = <span class="r54 r">item</span>.<a href="/Xamarin.Forms.Core/A.html#7a81b789dd2233fb" class="i property">IsEnabled</a>;
 
			<b>return</b> <span class="r55 r">button</span>;
		}
 
		<span class="t t">UIViewController</span> <a id="cfddbafd50bd4f19" href="R/cfddbafd50bd4f19.html" target="n" data-glyph="76,1" class="i method">GetController</a>()
		{
			<a href="/Xamarin.Forms.Core/A.html#76098df8350c0484" class="t t">Element</a> <span id="r56 rd" class="r56 r">e</span> = <a href="#4f244ba8561411bf" class="i field">_cell</a>;
			<b>while</b> (<span class="r56 r">e</span>.<a href="/Xamarin.Forms.Core/A.html#3a1e78d030ef9bf3" class="i property">RealParent</a> != <b>null</b>)
			{
				<a href="IVisualElementRenderer.cs.html#222fbc88c8a624f8" class="k">var</a> <span id="r57 rd" class="r57 r">renderer</span> = <a href="Platform.cs.html#348bf1c3abb233c7" class="t t">Platform</a>.<a href="Platform.cs.html#f9842318ec9d3985" class="i method">GetRenderer</a>((<a href="/Xamarin.Forms.Core/A.html#daf307b67182d7d7" class="t t">VisualElement</a>)<span class="r56 r">e</span>.<a href="/Xamarin.Forms.Core/A.html#3a1e78d030ef9bf3" class="i property">RealParent</a>);
				<b>if</b> (<span class="r57 r">renderer</span>.<a href="IVisualElementRenderer.cs.html#9a433c8430a26d7e" class="i property">ViewController</a> != <b>null</b>)
					<b>return</b> <span class="r57 r">renderer</span>.<a href="IVisualElementRenderer.cs.html#9a433c8430a26d7e" class="i property">ViewController</a>;
 
				<span class="r56 r">e</span> = <span class="r56 r">e</span>.<a href="/Xamarin.Forms.Core/A.html#3a1e78d030ef9bf3" class="i property">RealParent</a>;
			}
 
			<b>return null</b>;
		}
 
		<span class="t t">nfloat</span> <a id="8305fbe6fa9e03b3" href="R/8305fbe6fa9e03b3.html" target="n" data-glyph="76,1" class="i method">GetLargestWidth</a>()
		{
			<span class="t t">nfloat</span> <span id="r58 rd" class="r58 r">largestWidth</span> = 0;
			<b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r59 rd" class="r59 r">i</span> = 0; <span class="r59 r">i</span> &lt; <a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a>; <span class="r59 r">i</span>++)
			{
				<b>var</b> <span id="r60 rd" class="r60 r">frame</span> = <a href="#28aa3b97db70a43e" class="i field">_buttons</a><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r59 r">i</span>].<span class="i property">Frame</span>;
				<b>if</b> (<span class="r60 r">frame</span>.<span class="i property">Width</span> &gt; <span class="r58 r">largestWidth</span>)
					<span class="r58 r">largestWidth</span> = <span class="r60 r">frame</span>.<span class="i property">Width</span>;
			}
 
			<b>return</b> <span class="r58 r">largestWidth</span>;
		}
 
		<b>void</b> <a id="c4f7c17d156327cb" href="R/c4f7c17d156327cb.html" target="n" data-glyph="76,1" class="i method">OnButtonActivated</a>(<b>object</b> <span id="r61 rd" class="r61 r">sender</span>, <a href="@0@mscorlib/A.html#9a1496aa60befd10" class="t t">EventArgs</a> <span id="r62 rd" class="r62 r">e</span>)
		{
			<b>var</b> <span id="r63 rd" class="r63 r">button</span> = (<span class="t t">UIButton</span>)<span class="r61 r">sender</span>;
			<b>if</b> (<span class="r63 r">button</span>.<span class="i property">Tag</span> == -1)
				<a href="#1248d26a47a42807" class="i method">ActivateMore</a>();
			<b>else</b>
			{
				<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i method">SetContentOffset</span>(<b>new</b> <span class="t constructor">PointF</span>(0, 0), <b>true</b>);
				<a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>[(<b>int</b>)<span class="r63 r">button</span>.<span class="i property">Tag</span>].<a href="/Xamarin.Forms.Core/A.html#acfa69a60a16cf67" class="i method">Activate</a>();
			}
		}
 
		<b>void</b> <a id="7501d0d7dfb0f8f8" href="R/7501d0d7dfb0f8f8.html" target="n" data-glyph="76,1" class="i method">OnCellPropertyChanged</a>(<b>object</b> <span id="r64 rd" class="r64 r">sender</span>, <a href="@0@System/A.html#f613cfcc9d2b2a4b" class="t t">PropertyChangedEventArgs</a> <span id="r65 rd" class="r65 r">e</span>)
		{
			<b>if</b> (<span class="r65 r">e</span>.<a href="@0@System/A.html#edc039b147e83726" class="i property">PropertyName</a> == <span class="s">&quot;HasContextActions&quot;</span>)
			{
				<a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="k">var</a> <span id="r66 rd" class="r66 r">parentListView</span> = <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#3a1e78d030ef9bf3" class="i property">RealParent</a> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="t t">ListView</a>;
				<a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r67 rd" class="r67 r">recycling</span> = <span class="r66 r">parentListView</span> != <b>null</b> &amp;&amp; 
					((<span class="r66 r">parentListView</span>.<a href="/Xamarin.Forms.Core/A.html#853e43c3430ca1d5" class="i property">CachingStrategy</a> &amp; <a href="/Xamarin.Forms.Core/A.html#7325a6e87ebf132d" class="t t">ListViewCachingStrategy</a>.<a href="/Xamarin.Forms.Core/A.html#791a8ea6a96061a0" class="i field">RecycleElement</a>) != 0);
				<b>if</b> (!<span class="r67 r">recycling</span>)
					<a href="#1a5a067a9ae11f7f" class="i method">ReloadRow</a>();
			}
		}
 
		<b>void</b> <a id="6d72a0858cd2f488" href="R/6d72a0858cd2f488.html" target="n" data-glyph="76,1" class="i method">OnContextItemsChanged</a>(<b>object</b> <span id="r68 rd" class="r68 r">sender</span>, <a href="@0@System/A.html#f5d7031313cab4ab" class="t t">NotifyCollectionChangedEventArgs</a> <span id="r69 rd" class="r69 r">e</span>)
		{
			<a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="k">var</a> <span id="r70 rd" class="r70 r">parentListView</span> = <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#3a1e78d030ef9bf3" class="i property">RealParent</a> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="t t">ListView</a>;
			<a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r71 rd" class="r71 r">recycling</span> = <span class="r70 r">parentListView</span> != <b>null</b> &amp;&amp; 
				((<span class="r70 r">parentListView</span>.<a href="/Xamarin.Forms.Core/A.html#853e43c3430ca1d5" class="i property">CachingStrategy</a> &amp; <a href="/Xamarin.Forms.Core/A.html#7325a6e87ebf132d" class="t t">ListViewCachingStrategy</a>.<a href="/Xamarin.Forms.Core/A.html#791a8ea6a96061a0" class="i field">RecycleElement</a>) != 0);
			<b>if</b> (<span class="r71 r">recycling</span>)
				<a href="#ca5cd44f123ed8a3" class="i method">Update</a>(<a href="#e6decb22778d48c0" class="i field">_tableView</a>, <a href="#4f244ba8561411bf" class="i field">_cell</a>, <a href="#afa1754f4117b8cf" class="i property">ContentCell</a>);
			<b>else</b>
				<a href="#1a5a067a9ae11f7f" class="i method">ReloadRow</a>();
			<span class="c">// TODO: Perhaps make this nicer if it&#39;s open while adding</span>
		}
 
		<b>void</b> <a id="62f1b7c6632822ce" href="R/62f1b7c6632822ce.html" target="n" data-glyph="76,1" class="i method">OnMenuItemPropertyChanged</a>(<b>object</b> <span id="r72 rd" class="r72 r">sender</span>, <a href="@0@System/A.html#f613cfcc9d2b2a4b" class="t t">PropertyChangedEventArgs</a> <span id="r73 rd" class="r73 r">e</span>)
		{
			<a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="k">var</a> <span id="r74 rd" class="r74 r">parentListView</span> = <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#3a1e78d030ef9bf3" class="i property">RealParent</a> <b>as</b> <a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="t t">ListView</a>;
			<a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r75 rd" class="r75 r">recycling</span> = <span class="r74 r">parentListView</span> != <b>null</b> &amp;&amp; 
				((<span class="r74 r">parentListView</span>.<a href="/Xamarin.Forms.Core/A.html#853e43c3430ca1d5" class="i property">CachingStrategy</a> &amp; <a href="/Xamarin.Forms.Core/A.html#7325a6e87ebf132d" class="t t">ListViewCachingStrategy</a>.<a href="/Xamarin.Forms.Core/A.html#791a8ea6a96061a0" class="i field">RecycleElement</a>) != 0);
			<b>if</b> (<span class="r75 r">recycling</span>)
				<a href="#ca5cd44f123ed8a3" class="i method">Update</a>(<a href="#e6decb22778d48c0" class="i field">_tableView</a>, <a href="#4f244ba8561411bf" class="i field">_cell</a>, <a href="#afa1754f4117b8cf" class="i property">ContentCell</a>);
			<b>else</b>
				<a href="#1a5a067a9ae11f7f" class="i method">ReloadRow</a>();
		}
 
		<b>void</b> <a id="1a5a067a9ae11f7f" href="R/1a5a067a9ae11f7f.html" target="n" data-glyph="76,1" class="i method">ReloadRow</a>()
		{
			<b>if</b> (<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">ContentOffset</span>.<span class="i property">X</span> &gt; 0)
			{
				((<a href="ContextScrollViewDelegate.cs.html#43bd7d4147f39e2c" class="t t">ContextScrollViewDelegate</a>)<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">Delegate</span>).<a href="ContextScrollViewDelegate.cs.html#ee28e6ce9e382a35" class="i property">ClosedCallback</a> = () =&gt;
				{
					<a href="#62aecff641708641" class="i method">ReloadRowCore</a>();
					((<a href="ContextScrollViewDelegate.cs.html#43bd7d4147f39e2c" class="t t">ContextScrollViewDelegate</a>)<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i property">Delegate</span>).<a href="ContextScrollViewDelegate.cs.html#ee28e6ce9e382a35" class="i property">ClosedCallback</a> = <b>null</b>;
				};
 
				<a href="#69ad7f8aec67343b" class="i field">_scroller</a>.<span class="i method">SetContentOffset</span>(<b>new</b> <span class="t constructor">PointF</span>(0, 0), <b>true</b>);
			}
			<b>else</b>
				<a href="#62aecff641708641" class="i method">ReloadRowCore</a>();
		}
 
		<b>void</b> <a id="62aecff641708641" href="R/62aecff641708641.html" target="n" data-glyph="76,1" class="i method">ReloadRowCore</a>()
		{
			<b>if</b> (<a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#3a1e78d030ef9bf3" class="i property">RealParent</a> == <b>null</b>)
				<b>return</b>;
 
			<b>var</b> <span id="r76 rd" class="r76 r">path</span> = <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="Extensions/CellExtensions.cs.html#ef0aca4e6c87bbfd" class="i method">GetIndexPath</a>();
 
			<a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r77 rd" class="r77 r">selected</span> = <span class="r76 r">path</span>.<span class="i method">Equals</span>(<a href="#e6decb22778d48c0" class="i field">_tableView</a>.<span class="i property">IndexPathForSelectedRow</span>);
 
			<a href="#e6decb22778d48c0" class="i field">_tableView</a>.<span class="i method">ReloadRows</span>(<b>new</b>[] { <span class="r76 r">path</span> }, <span class="t t">UITableViewRowAnimation</span>.<span class="i field">None</span>);
 
			<b>if</b> (<span class="r77 r">selected</span>)
			{
				<a href="#e6decb22778d48c0" class="i field">_tableView</a>.<span class="i method">SelectRow</span>(<span class="r76 r">path</span>, <b>false</b>, <span class="t t">UITableViewScrollPosition</span>.<span class="i field">None</span>);
				<a href="#e6decb22778d48c0" class="i field">_tableView</a>.<span class="i property">Source</span>.<span class="i method">RowSelected</span>(<a href="#e6decb22778d48c0" class="i field">_tableView</a>, <span class="r76 r">path</span>);
			}
		}
 
		<span class="t t">UIView</span> <a id="db193b9dcd0c3f44" href="R/db193b9dcd0c3f44.html" target="n" data-glyph="76,1" class="i method">SetupButtons</a>(<span class="t t">nfloat</span> <span id="r78 rd" class="r78 r">width</span>, <span class="t t">nfloat</span> <span id="r79 rd" class="r79 r">height</span>)
		{
			<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="t t">MenuItem</a> <span id="r80 rd" class="r80 r">destructive</span> = <b>null</b>;
			<span class="t t">nfloat</span> <span id="r81 rd" class="r81 r">largestWidth</span> = 0, <span id="r82 rd" class="r82 r">acceptableSize</span> = <span class="r78 r">width</span> * 0.80f;
 
			<b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r83 rd" class="r83 r">i</span> = 0; <span class="r83 r">i</span> &lt; <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a>; <span class="r83 r">i</span>++)
			{
				<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="k">var</a> <span id="r84 rd" class="r84 r">item</span> = <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a><a href="@0@mscorlib/A.html#396bb785d31f5979">[</a><span class="r83 r">i</span>];
 
				<b>if</b> (<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> == 3)
				{
					<b>if</b> (<span class="r80 r">destructive</span> != <b>null</b>)
						<b>break</b>;
					<b>if</b> (!<span class="r84 r">item</span>.<a href="/Xamarin.Forms.Core/A.html#8aed7bad1663b80d" class="i property">IsDestructive</a>)
						<b>continue</b>;
 
					<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#3d46113cc199059a" class="i method">RemoveAt</a>(<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1);
				}
 
				<b>if</b> (<span class="r84 r">item</span>.<a href="/Xamarin.Forms.Core/A.html#8aed7bad1663b80d" class="i property">IsDestructive</a>)
					<span class="r80 r">destructive</span> = <span class="r84 r">item</span>;
 
				<b>var</b> <span id="r85 rd" class="r85 r">button</span> = <a href="#2797c53380a9a033" class="i method">GetButton</a>(<span class="r84 r">item</span>);
				<span class="r85 r">button</span>.<span class="i property">Tag</span> = <span class="r83 r">i</span>;
				<b>var</b> <span id="r86 rd" class="r86 r">buttonWidth</span> = <span class="r85 r">button</span>.<span class="i property">TitleLabel</span>.<span class="i method">SizeThatFits</span>(<b>new</b> <span class="t constructor">SizeF</span>(<span class="r78 r">width</span>, <span class="r79 r">height</span>)).<span class="i property">Width</span> + 30;
				<b>if</b> (<span class="r86 r">buttonWidth</span> &gt; <span class="r81 r">largestWidth</span>)
					<span class="r81 r">largestWidth</span> = <span class="r86 r">buttonWidth</span>;
 
				<b>if</b> (<span class="r80 r">destructive</span> == <span class="r84 r">item</span>)
					<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#49c519bce0cdbd82" class="i method">Insert</a>(0, <span class="r85 r">button</span>);
				<b>else</b>
					<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r85 r">button</span>);
			}
 
			<a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r87 rd" class="r87 r">needMore</span> = <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a> &gt; <a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a>;
 
			<b>if</b> (<a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a> &gt; 2)
				<a href="#1651146b3bef2928" class="i method">CullButtons</a>(<span class="r82 r">acceptableSize</span>, <b>ref</b> <span class="r87 r">needMore</span>, <b>ref</b> <span class="r81 r">largestWidth</span>);
 
			<a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r88 rd" class="r88 r">resize</span> = <b>false</b>;
			<b>if</b> (<span class="r87 r">needMore</span>)
			{
				<b>if</b> (<span class="r81 r">largestWidth</span> * 2 &gt; <span class="r82 r">acceptableSize</span>)
				{
					<span class="r81 r">largestWidth</span> = <span class="r82 r">acceptableSize</span> / 2;
					<span class="r88 r">resize</span> = <b>true</b>;
				}
 
				<b>var</b> <span id="r89 rd" class="r89 r">button</span> = <b>new</b> <span class="t constructor">UIButton</span>(<b>new</b> <span class="t constructor">RectangleF</span>(0, 0, <span class="r81 r">largestWidth</span>, <span class="r79 r">height</span>));
				<span class="r89 r">button</span>.<span class="i method">SetBackgroundImage</span>(<a href="#f2f855f4c6a2d618" class="i field">NormalBackground</a>, <span class="t t">UIControlState</span>.<span class="i field">Normal</span>);
				<span class="r89 r">button</span>.<span class="i property">TitleEdgeInsets</span> = <b>new</b> <span class="t constructor">UIEdgeInsets</span>(0, 15, 0, 15);
				<span class="r89 r">button</span>.<span class="i method">SetTitle</span>(<a href="Resources/StringResources.Designer.cs.html#90263a29ac0e4c3e" class="t t">StringResources</a>.<a href="Resources/StringResources.Designer.cs.html#213bfaf55538d9cc" class="i property">More</a>, <span class="t t">UIControlState</span>.<span class="i field">Normal</span>);
 
				<b>var</b> <span id="r90 rd" class="r90 r">moreWidth</span> = <span class="r89 r">button</span>.<span class="i property">TitleLabel</span>.<span class="i method">SizeThatFits</span>(<b>new</b> <span class="t constructor">SizeF</span>(<span class="r78 r">width</span>, <span class="r79 r">height</span>)).<span class="i property">Width</span> + 30;
				<b>if</b> (<span class="r90 r">moreWidth</span> &gt; <span class="r81 r">largestWidth</span>)
				{
					<span class="r81 r">largestWidth</span> = <span class="r90 r">moreWidth</span>;
					<a href="#1651146b3bef2928" class="i method">CullButtons</a>(<span class="r82 r">acceptableSize</span>, <b>ref</b> <span class="r87 r">needMore</span>, <b>ref</b> <span class="r81 r">largestWidth</span>);
 
					<b>if</b> (<span class="r81 r">largestWidth</span> * 2 &gt; <span class="r82 r">acceptableSize</span>)
					{
						<span class="r81 r">largestWidth</span> = <span class="r82 r">acceptableSize</span> / 2;
						<span class="r88 r">resize</span> = <b>true</b>;
					}
				}
 
				<span class="r89 r">button</span>.<span class="i property">Tag</span> = -1;
				<span class="r89 r">button</span>.<span class="i">TouchUpInside</span> += <a href="#c4f7c17d156327cb" class="i method">OnButtonActivated</a>;
				<b>if</b> (<span class="r88 r">resize</span>)
					<span class="r89 r">button</span>.<span class="i property">TitleLabel</span>.<span class="i property">AdjustsFontSizeToFitWidth</span> = <b>true</b>;
 
				<a href="#e95acd008d3c3e43" class="i field">_moreButton</a> = <span class="r89 r">button</span>;
				<a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r89 r">button</span>);
			}
 
			<a href="@0@System/A.html#670754815f6804ff" class="k">var</a> <span id="r91 rd" class="r91 r">handler</span> = <b>new</b> <span class="t">PropertyChangedEventHandler</span>(<a href="#62f1b7c6632822ce" class="i method">OnMenuItemPropertyChanged</a>);
			<b>var</b> <span id="r92 rd" class="r92 r">totalWidth</span> = <a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> * <span class="r81 r">largestWidth</span>;
			<b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r93 rd" class="r93 r">n</span> = 0; <span class="r93 r">n</span> &lt; <a href="#28aa3b97db70a43e" class="i field">_buttons</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a>; <span class="r93 r">n</span>++)
			{
				<b>var</b> <span id="r94 rd" class="r94 r">b</span> = <a href="#28aa3b97db70a43e" class="i field">_buttons</a><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r93 r">n</span>];
 
				<b>if</b> (<span class="r94 r">b</span>.<span class="i property">Tag</span> &gt;= 0)
				{
					<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="k">var</a> <span id="r95 rd" class="r95 r">item</span> = <a href="#4f244ba8561411bf" class="i field">_cell</a>.<a href="/Xamarin.Forms.Core/A.html#df6ab09b8d06612c" class="i property">ContextActions</a>[(<b>int</b>)<span class="r94 r">b</span>.<span class="i property">Tag</span>];
					<span class="r95 r">item</span>.<a href="/Xamarin.Forms.Core/A.html#72c3e722cf6fa9ba" class="i">PropertyChanged</a> += <span class="r91 r">handler</span>;
				}
 
				<b>var</b> <span id="r96 rd" class="r96 r">offset</span> = (<span class="r93 r">n</span> + 1) * <span class="r81 r">largestWidth</span>;
 
				<b>var</b> <span id="r97 rd" class="r97 r">x</span> = <span class="r78 r">width</span> - <span class="r96 r">offset</span>;
				<b>if</b> (<span class="t t">UIDevice</span>.<span class="i property">CurrentDevice</span>.<span class="i method">CheckSystemVersion</span>(8, 0))
					<span class="r97 r">x</span> += <span class="r92 r">totalWidth</span>;
 
				<span class="r94 r">b</span>.<span class="i property">Frame</span> = <b>new</b> <span class="t constructor">RectangleF</span>(<span class="r97 r">x</span>, 0, <span class="r81 r">largestWidth</span>, <span class="r79 r">height</span>);
				<b>if</b> (<span class="r88 r">resize</span>)
					<span class="r94 r">b</span>.<span class="i property">TitleLabel</span>.<span class="i property">AdjustsFontSizeToFitWidth</span> = <b>true</b>;
 
				<span class="r94 r">b</span>.<span class="i method">SetNeedsLayout</span>();
 
				<b>if</b> (<span class="r94 r">b</span> != <a href="#e95acd008d3c3e43" class="i field">_moreButton</a>)
					<span class="r94 r">b</span>.<span class="i">TouchUpInside</span> += <a href="#c4f7c17d156327cb" class="i method">OnButtonActivated</a>;
			}
 
			<b>return null</b>;
		}
 
		<b>void</b> <a id="ad61a7e321f28360" href="R/ad61a7e321f28360.html" target="n" data-glyph="76,1" class="i method">SetupSelection</a>(<span class="t t">UITableView</span> <span id="r98 rd" class="r98 r">table</span>)
		{
			<b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r99 rd" class="r99 r">i</span> = 0; <span class="r99 r">i</span> &lt; <span class="r98 r">table</span>.<span class="i property">GestureRecognizers</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r99 r">i</span>++)
			{
				<a href="#e2326ce4e79f5903" class="k">var</a> <span id="r100 rd" class="r100 r">r</span> = <span class="r98 r">table</span>.<span class="i property">GestureRecognizers</span>[<span class="r99 r">i</span>] <b>as</b> <a href="#e2326ce4e79f5903" class="t t">SelectGestureRecognizer</a>;
				<b>if</b> (<span class="r100 r">r</span> != <b>null</b>)
					<b>return</b>;
			}
 
			<a href="#e6decb22778d48c0" class="i field">_tableView</a>.<span class="i method">AddGestureRecognizer</span>(<b>new</b> <a href="#ecd6f266253ecf58" class="t constructor">SelectGestureRecognizer</a>());
		}
 
		<b>class</b> <a id="e2326ce4e79f5903" href="R/e2326ce4e79f5903.html" target="n" data-glyph="4,1" class="t t">SelectGestureRecognizer</a> : <span class="t t">UITapGestureRecognizer</span>
		{
			<span class="t t">NSIndexPath</span> <a id="c1ac52fa5270070b" href="R/c1ac52fa5270070b.html" target="n" data-glyph="46,2" class="i field">_lastPath</a>;
 
			<b>public</b> <a id="ecd6f266253ecf58" href="R/ecd6f266253ecf58.html" target="n" data-glyph="72,2" class="i constructor">SelectGestureRecognizer</a>() : <b>base</b>(<a href="#dfcc87a7fbf6fc5a" class="i method">Tapped</a>)
			{
				<span class="i property">ShouldReceiveTouch</span> = (<span id="r101 rd" class="r101 r">recognizer</span>, <span id="r102 rd" class="r102 r">touch</span>) =&gt;
				{
					<b>var</b> <span id="r103 rd" class="r103 r">table</span> = (<span class="t t">UITableView</span>)<span class="i property">View</span>;
					<b>var</b> <span id="r104 rd" class="r104 r">pos</span> = <span class="r102 r">touch</span>.<span class="i method">LocationInView</span>(<span class="r103 r">table</span>);
 
					<a href="#c1ac52fa5270070b" class="i field">_lastPath</a> = <span class="r103 r">table</span>.<span class="i method">IndexPathForRowAtPoint</span>(<span class="r104 r">pos</span>);
					<b>if</b> (<a href="#c1ac52fa5270070b" class="i field">_lastPath</a> == <b>null</b>)
						<b>return false</b>;
 
					<a href="#d2e23e4d18bf855d" class="k">var</a> <span id="r105 rd" class="r105 r">cell</span> = <span class="r103 r">table</span>.<span class="i method">CellAt</span>(<a href="#c1ac52fa5270070b" class="i field">_lastPath</a>) <b>as</b> <a href="#d2e23e4d18bf855d" class="t t">ContextActionsCell</a>;
 
					<b>return</b> <span class="r105 r">cell</span> != <b>null</b>;
				};
			}
 
			<b>static void</b> <a id="dfcc87a7fbf6fc5a" href="R/dfcc87a7fbf6fc5a.html" target="n" data-glyph="76,2" class="i method">Tapped</a>(<span class="t t">UIGestureRecognizer</span> <span id="r106 rd" class="r106 r">recognizer</span>)
			{
				<a href="#e2326ce4e79f5903" class="k">var</a> <span id="r107 rd" class="r107 r">selector</span> = (<a href="#e2326ce4e79f5903" class="t t">SelectGestureRecognizer</a>)<span class="r106 r">recognizer</span>;
 
				<b>if</b> (<span class="r107 r">selector</span>.<a href="#c1ac52fa5270070b" class="i field">_lastPath</a> == <b>null</b>)
					<b>return</b>;
 
				<b>var</b> <span id="r108 rd" class="r108 r">table</span> = (<span class="t t">UITableView</span>)<span class="r106 r">recognizer</span>.<span class="i property">View</span>;
				<b>if</b> (!<span class="r107 r">selector</span>.<a href="#c1ac52fa5270070b" class="i field">_lastPath</a>.<span class="i method">Equals</span>(<span class="r108 r">table</span>.<span class="i property">IndexPathForSelectedRow</span>))
					<span class="r108 r">table</span>.<span class="i method">SelectRow</span>(<span class="r107 r">selector</span>.<a href="#c1ac52fa5270070b" class="i field">_lastPath</a>, <b>false</b>, <span class="t t">UITableViewScrollPosition</span>.<span class="i field">None</span>);
				<span class="r108 r">table</span>.<span class="i property">Source</span>.<span class="i method">RowSelected</span>(<span class="r108 r">table</span>, <span class="r107 r">selector</span>.<a href="#c1ac52fa5270070b" class="i field">_lastPath</a>);
			}
		}
 
		<b>class</b> <a id="a5a53e7b64035846" href="R/a5a53e7b64035846.html" target="n" data-glyph="4,1" class="t t"><span id="7e368a3dbdb76eac">MoreActionSheetController</span></a> : <span class="t t">UIAlertController</span>
		{
			<b>public override</b> <span class="t t">UIAlertControllerStyle</span> <a id="9c15f451d93652af" href="R/9c15f451d93652af.html" target="n" data-glyph="102,2" class="i property">PreferredStyle</a>
			{
				<b>get</b> { <b>return</b> <span class="t t">UIAlertControllerStyle</span>.<span class="i field">ActionSheet</span>; }
			}
 
			<b>public override void</b> <a id="7e34ece6a19c0377" href="R/7e34ece6a19c0377.html" target="n" data-glyph="72,2" class="i method">WillRotate</a>(<span class="t t">UIInterfaceOrientation</span> <span id="r109 rd" class="r109 r">toInterfaceOrientation</span>, <b>double</b> <span id="r110 rd" class="r110 r">duration</span>)
			{
				<span class="i method">DismissViewController</span>(<b>false</b>, <b>null</b>);
			}
		}
 
		<b>class</b> <a id="90b816ab6d07387a" href="R/90b816ab6d07387a.html" target="n" data-glyph="4,1" class="t t"><span id="140cd5216c5494c9">MoreActionSheetDelegate</span></a> : <span class="t t">UIActionSheetDelegate</span>
		{
			<b>public</b> <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="/Xamarin.Forms.Core/A.html#36ded754cef116fb" class="t t">MenuItem</a>&gt; <a id="5479ca6fcc54e821" href="R/5479ca6fcc54e821.html" target="n" data-glyph="42,2" class="i field">Items</a>;
			<b>public</b> <span class="t t">UIScrollView</span> <a id="3edb7748ea53d626" href="R/3edb7748ea53d626.html" target="n" data-glyph="42,2" class="i field">Scroller</a>;
 
			<b>public override void</b> <a id="1873c1a9f6cd58a4" href="R/1873c1a9f6cd58a4.html" target="n" data-glyph="72,2" class="i method">Clicked</a>(<span class="t t">UIActionSheet</span> <span id="r111 rd" class="r111 r">actionSheet</span>, <span class="t t">nint</span> <span id="r112 rd" class="r112 r">buttonIndex</span>)
			{
				<b>if</b> (<span class="r112 r">buttonIndex</span> == <a href="#5479ca6fcc54e821" class="i field">Items</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a>)
					<b>return</b>; <span class="c">// Cancel button</span>
 
				<a href="#3edb7748ea53d626" class="i field">Scroller</a>.<span class="i method">SetContentOffset</span>(<b>new</b> <span class="t constructor">PointF</span>(0, 0), <b>true</b>);
 
				<span class="c">// do not activate a -1 index when dismissing by clicking outside the popover</span>
				<b>if</b> (<span class="r112 r">buttonIndex</span> &gt;= 0)
					<a href="#5479ca6fcc54e821" class="i field">Items</a>[(<b>int</b>)<span class="r112 r">buttonIndex</span>].<a href="/Xamarin.Forms.Core/A.html#acfa69a60a16cf67" class="i method">Activate</a>();
			}
		}
	}
}</pre></td></tr></table></div></body></html>
