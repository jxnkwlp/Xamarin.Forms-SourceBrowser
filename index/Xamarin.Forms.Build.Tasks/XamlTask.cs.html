<!DOCTYPE html>
<html><head><title>XamlTask.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(93);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="Xamarin.Forms.Build.Tasks/XamlTask.cs" target="_top">XamlTask.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xamarin.Forms.Build.Tasks" target="_top">Xamarin.Forms.Build.Tasks\Xamarin.Forms.Build.Tasks.csproj</a> (Xamarin.Forms.Build.Tasks)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Xml</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Build</span>.<span class="i n">Framework</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Build</span>.<span class="i n">Utilities</span>;
 
<b>using</b> <span class="i">Mono</span>.<span class="i">Cecil</span>;
 
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Xaml</span>;
<b>using</b> <span class="i">Mono</span>.<span class="i">Cecil</span>.<span class="i">Cil</span>;
<b>using</b> <span class="i">Mono</span>.<span class="i">Cecil</span>.<span class="i">Pdb</span>;
<b>using</b> <span class="i">Mono</span>.<span class="i">Cecil</span>.<span class="i">Mdb</span>;
 
<b>namespace</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Build</span>.<span class="i n">Tasks</span>
{
	<b>public abstract class</b> <a id="4501796fd3dbcfee" href="R/4501796fd3dbcfee.html" target="n" data-glyph="0,0" class="t t">XamlTask</a> : <a href="@0@Microsoft.Build.Utilities.v4.0/A.html#922d648315ef60a7" class="t t">AppDomainIsolatedTask</a>
	{
		[<a href="@0@Microsoft.Build.Framework/A.html#eb406f8abc461426" class="t constructor">Required</a>]
		<b>public string</b> <a id="1e7c2511a03d0b27" href="R/1e7c2511a03d0b27.html" target="n" data-glyph="102,1" class="i property">Assembly</a> { <b>get</b>; <b>set</b>; }
		<b>public string</b> <a id="ea129edede9724d7" href="R/ea129edede9724d7.html" target="n" data-glyph="102,1" class="i property">DependencyPaths</a> { <b>get</b>; <b>set</b>; }
		<b>public string</b> <a id="2cc6240eb835fb3c" href="R/2cc6240eb835fb3c.html" target="n" data-glyph="102,1" class="i property">ReferencePath</a> { <b>get</b>; <b>set</b>; }
		<b>public int</b> <a id="dbaf0d587ecda2f9" href="R/dbaf0d587ecda2f9.html" target="n" data-glyph="102,1" class="i property">Verbosity</a> { <b>get</b>; <b>set</b>; }
		<b>public bool</b> <a id="05b5cdeafe1503e2" href="R/05b5cdeafe1503e2.html" target="n" data-glyph="102,1" class="i property">DebugSymbols</a> { <b>get</b>; <b>set</b>; }
		<b>public string</b> <a id="5c437ee20b34b2c9" href="R/5c437ee20b34b2c9.html" target="n" data-glyph="102,1" class="i property">DebugType</a> { <b>get</b>; <b>set</b>; }
 
		<b>internal</b> <a id="4f73065d1a24d78a" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i constructor">XamlTask</a>()
		{
		}
 
		<b>protected</b> <a href="Logger.cs.html#49577b3c121e28ae" class="t t">Logger</a> <a id="e25ede20c33748f8" href="R/e25ede20c33748f8.html" target="n" data-glyph="105,1" class="i property">Logger</a> { <b>get</b>; <b>set</b>; }
 
		<b>public override bool</b> <a id="79cdf2b6e7a70cf5" href="R/79cdf2b6e7a70cf5.html" target="n" data-glyph="72,1" class="i method">Execute</a>()
		{
			<a href="#e25ede20c33748f8" class="i property">Logger</a> = <b>new</b> <a href="Logger.cs.html#65fef16e306d168c" class="t constructor">Logger</a>(<a href="@0@Microsoft.Build.Utilities.v4.0/A.html#d32e9872cac5e4a8" class="i property">Log</a>, <a href="#dbaf0d587ecda2f9" class="i property">Verbosity</a>);
			<a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>&gt; <span id="r0 rd" class="r0 r">_</span>;
			<b>return</b> <a href="#277899ac864e513d" class="i method">Execute</a>(<b>out</b> <span class="r0 r">_</span>);
		}
 
		<b>public abstract bool</b> <a id="277899ac864e513d" href="R/277899ac864e513d.html" target="n" data-glyph="72,1" class="i method">Execute</a>(<b>out</b> <a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>&gt; <span id="r1 rd" class="r1 r">thrownExceptions</span>);
 
		<b>internal static</b> <a href="ILRootNode.cs.html#de06ee077600c4f7" class="t t">ILRootNode</a> <a id="8b748734b69e9414" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ParseXaml</a>(<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r2 rd" class="r2 r">stream</span>, <span class="i">TypeReference</span> <span id="r3 rd" class="r3 r">typeReference</span>)
		{
			<a href="ILRootNode.cs.html#de06ee077600c4f7" class="t t">ILRootNode</a> <span id="r4 rd" class="r4 r">rootnode</span> = <b>null</b>;
			<b>using</b> (<a href="@0@System.Xml/A.html#086471e5cca0825f" class="k">var</a> <span id="r5 rd" class="r5 r">reader</span> = <a href="@0@System.Xml/A.html#086471e5cca0825f" class="t t">XmlReader</a>.<a href="@0@System.Xml/A.html#787de8fa146fb641" class="i method">Create</a>(<span class="r2 r">stream</span>)) {
				<b>while</b> (<span class="r5 r">reader</span>.<a href="@0@System.Xml/A.html#090de36eee7e315a" class="i method">Read</a>()) {
					<span class="c">//Skip until element</span>
					<b>if</b> (<span class="r5 r">reader</span>.<a href="@0@System.Xml/A.html#f6a1bba392856338" class="i property">NodeType</a> == <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#04f128943244abce" class="i field">Whitespace</a>)
						<b>continue</b>;
					<b>if</b> (<span class="r5 r">reader</span>.<a href="@0@System.Xml/A.html#f6a1bba392856338" class="i property">NodeType</a> != <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#53e0732704d796d8" class="i field">Element</a>) {
						<a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#f09f4054a9345a5e" class="i method">WriteLine</a>(<span class="s">&quot;Unhandled node {0} {1} {2}&quot;</span>, <span class="r5 r">reader</span>.<a href="@0@System.Xml/A.html#f6a1bba392856338" class="i property">NodeType</a>, <span class="r5 r">reader</span>.<a href="@0@System.Xml/A.html#1be6e617b1934a44" class="i property">Name</a>, <span class="r5 r">reader</span>.<a href="@0@System.Xml/A.html#47b6f30e810dc59e" class="i property">Value</a>);
						<b>continue</b>;
					}
 
					<a href="/Xamarin.Forms.Xaml/A.html#761f9f93317ccb07" class="t t">XamlParser</a>.<a href="/Xamarin.Forms.Xaml/A.html#49674a818223323d" class="i method">ParseXaml</a>(
						<span class="r4 r">rootnode</span> = <b>new</b> <a href="ILRootNode.cs.html#c4bf69044e78b31d" class="t constructor">ILRootNode</a>(<b>new</b> <a href="/Xamarin.Forms.Xaml/A.html#0a1740224b8aaa73" class="t constructor">XmlType</a>(<span class="r5 r">reader</span>.<a href="@0@System.Xml/A.html#adc1c8b218a6af2a" class="i property">NamespaceURI</a>, <span class="r5 r">reader</span>.<a href="@0@System.Xml/A.html#1be6e617b1934a44" class="i property">Name</a>, <b>null</b>), <span class="r3 r">typeReference</span>, <span class="r5 r">reader</span> <b>as</b> <a href="@0@System.Xml/A.html#853789bff6dc9c81" class="t t">IXmlNamespaceResolver</a>), <span class="r5 r">reader</span>);
					<b>break</b>;
				}
			}
			<b>return</b> <span class="r4 r">rootnode</span>;
		}
	}
 
	<b>static class</b> <a id="ef783eb5e455932f" href="R/../../0000000000.html" target="n" data-glyph="2,0" class="t t">CecilExtensions</a>
	{
		<b>public static bool</b> <a id="a572ebbc60d43537" href="R/../../0000000000.html" target="n" data-glyph="220,1" class="i method">IsXaml</a>(<b>this</b> <span class="i">EmbeddedResource</span> <span id="r6 rd" class="r6 r">resource</span>, <b>out string</b> <span id="r7 rd" class="r7 r">classname</span>)
		{
			<span class="r7 r">classname</span> = <b>null</b>;
			<b>if</b> (!<span class="r6 r">resource</span>.<span class="i">Name</span>.<span class="i">EndsWith</span>(<span class="s">&quot;.xaml&quot;</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#eb6ce9ac0dbf4269" class="i field">InvariantCulture</a>))
				<b>return false</b>;
 
			<b>using</b> (<b>var</b> <span id="r8 rd" class="r8 r">resourceStream</span> = <span class="r6 r">resource</span>.<span class="i">GetResourceStream</span>()) {
				<a href="@0@System.Xml/A.html#f82a4c1bd1f0ee12" class="k">var</a> <span id="r9 rd" class="r9 r">xmlDoc</span> = <b>new</b> <a href="@0@System.Xml/A.html#2d559a81f89e826f" class="t constructor">XmlDocument</a>();
				<span class="r9 r">xmlDoc</span>.<span class="i">Load</span>(<span class="r8 r">resourceStream</span>);
 
				<a href="@0@System.Xml/A.html#5fdaa3592f8f8845" class="k">var</a> <span id="r10 rd" class="r10 r">nsmgr</span> = <b>new</b> <a href="@0@System.Xml/A.html#d871ffd6b8b1d783" class="t constructor">XmlNamespaceManager</a>(<span class="r9 r">xmlDoc</span>.<a href="@0@System.Xml/A.html#0d9521b2ab3aad36" class="i property">NameTable</a>);
 
				<a href="@0@System.Xml/A.html#735249b64d244851" class="k">var</a> <span id="r11 rd" class="r11 r">root</span> = <span class="r9 r">xmlDoc</span>.<a href="@0@System.Xml/A.html#4c0c1cfdabd639f2" class="i method">SelectSingleNode</a>(<span class="s">&quot;/*&quot;</span>, <span class="r10 r">nsmgr</span>);
				<b>if</b> (<span class="r11 r">root</span> == <b>null</b>)
					<b>return false</b>;
 
				<a href="@0@System.Xml/A.html#32fc4eecc0eb5ba9" class="k">var</a> <span id="r12 rd" class="r12 r">rootClass</span> = <span class="r11 r">root</span>.<a href="@0@System.Xml/A.html#86643abd2a4fe7a2" class="i property">Attributes</a><a href="@0@System.Xml/A.html#7a894bede2eb6257">[</a><span class="s">&quot;Class&quot;</span>, <a href="/Xamarin.Forms.Xaml/A.html#761f9f93317ccb07" class="t t">XamlParser</a>.<a href="/Xamarin.Forms.Xaml/A.html#3508e4ccca574315" class="i field">X2006Uri</a>] ??
								<span class="r11 r">root</span>.<a href="@0@System.Xml/A.html#86643abd2a4fe7a2" class="i property">Attributes</a><a href="@0@System.Xml/A.html#7a894bede2eb6257">[</a><span class="s">&quot;Class&quot;</span>, <a href="/Xamarin.Forms.Xaml/A.html#761f9f93317ccb07" class="t t">XamlParser</a>.<a href="/Xamarin.Forms.Xaml/A.html#80b6c43c81971ca4" class="i field">X2009Uri</a>];
				<b>if</b> (<span class="r12 r">rootClass</span> == <b>null</b>)
					<b>return false</b>;
				<span class="r7 r">classname</span> = <span class="r12 r">rootClass</span>.<a href="@0@System.Xml/A.html#9bc9e8ad31fdcd66" class="i property">Value</a>;
				<b>return true</b>;
			}
		}
	}
}</pre></td></tr></table></div></body></html>
