<!DOCTYPE html>
<html><head><title>SetPropertiesVisitor.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(1277);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="Xamarin.Forms.Build.Tasks/SetPropertiesVisitor.cs" target="_top">SetPropertiesVisitor.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xamarin.Forms.Build.Tasks" target="_top">Xamarin.Forms.Build.Tasks\Xamarin.Forms.Build.Tasks.csproj</a> (Xamarin.Forms.Build.Tasks)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Xml</span>;
 
<b>using</b> <span class="i">Mono</span>.<span class="i">Cecil</span>;
<b>using</b> <span class="i">Mono</span>.<span class="i">Cecil</span>.<span class="i">Cil</span>;
<b>using</b> <span class="i">Mono</span>.<span class="i">Cecil</span>.<span class="i">Rocks</span>;
 
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Internals</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Xaml</span>;
 
<b>namespace</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Build</span>.<span class="i n">Tasks</span>
{
	<b>class</b> <a id="349e57c61e97e6ff" href="R/349e57c61e97e6ff.html" target="n" data-glyph="2,0" class="t t">SetPropertiesVisitor</a> : <a href="/Xamarin.Forms.Xaml/A.html#b541306a207eb42e" class="t t">IXamlNodeVisitor</a>
	{
		<b>static int</b> <a id="4485b43b1662201e" href="R/4485b43b1662201e.html" target="n" data-glyph="46,1" class="i field">dtcount</a>;
		<b>static int</b> <a id="a5e7c4918f92a9e3" href="R/a5e7c4918f92a9e3.html" target="n" data-glyph="46,1" class="i field">typedBindingCount</a>;
 
		<b>static readonly</b> <a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>&gt; <a id="0747f629ca4d1603" href="R/0747f629ca4d1603.html" target="n" data-glyph="46,1" class="i field">skips</a> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>&gt;
		{
			<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#ce88fd5516a3db5c" class="i field">xKey</a>,
			<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#2d7fbef61f459440" class="i field">xTypeArguments</a>,
			<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#ba25f468d9c4f81b" class="i field">xArguments</a>,
			<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#2c33b8fa36839efb" class="i field">xFactoryMethod</a>,
			<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#4dd36ca233878b27" class="i field">xName</a>,
			<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#02206a874bd4f9a9" class="i field">xDataType</a>
		};
 
		<b>public</b> <a id="4ad47baf30ec7c64" href="R/4ad47baf30ec7c64.html" target="n" data-glyph="72,1" class="i constructor">SetPropertiesVisitor</a>(<a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r0 rd" class="r0 r">context</span>, <b>bool</b> <span id="r1 rd" class="r1 r">stopOnResourceDictionary</span> = <b>false</b>)
		{
			<a href="#106b1c2b9e95a42c" class="i property">Context</a> = <span class="r0 r">context</span>;
			<a href="#58517c160d5a093b" class="i property">Module</a> = <span class="r0 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
			<a href="#8a6efb0df92c54ac" class="i property">StopOnResourceDictionary</a> = <span class="r1 r">stopOnResourceDictionary</span>;
		}
 
		<b>public</b> <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <a id="106b1c2b9e95a42c" href="R/106b1c2b9e95a42c.html" target="n" data-glyph="102,1" class="i property">Context</a> { <b>get</b>; }
		<b>public bool</b> <a id="8a6efb0df92c54ac" href="R/8a6efb0df92c54ac.html" target="n" data-glyph="102,1" class="i property">StopOnResourceDictionary</a> { <b>get</b>; }
		<b>public</b> <a href="/Xamarin.Forms.Xaml/A.html#9d9e9e5a3534fb33" class="t t">TreeVisitingMode</a> <a id="70fd7f9fd1b7cdaa" href="R/70fd7f9fd1b7cdaa.html" target="n" data-glyph="102,1" class="i property">VisitingMode</a> =&gt; <a href="/Xamarin.Forms.Xaml/A.html#9d9e9e5a3534fb33" class="t t">TreeVisitingMode</a>.<a href="/Xamarin.Forms.Xaml/A.html#0b6fe56bad8bf80b" class="i field">BottomUp</a>;
		<b>public bool</b> <a id="47c9f092092665e1" href="R/47c9f092092665e1.html" target="n" data-glyph="102,1" class="i property">StopOnDataTemplate</a> =&gt; <b>true</b>;
		<b>public bool</b> <a id="384a772fb2c6df66" href="R/384a772fb2c6df66.html" target="n" data-glyph="102,1" class="i property">VisitNodeOnDataTemplate</a> =&gt; <b>true</b>;
 
		<span class="i">ModuleDefinition</span> <a id="58517c160d5a093b" href="R/58517c160d5a093b.html" target="n" data-glyph="106,1" class="i property">Module</a> { <b>get</b>; }
 
		<b>public void</b> <a id="26239da60e1405f2" href="R/26239da60e1405f2.html" target="n" data-glyph="72,1" class="i method">Visit</a>(<a href="/Xamarin.Forms.Xaml/A.html#8154936e25abda05" class="t t">ValueNode</a> <span id="r2 rd" class="r2 r">node</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r3 rd" class="r3 r">parentNode</span>)
		{
			<span class="c">//TODO support Label text as element</span>
			<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a> <span id="r4 rd" class="r4 r">propertyName</span>;
			<b>if</b> (!<a href="#42b7a3ae08e68ec5" class="i method">TryGetPropertyName</a>(<span class="r2 r">node</span>, <span class="r3 r">parentNode</span>, <b>out</b> <span class="r4 r">propertyName</span>))
			{
				<b>if</b> (!<a href="#0ca1f42fad266ec5" class="i method">IsCollectionItem</a>(<span class="r2 r">node</span>, <span class="r3 r">parentNode</span>))
					<b>return</b>;
				<b>string</b> <span id="r5 rd" class="r5 r">contentProperty</span>;
				<b>if</b> (!<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a>.<a href="@0@mscorlib/A.html#22fd7cd7408aed6e" class="i method">ContainsKey</a>((<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r3 r">parentNode</span>))
					<b>return</b>;
				<b>var</b> <span id="r6 rd" class="r6 r">parentVar</span> = <a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a>[(<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r3 r">parentNode</span>];
				<b>if</b> ((<span class="r5 r">contentProperty</span> = <span class="i">GetContentProperty</span>(<span class="r6 r">parentVar</span>.<span class="i">VariableType</span>)) != <b>null</b>)
					<span class="r4 r">propertyName</span> = <b>new</b> <a href="/Xamarin.Forms.Xaml/A.html#655d78af446a108a" class="t constructor">XmlName</a>(((<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r3 r">parentNode</span>).<a href="/Xamarin.Forms.Xaml/A.html#3d69442fa39dc0af" class="i property">NamespaceURI</a>, <span class="r5 r">contentProperty</span>);
				<b>else
					return</b>;
			}
 
			<b>if</b> (<a href="#0747f629ca4d1603" class="i field">skips</a>.<a href="@0@mscorlib/A.html#8f74065d140cfe04" class="i method">Contains</a>(<span class="r4 r">propertyName</span>))
				<b>return</b>;
			<b>if</b> (<span class="r3 r">parentNode</span> <b>is</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a> &amp;&amp; ((<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r3 r">parentNode</span>).<a href="/Xamarin.Forms.Xaml/A.html#153777a0650db791" class="i property">SkipProperties</a>.<a href="@0@mscorlib/A.html#521b9f7129105e15" class="i method">Contains</a> (<span class="r4 r">propertyName</span>))
				<b>return</b>;
			<b>if</b> (<span class="r4 r">propertyName</span>.<a href="/Xamarin.Forms.Xaml/A.html#b47e66b52de5400f" class="i method">Equals</a>(<a href="/Xamarin.Forms.Xaml/A.html#761f9f93317ccb07" class="t t">XamlParser</a>.<a href="/Xamarin.Forms.Xaml/A.html#402158a1608ea3cb" class="i field">McUri</a>, <span class="s">&quot;Ignorable&quot;</span>))
				<b>return</b>;
			<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<a href="ILProcessorExtensions.cs.html#acd8ad5b987316bd" class="i method">Append</a>(<a href="#b19e7fca0557c563" class="i method">SetPropertyValue</a>(<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a> [(<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r3 r">parentNode</span>], <span class="r4 r">propertyName</span>, <span class="r2 r">node</span>, <a href="#106b1c2b9e95a42c" class="i property">Context</a>, <span class="r2 r">node</span>));
		}
 
		<b>public void</b> <a id="cd5f7ba03e452b31" href="R/cd5f7ba03e452b31.html" target="n" data-glyph="72,1" class="i method">Visit</a>(<a href="/Xamarin.Forms.Xaml/A.html#429a1b2e0cd22849" class="t t">MarkupNode</a> <span id="r7 rd" class="r7 r">node</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r8 rd" class="r8 r">parentNode</span>)
		{
		}
 
		<b>public void</b> <a id="fe0623d2946ee785" href="R/fe0623d2946ee785.html" target="n" data-glyph="72,1" class="i method">Visit</a>(<a href="/Xamarin.Forms.Xaml/A.html#6162566191bf011a" class="t t">ElementNode</a> <span id="r9 rd" class="r9 r">node</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r10 rd" class="r10 r">parentNode</span>)
		{
			<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a> <span id="r11 rd" class="r11 r">propertyName</span> = <a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#fc384953974e3abe" class="i field">Empty</a>;
 
			<span class="c">//Simplify ListNodes with single elements</span>
			<a href="/Xamarin.Forms.Xaml/A.html#0a483d0bd41cadb6" class="k">var</a> <span id="r12 rd" class="r12 r">pList</span> = <span class="r10 r">parentNode</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0a483d0bd41cadb6" class="t t">ListNode</a>;
			<b>if</b> (<span class="r12 r">pList</span> != <b>null</b> &amp;&amp; <span class="r12 r">pList</span>.<a href="/Xamarin.Forms.Xaml/A.html#15655416e007c334" class="i property">CollectionItems</a>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> == 1) {
				<span class="r11 r">propertyName</span> = <span class="r12 r">pList</span>.<a href="/Xamarin.Forms.Xaml/A.html#a635d7a84b783b78" class="i property">XmlName</a>;
				<span class="r10 r">parentNode</span> = <span class="r10 r">parentNode</span>.<a href="/Xamarin.Forms.Xaml/A.html#aaa082f00606354b" class="i property">Parent</a>;
			}
 
			<b>if</b> ((<span class="r11 r">propertyName</span> != <a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#fc384953974e3abe" class="i field">Empty</a> || <a href="#42b7a3ae08e68ec5" class="i method">TryGetPropertyName</a>(<span class="r9 r">node</span>, <span class="r10 r">parentNode</span>, <b>out</b> <span class="r11 r">propertyName</span>)) &amp;&amp; <a href="#0747f629ca4d1603" class="i field">skips</a>.<a href="@0@mscorlib/A.html#8f74065d140cfe04" class="i method">Contains</a>(<span class="r11 r">propertyName</span>))
				<b>return</b>;
 
			<b>if</b> (<span class="r11 r">propertyName</span> == <a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#f9fb8fcdb5a2a4db" class="i field">_CreateContent</a>) {
				<a href="#f680f7feab3c720f" class="i method">SetDataTemplate</a>((<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>, <span class="r9 r">node</span>, <a href="#106b1c2b9e95a42c" class="i property">Context</a>, <span class="r9 r">node</span>);
				<b>return</b>;
			}
 
			<span class="c">//if this node is an IMarkupExtension, invoke ProvideValue() and replace the variable</span>
			<b>var</b> <span id="r13 rd" class="r13 r">vardef</span> = <a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r9 r">node</span>];
			<a href="#4bed0ed6d02d9248" class="k">var</a> <span id="r14 rd" class="r14 r">vardefref</span> = <b>new</b> <a href="#8ed14af9f95d7d98" class="t constructor">VariableDefinitionReference</a>(<span class="r13 r">vardef</span>);
			<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r15 rd" class="r15 r">localName</span> = <span class="r11 r">propertyName</span>.<a href="/Xamarin.Forms.Xaml/A.html#cc8572c325a516bb" class="i property">LocalName</a>;
			<span class="i">TypeReference</span> <span id="r16 rd" class="r16 r">declaringTypeReference</span> = <b>null</b>;
			<span class="i">FieldReference</span> <span id="r17 rd" class="r17 r">bpRef</span> = <b>null</b>;
			<a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r18 rd" class="r18 r">_</span> = <b>false</b>;
			<span class="i">PropertyDefinition</span> <span id="r19 rd" class="r19 r">propertyRef</span> = <b>null</b>;
			<b>if</b> (<span class="r10 r">parentNode</span> <b>is</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a> &amp;&amp; <span class="r11 r">propertyName</span> != <a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#fc384953974e3abe" class="i field">Empty</a>) {
				<span class="r17 r">bpRef</span> = <a href="#3a534f65076051c0" class="i method">GetBindablePropertyReference</a>(<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a> [(<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>], <span class="r11 r">propertyName</span>.<a href="/Xamarin.Forms.Xaml/A.html#93aca3a09ec7299d" class="i property">NamespaceURI</a>, <b>ref</b> <span class="r15 r">localName</span>, <b>out</b> <span class="r18 r">_</span>, <a href="#106b1c2b9e95a42c" class="i property">Context</a>, <span class="r9 r">node</span>);
				<span class="r19 r">propertyRef</span> = <a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a> [(<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>].<span class="i">VariableType</span>.<span class="i">GetProperty</span>(<span id="r20 rd" class="r20 r">pd</span> =&gt; <span class="r20 r">pd</span>.<span class="i">Name</span> == <span class="r15 r">localName</span>, <b>out</b> <span class="r16 r">declaringTypeReference</span>);
			}
			<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<a href="ILProcessorExtensions.cs.html#acd8ad5b987316bd" class="i method">Append</a>(<span class="i">ProvideValue</span>(<span class="r14 r">vardefref</span>, <a href="#106b1c2b9e95a42c" class="i property">Context</a>, <a href="#58517c160d5a093b" class="i property">Module</a>, <span class="r9 r">node</span>, <span class="i">bpRef</span>:<span class="r17 r">bpRef</span>, <span class="i">propertyRef</span>:<span class="r19 r">propertyRef</span>, <span class="i">propertyDeclaringTypeRef</span>: <span class="r16 r">declaringTypeReference</span>));
			<b>if</b> (<span class="r13 r">vardef</span> != <span class="r14 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>)
			{
				<span class="r13 r">vardef</span> = <span class="r14 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>;
				<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Variables</span>.<span class="i">Add</span>(<span class="r13 r">vardef</span>);
				<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r9 r">node</span>] = <span class="r13 r">vardef</span>;
			}
 
			<b>if</b> (<span class="r11 r">propertyName</span> != <a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#fc384953974e3abe" class="i field">Empty</a>) {
				<b>if</b> (<a href="#0747f629ca4d1603" class="i field">skips</a>.<a href="@0@mscorlib/A.html#8f74065d140cfe04" class="i method">Contains</a>(<span class="r11 r">propertyName</span>))
					<b>return</b>;
				<b>if</b> (<span class="r10 r">parentNode</span> <b>is</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a> &amp;&amp; ((<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>).<a href="/Xamarin.Forms.Xaml/A.html#153777a0650db791" class="i property">SkipProperties</a>.<a href="@0@mscorlib/A.html#521b9f7129105e15" class="i method">Contains</a> (<span class="r11 r">propertyName</span>))
					<b>return</b>;
				
				<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<a href="ILProcessorExtensions.cs.html#acd8ad5b987316bd" class="i method">Append</a>(<a href="#b19e7fca0557c563" class="i method">SetPropertyValue</a>(<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a>[(<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>], <span class="r11 r">propertyName</span>, <span class="r9 r">node</span>, <a href="#106b1c2b9e95a42c" class="i property">Context</a>, <span class="r9 r">node</span>));
			}
			<b>else if</b> (<a href="#0ca1f42fad266ec5" class="i method">IsCollectionItem</a>(<span class="r9 r">node</span>, <span class="r10 r">parentNode</span>) &amp;&amp; <span class="r10 r">parentNode</span> <b>is</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>) {
				<b>var</b> <span id="r21 rd" class="r21 r">parentVar</span> = <a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a>[(<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>];
				<b>string</b> <span id="r22 rd" class="r22 r">contentProperty</span>;
 
				<span class="c">// Implicit Style Resource in a ResourceDictionary</span>
				<b>if</b> (<a href="#f53ce30d9e990cf4" class="i method">IsResourceDictionary</a>((<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>)
					&amp;&amp; <span class="r9 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#8505373ce60c6127" class="i property">XmlType</a>.<a href="/Xamarin.Forms.Xaml/A.html#1561698d7b8a155c" class="i property">Name</a> == <span class="s">&quot;Style&quot;</span>
					&amp;&amp; !<span class="r9 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#5ee5fe5a808d6839" class="i property">Properties</a>.<a href="@0@mscorlib/A.html#22fd7cd7408aed6e" class="i method">ContainsKey</a>(<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#ce88fd5516a3db5c" class="i field">xKey</a>)) {
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r21 r">parentVar</span>);
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r9 r">node</span>]);
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>,
						<a href="#58517c160d5a093b" class="i property">Module</a>.<span class="i">ImportReference</span>(
							<a href="#58517c160d5a093b" class="i property">Module</a>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#d98cc303a5785b29" class="t t">ResourceDictionary</a>))
								.<span class="i">Resolve</span>()
								.<span class="i">Methods</span>.<span class="i">Single</span>(<span id="r23 rd" class="r23 r">md</span> =&gt; <span class="r23 r">md</span>.<span class="i">Name</span> == <span class="s">&quot;Add&quot;</span> &amp;&amp; <span class="r23 r">md</span>.<span class="i">Parameters</span>.<span class="i">Count</span> == 1)));
				}
				<span class="c">// Resource without a x:Key in a ResourceDictionary</span>
				<b>else if</b> (<a href="#f53ce30d9e990cf4" class="i method">IsResourceDictionary</a>((<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>)
						 &amp;&amp; !<span class="r9 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#5ee5fe5a808d6839" class="i property">Properties</a>.<a href="@0@mscorlib/A.html#22fd7cd7408aed6e" class="i method">ContainsKey</a>(<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#ce88fd5516a3db5c" class="i field">xKey</a>)) {
					<b>throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<span class="s">&quot;resources in ResourceDictionary require a x:Key attribute&quot;</span>, <span class="r9 r">node</span>);
				}
				<span class="c">// Resource in a ResourceDictionary</span>
				<b>else if</b> (<a href="#f53ce30d9e990cf4" class="i method">IsResourceDictionary</a>((<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>)
						 &amp;&amp; <span class="r9 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#5ee5fe5a808d6839" class="i property">Properties</a>.<a href="@0@mscorlib/A.html#22fd7cd7408aed6e" class="i method">ContainsKey</a>(<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#ce88fd5516a3db5c" class="i field">xKey</a>)) {
<span class="c">//					IL_0013: ldloc.0</span>
<span class="c">//					IL_0014:  ldstr &quot;key&quot;</span>
<span class="c">//					IL_0019:  ldstr &quot;foo&quot;</span>
<span class="c">//					IL_001e:  callvirt instance void class [Xamarin.Forms.Core]Xamarin.Forms.ResourceDictionary::Add(string, object)</span>
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r21 r">parentVar</span>);
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldstr</span>, (<span class="r9 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#5ee5fe5a808d6839" class="i property">Properties</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#ce88fd5516a3db5c" class="i field">xKey</a>] <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#8154936e25abda05" class="t t">ValueNode</a>).<a href="/Xamarin.Forms.Xaml/A.html#5fa72a93b49782e1" class="i property">Value</a> <b>as string</b>);
					<b>var</b> <span id="r24 rd" class="r24 r">varDef</span> = <a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r9 r">node</span>];
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r24 r">varDef</span>);
					<b>if</b> (<span class="r24 r">varDef</span>.<span class="i">VariableType</span>.<span class="i">IsValueType</span>)
						<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Box</span>, <a href="#58517c160d5a093b" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r24 r">varDef</span>.<span class="i">VariableType</span>));
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>,
						<a href="#58517c160d5a093b" class="i property">Module</a>.<span class="i">ImportReference</span>(
							<a href="#58517c160d5a093b" class="i property">Module</a>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#d98cc303a5785b29" class="t t">ResourceDictionary</a>))
								.<span class="i">Resolve</span>()
								.<span class="i">Methods</span>.<span class="i">Single</span>(<span id="r25 rd" class="r25 r">md</span> =&gt; <span class="r25 r">md</span>.<span class="i">Name</span> == <span class="s">&quot;Add&quot;</span> &amp;&amp; <span class="r25 r">md</span>.<span class="i">Parameters</span>.<span class="i">Count</span> == 2)));
				}
				<span class="c">// Collection element, implicit content, or implicit collection element.</span>
				<b>else if</b> (<span class="r21 r">parentVar</span>.<span class="i">VariableType</span>.<span class="i">ImplementsInterface</span>(<a href="#58517c160d5a093b" class="i property">Module</a>.<span class="i">ImportReference</span>(<b>typeof</b> (<a href="@0@mscorlib/A.html#9be451ac13d86a97" class="t t">IEnumerable</a>))) &amp;&amp; <span class="r21 r">parentVar</span>.<span class="i">VariableType</span>.<span class="i">GetMethods</span>(<span id="r26 rd" class="r26 r">md</span> =&gt; <span class="r26 r">md</span>.<span class="i">Name</span> == <span class="s">&quot;Add&quot;</span> &amp;&amp; <span class="r26 r">md</span>.<span class="i">Parameters</span>.<span class="i">Count</span> == 1, <a href="#58517c160d5a093b" class="i property">Module</a>).<a href="@0@System.Core/A.html#8788153112b7ffd0" class="i method">Any</a>()) {
					<b>var</b> <span id="r27 rd" class="r27 r">elementType</span> = <span class="r21 r">parentVar</span>.<span class="i">VariableType</span>;
					<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="k">var</a> <span id="r28 rd" class="r28 r">adderTuple</span> = <span class="r27 r">elementType</span>.<span class="i">GetMethods</span>(<span id="r29 rd" class="r29 r">md</span> =&gt; <span class="r29 r">md</span>.<span class="i">Name</span> == <span class="s">&quot;Add&quot;</span> &amp;&amp; <span class="r29 r">md</span>.<span class="i">Parameters</span>.<span class="i">Count</span> == 1, <a href="#58517c160d5a093b" class="i property">Module</a>).<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
					<b>var</b> <span id="r30 rd" class="r30 r">adderRef</span> = <a href="#58517c160d5a093b" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r28 r">adderTuple</span>.<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>);
					<span class="r30 r">adderRef</span> = <a href="#58517c160d5a093b" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r30 r">adderRef</span>.<span class="i">ResolveGenericParameters</span>(<span class="r28 r">adderTuple</span>.<a href="@0@mscorlib/A.html#85ddc983cace902c" class="i property">Item2</a>, <a href="#58517c160d5a093b" class="i property">Module</a>));
 
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r21 r">parentVar</span>);
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r13 r">vardef</span>);
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r30 r">adderRef</span>);
					<b>if</b> (<span class="r30 r">adderRef</span>.<span class="i">ReturnType</span>.<span class="i">FullName</span> != <span class="s">&quot;System.Void&quot;</span>)
						<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Pop</span>);
				}
				<b>else if</b> ((<span class="r22 r">contentProperty</span> = <span class="i">GetContentProperty</span>(<span class="r21 r">parentVar</span>.<span class="i">VariableType</span>)) != <b>null</b>) {
					<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="k">var</a> <span id="r31 rd" class="r31 r">name</span> = <b>new</b> <a href="/Xamarin.Forms.Xaml/A.html#655d78af446a108a" class="t constructor">XmlName</a>(<span class="r9 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#ee4bcdea4b617de9" class="i property">NamespaceURI</a>, <span class="r22 r">contentProperty</span>);
					<b>if</b> (<a href="#0747f629ca4d1603" class="i field">skips</a>.<a href="@0@mscorlib/A.html#8f74065d140cfe04" class="i method">Contains</a>(<span class="r31 r">name</span>))
						<b>return</b>;
					<b>if</b> (<span class="r10 r">parentNode</span> <b>is</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a> &amp;&amp; ((<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>).<a href="/Xamarin.Forms.Xaml/A.html#153777a0650db791" class="i property">SkipProperties</a>.<a href="@0@mscorlib/A.html#521b9f7129105e15" class="i method">Contains</a> (<span class="r11 r">propertyName</span>))
						<b>return</b>;
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<a href="ILProcessorExtensions.cs.html#acd8ad5b987316bd" class="i method">Append</a>(<a href="#b19e7fca0557c563" class="i method">SetPropertyValue</a>(<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a>[(<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>], <span class="r31 r">name</span>, <span class="r9 r">node</span>, <a href="#106b1c2b9e95a42c" class="i property">Context</a>, <span class="r9 r">node</span>));
				}
				<b>else
					throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<span class="s">$&quot;</span><span class="s">Can not set the content of </span>{((<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>).<a href="/Xamarin.Forms.Xaml/A.html#5b65f02b1f79eeaf" class="i property">XmlType</a>.<a href="/Xamarin.Forms.Xaml/A.html#1561698d7b8a155c" class="i property">Name</a>}<span class="s"> as it doesn&#39;t have a ContentPropertyAttribute</span><span class="s">&quot;</span>, <span class="r9 r">node</span>);
			}
			<b>else if</b> (<a href="#0ca1f42fad266ec5" class="i method">IsCollectionItem</a>(<span class="r9 r">node</span>, <span class="r10 r">parentNode</span>) &amp;&amp; <span class="r10 r">parentNode</span> <b>is</b> <a href="/Xamarin.Forms.Xaml/A.html#0a483d0bd41cadb6" class="t t">ListNode</a>)
			{
<span class="c">//				IL_000d:  ldloc.2 </span>
<span class="c">//				IL_000e:  callvirt instance class [mscorlib]System.Collections.Generic.IList`1&lt;!0&gt; class [Xamarin.Forms.Core]Xamarin.Forms.Layout`1&lt;class [Xamarin.Forms.Core]Xamarin.Forms.View&gt;::get_Children()</span>
<span class="c">//				IL_0013:  ldloc.0 </span>
<span class="c">//				IL_0014:  callvirt instance void class [mscorlib]System.Collections.Generic.ICollection`1&lt;class [Xamarin.Forms.Core]Xamarin.Forms.View&gt;::Add(!0)</span>
 
				<a href="/Xamarin.Forms.Xaml/A.html#0a483d0bd41cadb6" class="k">var</a> <span id="r32 rd" class="r32 r">parentList</span> = (<a href="/Xamarin.Forms.Xaml/A.html#0a483d0bd41cadb6" class="t t">ListNode</a>)<span class="r10 r">parentNode</span>;
				<b>var</b> <span id="r33 rd" class="r33 r">parent</span> = <a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a>[((<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>.<a href="/Xamarin.Forms.Xaml/A.html#aaa082f00606354b" class="i property">Parent</a>)];
 
				<b>if</b> (<a href="#0747f629ca4d1603" class="i field">skips</a>.<a href="@0@mscorlib/A.html#8f74065d140cfe04" class="i method">Contains</a>(<span class="r32 r">parentList</span>.<a href="/Xamarin.Forms.Xaml/A.html#a635d7a84b783b78" class="i property">XmlName</a>))
					<b>return</b>;
				<b>if</b> (<span class="r10 r">parentNode</span> <b>is</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a> &amp;&amp; ((<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r10 r">parentNode</span>).<a href="/Xamarin.Forms.Xaml/A.html#153777a0650db791" class="i property">SkipProperties</a>.<a href="@0@mscorlib/A.html#521b9f7129105e15" class="i method">Contains</a> (<span class="r11 r">propertyName</span>))
					<b>return</b>;
				<b>var</b> <span id="r34 rd" class="r34 r">elementType</span> = <span class="r33 r">parent</span>.<span class="i">VariableType</span>;
				<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r35 rd" class="r35 r">localname</span> = <span class="r32 r">parentList</span>.<a href="/Xamarin.Forms.Xaml/A.html#a635d7a84b783b78" class="i property">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#cc8572c325a516bb" class="i property">LocalName</a>;
 
				<span class="i">GetNameAndTypeRef</span>(<b>ref</b> <span class="r34 r">elementType</span>, <span class="r32 r">parentList</span>.<a href="/Xamarin.Forms.Xaml/A.html#a635d7a84b783b78" class="i property">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#93aca3a09ec7299d" class="i property">NamespaceURI</a>, <b>ref</b> <span class="r35 r">localname</span>, <a href="#106b1c2b9e95a42c" class="i property">Context</a>, <span class="r9 r">node</span>);
 
				<span class="i">TypeReference</span> <span id="r36 rd" class="r36 r">propertyDeclaringType</span>;
				<b>var</b> <span id="r37 rd" class="r37 r">property</span> = <span class="r34 r">elementType</span>.<span class="i">GetProperty</span>(<span id="r38 rd" class="r38 r">pd</span> =&gt; <span class="r38 r">pd</span>.<span class="i">Name</span> == <span class="r35 r">localname</span>, <b>out</b> <span class="r36 r">propertyDeclaringType</span>);
				<span class="i">MethodDefinition</span> <span id="r39 rd" class="r39 r">propertyGetter</span>;
 
				<b>if</b> (<span class="r37 r">property</span> != <b>null</b> &amp;&amp; (<span class="r39 r">propertyGetter</span> = <span class="r37 r">property</span>.<span class="i">GetMethod</span>) != <b>null</b> &amp;&amp; <span class="r39 r">propertyGetter</span>.<span class="i">IsPublic</span>)
				{
					<b>var</b> <span id="r40 rd" class="r40 r">propertyGetterRef</span> = <a href="#58517c160d5a093b" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r39 r">propertyGetter</span>);
					<span class="r40 r">propertyGetterRef</span> = <a href="#58517c160d5a093b" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r40 r">propertyGetterRef</span>.<span class="i">ResolveGenericParameters</span>(<span class="r36 r">propertyDeclaringType</span>, <a href="#58517c160d5a093b" class="i property">Module</a>));
					<b>var</b> <span id="r41 rd" class="r41 r">propertyType</span> = <span class="r40 r">propertyGetterRef</span>.<span class="i">ReturnType</span>.<span class="i">ResolveGenericParameters</span>(<span class="r36 r">propertyDeclaringType</span>);
 
					<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="k">var</a> <span id="r42 rd" class="r42 r">adderTuple</span> = <span class="r41 r">propertyType</span>.<span class="i">GetMethods</span>(<span id="r43 rd" class="r43 r">md</span> =&gt; <span class="r43 r">md</span>.<span class="i">Name</span> == <span class="s">&quot;Add&quot;</span> &amp;&amp; <span class="r43 r">md</span>.<span class="i">Parameters</span>.<span class="i">Count</span> == 1, <a href="#58517c160d5a093b" class="i property">Module</a>).<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();
					<b>var</b> <span id="r44 rd" class="r44 r">adderRef</span> = <a href="#58517c160d5a093b" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r42 r">adderTuple</span>.<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>);
					<span class="r44 r">adderRef</span> = <a href="#58517c160d5a093b" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r44 r">adderRef</span>.<span class="i">ResolveGenericParameters</span>(<span class="r42 r">adderTuple</span>.<a href="@0@mscorlib/A.html#85ddc983cace902c" class="i property">Item2</a>, <a href="#58517c160d5a093b" class="i property">Module</a>));
 
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r33 r">parent</span>);
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r40 r">propertyGetterRef</span>);
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r13 r">vardef</span>);
					<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r44 r">adderRef</span>);
					<b>if</b> (<span class="r44 r">adderRef</span>.<span class="i">ReturnType</span>.<span class="i">FullName</span> != <span class="s">&quot;System.Void&quot;</span>)
						<a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Pop</span>);
				} <b>else
					throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<b>string</b>.<a href="@0@mscorlib/A.html#9d5604d4425b216f" class="i method">Format</a>(<span class="s">&quot;Property {0} not found&quot;</span>, <span class="r35 r">localname</span>), <span class="r9 r">node</span>);
 
			}
		}
 
		<b>public void</b> <a id="4135ac41792a8fbc" href="R/4135ac41792a8fbc.html" target="n" data-glyph="72,1" class="i method">Visit</a>(<a href="/Xamarin.Forms.Xaml/A.html#539c4bdaedfa22a3" class="t t">RootNode</a> <span id="r45 rd" class="r45 r">node</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r46 rd" class="r46 r">parentNode</span>)
		{
		}
 
		<b>public void</b> <a id="e50d13dce2d7276b" href="R/e50d13dce2d7276b.html" target="n" data-glyph="72,1" class="i method">Visit</a>(<a href="/Xamarin.Forms.Xaml/A.html#0a483d0bd41cadb6" class="t t">ListNode</a> <span id="r47 rd" class="r47 r">node</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r48 rd" class="r48 r">parentNode</span>)
		{
		}
 
		<b>bool</b> <a id="f53ce30d9e990cf4" href="R/f53ce30d9e990cf4.html" target="n" data-glyph="76,1" class="i method">IsResourceDictionary</a>(<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a> <span id="r49 rd" class="r49 r">node</span>)
		{
			<b>var</b> <span id="r50 rd" class="r50 r">parentVar</span> = <a href="#106b1c2b9e95a42c" class="i property">Context</a>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a>[(<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>)<span class="r49 r">node</span>];
			<b>return</b> <span class="r50 r">parentVar</span>.<span class="i">VariableType</span>.<span class="i">FullName</span> == <span class="s">&quot;Xamarin.Forms.ResourceDictionary&quot;</span>
				|| <span class="r50 r">parentVar</span>.<span class="i">VariableType</span>.<span class="i">Resolve</span>().<span class="i">BaseType</span>?.<span class="i">FullName</span> == <span class="s">&quot;Xamarin.Forms.ResourceDictionary&quot;</span>;
		}
 
		<b>public static bool</b> <a id="42b7a3ae08e68ec5" href="R/42b7a3ae08e68ec5.html" target="n" data-glyph="72,1" class="i method">TryGetPropertyName</a>(<a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r51 rd" class="r51 r">node</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r52 rd" class="r52 r">parentNode</span>, <b>out</b> <a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a> <span id="r53 rd" class="r53 r">name</span>)
		{
			<span class="r53 r">name</span> = <b>default</b>(<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>);
			<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="k">var</a> <span id="r54 rd" class="r54 r">parentElement</span> = <span class="r52 r">parentNode</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>;
			<b>if</b> (<span class="r54 r">parentElement</span> == <b>null</b>)
				<b>return false</b>;
			<b>foreach</b> (<a href="@0@mscorlib/A.html#8585965bb176a426" class="k">var</a> <span id="r55 rd" class="r55 r">kvp</span> <b>in</b> <span class="r54 r">parentElement</span>.<a href="/Xamarin.Forms.Xaml/A.html#ca11b3b288ccdec1" class="i property">Properties</a>)
			{
				<b>if</b> (<span class="r55 r">kvp</span>.<a href="@0@mscorlib/A.html#38c0e86cc4b30170" class="i property">Value</a> != <span class="r51 r">node</span>)
					<b>continue</b>;
				<span class="r53 r">name</span> = <span class="r55 r">kvp</span>.<a href="@0@mscorlib/A.html#f9d1c04feb1af032" class="i property">Key</a>;
				<b>return true</b>;
			}
			<b>return false</b>;
		}
 
		<b>static bool</b> <a id="0ca1f42fad266ec5" href="R/0ca1f42fad266ec5.html" target="n" data-glyph="76,1" class="i method">IsCollectionItem</a>(<a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r56 rd" class="r56 r">node</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r57 rd" class="r57 r">parentNode</span>)
		{
			<a href="/Xamarin.Forms.Xaml/A.html#98eae0828150b597" class="k">var</a> <span id="r58 rd" class="r58 r">parentList</span> = <span class="r57 r">parentNode</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#98eae0828150b597" class="t t">IListNode</a>;
			<b>if</b> (<span class="r58 r">parentList</span> == <b>null</b>)
				<b>return false</b>;
			<b>return</b> <span class="r58 r">parentList</span>.<a href="/Xamarin.Forms.Xaml/A.html#fb3a9fc1d07f233b" class="i property">CollectionItems</a>.<a href="@0@mscorlib/A.html#521b9f7129105e15" class="i method">Contains</a>(<span class="r56 r">node</span>);
		}
 
		<b>internal static string</b> <a id="86b8f6ca07cf4600" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetContentProperty</a>(<span class="i">TypeReference</span> <span id="r59 rd" class="r59 r">typeRef</span>)
		{
			<b>var</b> <span id="r60 rd" class="r60 r">typeDef</span> = <span class="r59 r">typeRef</span>.<span class="i">Resolve</span>();
			<b>var</b> <span id="r61 rd" class="r61 r">attributes</span> = <span class="r60 r">typeDef</span>.<span class="i">CustomAttributes</span>;
			<b>var</b> <span id="r62 rd" class="r62 r">attr</span> =
				<span class="r61 r">attributes</span>.<span class="i">FirstOrDefault</span>(<span id="r63 rd" class="r63 r">cad</span> =&gt; <a href="/Xamarin.Forms.Core/A.html#9a0c6af7142c3b71" class="t t">ContentPropertyAttribute</a>.<a href="/Xamarin.Forms.Core/A.html#4cd34accd6ed923f" class="i field">ContentPropertyTypes</a>.<span class="i">Contains</span>(<span class="r63 r">cad</span>.<span class="i">AttributeType</span>.<span class="i">FullName</span>));
			<b>if</b> (<span class="r62 r">attr</span> != <b>null</b>)
				<b>return</b> <span class="r62 r">attr</span>.<span class="i">ConstructorArguments</span>[0].<span class="i">Value</span> <b>as string</b>;
			<b>if</b> (<span class="r60 r">typeDef</span>.<span class="i">BaseType</span> == <b>null</b>)
				<b>return null</b>;
			<b>return</b> <span class="i">GetContentProperty</span>(<span class="r60 r">typeDef</span>.<span class="i">BaseType</span>);
		}
 
		<b>public static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt; <a id="c5cc0add888d9559" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ProvideValue</a>(<a href="#4bed0ed6d02d9248" class="t t">VariableDefinitionReference</a> <span id="r64 rd" class="r64 r">vardefref</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r65 rd" class="r65 r">context</span>,
		                                                    <span class="i">ModuleDefinition</span> <span id="r66 rd" class="r66 r">module</span>, <a href="/Xamarin.Forms.Xaml/A.html#6162566191bf011a" class="t t">ElementNode</a> <span id="r67 rd" class="r67 r">node</span>, <span class="i">FieldReference</span> <span id="r68 rd" class="r68 r">bpRef</span> = <b>null</b>,
		                                                    <span class="i">PropertyReference</span> <span id="r69 rd" class="r69 r">propertyRef</span> = <b>null</b>, <span class="i">TypeReference</span> <span id="r70 rd" class="r70 r">propertyDeclaringTypeRef</span> = <b>null</b>)
		{
			<span class="i">GenericInstanceType</span> <span id="r71 rd" class="r71 r">markupExtension</span>;
			<a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<span class="i">TypeReference</span>&gt; <span id="r72 rd" class="r72 r">genericArguments</span>;
			<b>if</b> (<span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>.<span class="i">VariableType</span>.<span class="i">FullName</span> == <span class="s">&quot;Xamarin.Forms.Xaml.ArrayExtension&quot;</span> &amp;&amp;
			    <span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>.<span class="i">VariableType</span>.<span class="i">ImplementsGenericInterface</span>(<span class="s">&quot;Xamarin.Forms.Xaml.IMarkupExtension`1&quot;</span>,
				    <b>out</b> <span class="r71 r">markupExtension</span>, <b>out</b> <span class="r72 r">genericArguments</span>))
			{
				<b>var</b> <span id="r73 rd" class="r73 r">markExt</span> = <span class="r71 r">markupExtension</span>.<span class="i">Resolve</span>();
				<b>var</b> <span id="r74 rd" class="r74 r">provideValueInfo</span> = <span class="r73 r">markExt</span>.<span class="i">Methods</span>.<span class="i">First</span>(<span id="r75 rd" class="r75 r">md</span> =&gt; <span class="r75 r">md</span>.<span class="i">Name</span> == <span class="s">&quot;ProvideValue&quot;</span>);
				<b>var</b> <span id="r76 rd" class="r76 r">provideValue</span> = <span class="r66 r">module</span>.<span class="i">ImportReference</span>(<span class="r74 r">provideValueInfo</span>);
				<span class="r76 r">provideValue</span> =
					<span class="r66 r">module</span>.<span class="i">ImportReference</span>(<span class="r76 r">provideValue</span>.<span class="i">ResolveGenericParameters</span>(<span class="r71 r">markupExtension</span>, <span class="r66 r">module</span>));
 
				<a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="k">var</a> <span id="r77 rd" class="r77 r">typeNode</span> = <span class="r67 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#5ee5fe5a808d6839" class="i property">Properties</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><b>new</b> <a href="/Xamarin.Forms.Xaml/A.html#655d78af446a108a" class="t constructor">XmlName</a>(<span class="s">&quot;&quot;</span>, <span class="s">&quot;Type&quot;</span>)];
				<span class="i">TypeReference</span> <span id="r78 rd" class="r78 r">arrayTypeRef</span>;
				<b>if</b> (<span class="r65 r">context</span>.<a href="ILContext.cs.html#98cf2db3afd9af2c" class="i property">TypeExtensions</a>.<a href="@0@mscorlib/A.html#2e5bc6d8c0f21e67" class="i method">TryGetValue</a>(<span class="r77 r">typeNode</span>, <b>out</b> <span class="r78 r">arrayTypeRef</span>))
					<span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a> = <b>new</b> <span class="i">VariableDefinition</span>(<span class="r66 r">module</span>.<span class="i">ImportReference</span>(<span class="r78 r">arrayTypeRef</span>.<span class="i">MakeArrayType</span>()));
				<b>else</b>
					<span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a> = <b>new</b> <span class="i">VariableDefinition</span>(<span class="r66 r">module</span>.<span class="i">ImportReference</span>(<span class="r72 r">genericArguments</span>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>()));
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r65 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r67 r">node</span>]);
				<b>foreach</b> (<b>var</b> <span id="r79 rd" class="r79 r">instruction</span> <b>in</b> <span class="r67 r">node</span>.<a href="NodeILExtensions.cs.html#895e7d2b28c5de96" class="i method">PushServiceProvider</a>(<span class="r65 r">context</span>, <span class="r68 r">bpRef</span>, <span class="r69 r">propertyRef</span>, <span class="r70 r">propertyDeclaringTypeRef</span>))
					<b>yield return</b> <span class="r79 r">instruction</span>;
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r76 r">provideValue</span>);
 
				<b>if</b> (<span class="r78 r">arrayTypeRef</span> != <b>null</b>)
					<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Castclass</span>, <span class="r66 r">module</span>.<span class="i">ImportReference</span>(<span class="r78 r">arrayTypeRef</span>.<span class="i">MakeArrayType</span>()));
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Stloc</span>, <span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>);
			}
			<b>else if</b> (<span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>.<span class="i">VariableType</span>.<span class="i">ImplementsGenericInterface</span>(<span class="s">&quot;Xamarin.Forms.Xaml.IMarkupExtension`1&quot;</span>,
				<b>out</b> <span class="r71 r">markupExtension</span>, <b>out</b> <span class="r72 r">genericArguments</span>))
			{
				<a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r80 rd" class="r80 r">acceptEmptyServiceProvider</span> = <span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>.<span class="i">VariableType</span>.<span class="i">GetCustomAttribute</span>(<span class="r66 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#ce2a85ae7c9444c4" class="t t">AcceptEmptyServiceProviderAttribute</a>))) != <b>null</b>;
				<b>if</b> (<span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>.<span class="i">VariableType</span>.<span class="i">FullName</span> == <span class="s">&quot;Xamarin.Forms.Xaml.BindingExtension&quot;</span>)
					<b>foreach</b> (<b>var</b> <span id="r81 rd" class="r81 r">instruction</span> <b>in</b> <a href="#b34142dadc05cb28" class="i method">CompileBindingPath</a>(<span class="r67 r">node</span>, <span class="r65 r">context</span>, <span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>))
						<b>yield return</b> <span class="r81 r">instruction</span>;
 
				<b>var</b> <span id="r82 rd" class="r82 r">markExt</span> = <span class="r71 r">markupExtension</span>.<span class="i">Resolve</span>();
				<b>var</b> <span id="r83 rd" class="r83 r">provideValueInfo</span> = <span class="r82 r">markExt</span>.<span class="i">Methods</span>.<span class="i">First</span>(<span id="r84 rd" class="r84 r">md</span> =&gt; <span class="r84 r">md</span>.<span class="i">Name</span> == <span class="s">&quot;ProvideValue&quot;</span>);
				<b>var</b> <span id="r85 rd" class="r85 r">provideValue</span> = <span class="r66 r">module</span>.<span class="i">ImportReference</span>(<span class="r83 r">provideValueInfo</span>);
				<span class="r85 r">provideValue</span> =
					<span class="r66 r">module</span>.<span class="i">ImportReference</span>(<span class="r85 r">provideValue</span>.<span class="i">ResolveGenericParameters</span>(<span class="r71 r">markupExtension</span>, <span class="r66 r">module</span>));
 
				<span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a> = <b>new</b> <span class="i">VariableDefinition</span>(<span class="r66 r">module</span>.<span class="i">ImportReference</span>(<span class="r72 r">genericArguments</span>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>()));
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r65 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r67 r">node</span>]);
				<b>if</b> (<span class="r80 r">acceptEmptyServiceProvider</span>)
					<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldnull</span>);
				<b>else
					foreach</b> (<b>var</b> <span id="r86 rd" class="r86 r">instruction</span> <b>in</b> <span class="r67 r">node</span>.<a href="NodeILExtensions.cs.html#895e7d2b28c5de96" class="i method">PushServiceProvider</a>(<span class="r65 r">context</span>, <span class="r68 r">bpRef</span>, <span class="r69 r">propertyRef</span>, <span class="r70 r">propertyDeclaringTypeRef</span>))
						<b>yield return</b> <span class="r86 r">instruction</span>;
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r85 r">provideValue</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Stloc</span>, <span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>);
			}
			<b>else if</b> (<span class="r65 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r67 r">node</span>].<span class="i">VariableType</span>.<span class="i">ImplementsInterface</span>(<span class="r66 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b> (<a href="/Xamarin.Forms.Core/A.html#dc3b63a88853ac8b" class="t t">IMarkupExtension</a>))))
			{
				<a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r87 rd" class="r87 r">acceptEmptyServiceProvider</span> = <span class="r65 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r67 r">node</span>].<span class="i">VariableType</span>.<span class="i">GetCustomAttribute</span>(<span class="r66 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#ce2a85ae7c9444c4" class="t t">AcceptEmptyServiceProviderAttribute</a>))) != <b>null</b>;
				<b>var</b> <span id="r88 rd" class="r88 r">markExt</span> = <span class="r66 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b> (<a href="/Xamarin.Forms.Core/A.html#dc3b63a88853ac8b" class="t t">IMarkupExtension</a>)).<span class="i">Resolve</span>();
				<b>var</b> <span id="r89 rd" class="r89 r">provideValueInfo</span> = <span class="r88 r">markExt</span>.<span class="i">Methods</span>.<span class="i">First</span>(<span id="r90 rd" class="r90 r">md</span> =&gt; <span class="r90 r">md</span>.<span class="i">Name</span> == <span class="s">&quot;ProvideValue&quot;</span>);
				<b>var</b> <span id="r91 rd" class="r91 r">provideValue</span> = <span class="r66 r">module</span>.<span class="i">ImportReference</span>(<span class="r89 r">provideValueInfo</span>);
 
				<span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a> = <b>new</b> <span class="i">VariableDefinition</span>(<span class="r66 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">Object</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r65 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r67 r">node</span>]);
				<b>if</b> (<span class="r87 r">acceptEmptyServiceProvider</span>)
					<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldnull</span>);
				<b>else
					foreach</b> (<b>var</b> <span id="r92 rd" class="r92 r">instruction</span> <b>in</b> <span class="r67 r">node</span>.<a href="NodeILExtensions.cs.html#895e7d2b28c5de96" class="i method">PushServiceProvider</a>(<span class="r65 r">context</span>, <span class="r68 r">bpRef</span>, <span class="r69 r">propertyRef</span>, <span class="r70 r">propertyDeclaringTypeRef</span>))
						<b>yield return</b> <span class="r92 r">instruction</span>;
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r91 r">provideValue</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Stloc</span>, <span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>);
			}
			<b>else if</b> (<span class="r65 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r67 r">node</span>].<span class="i">VariableType</span>.<span class="i">ImplementsInterface</span>(<span class="r66 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b> (<a href="/Xamarin.Forms.Core/A.html#e42955e05b2a950d" class="t t">IValueProvider</a>))))
			{
				<a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r93 rd" class="r93 r">acceptEmptyServiceProvider</span> = <span class="r65 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r67 r">node</span>].<span class="i">VariableType</span>.<span class="i">GetCustomAttribute</span>(<span class="r66 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#ce2a85ae7c9444c4" class="t t">AcceptEmptyServiceProviderAttribute</a>))) != <b>null</b>;
				<b>var</b> <span id="r94 rd" class="r94 r">valueProviderType</span> = <span class="r65 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r67 r">node</span>].<span class="i">VariableType</span>;
				<span class="c">//If the IValueProvider has a ProvideCompiledAttribute that can be resolved, shortcut this</span>
				<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r95 rd" class="r95 r">compiledValueProviderName</span> = <span class="r94 r">valueProviderType</span>?.<span class="i">GetCustomAttribute</span>(<span class="r66 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#d578091fd04433f6" class="t t">ProvideCompiledAttribute</a>)))?.<span class="i">ConstructorArguments</span>?[0].<span class="i">Value</span> <b>as string</b>;
				<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a> <span id="r96 rd" class="r96 r">compiledValueProviderType</span>;
				<b>if</b> (<span class="r95 r">compiledValueProviderName</span> != <b>null</b> &amp;&amp; (<span class="r96 r">compiledValueProviderType</span> = <a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a>.<a href="@0@mscorlib/A.html#ba8d29b0ddf9aaa0" class="i method">GetType</a>(<span class="r95 r">compiledValueProviderName</span>)) != <b>null</b>) {
					<a href="@0@mscorlib/A.html#d9262ceecc1719ab" class="k">var</a> <span id="r97 rd" class="r97 r">compiledValueProvider</span> = <a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r96 r">compiledValueProviderType</span>);
					<a href="@0@mscorlib/A.html#382d90b1fa682bac" class="k">var</a> <span id="r98 rd" class="r98 r">cProvideValue</span> = <b>typeof</b>(<a href="CompiledValueProviders/ICompiledValueProvider.cs.html#ca090c5ed5cf3d0f" class="t t">ICompiledValueProvider</a>).<a href="@0@mscorlib/A.html#7c091fc4114614b5" class="i method">GetMethods</a>().<a href="@0@System.Core/A.html#b7e5965cab68b1cf" class="i method">FirstOrDefault</a>(<span id="r99 rd" class="r99 r">md</span> =&gt; <span class="r99 r">md</span>.<a href="@0@mscorlib/A.html#aa4f112f79364b6e" class="i property">Name</a> == <span class="s">&quot;ProvideValue&quot;</span>);
					<a href="@0@mscorlib/A.html#3acf01620172c7f0" class="k">var</a> <span id="r100 rd" class="r100 r">instructions</span> = (<a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt;)<span class="r98 r">cProvideValue</span>.<a href="@0@mscorlib/A.html#c8277ed81262a367" class="i method">Invoke</a>(<span class="r97 r">compiledValueProvider</span>, <b>new</b> <b>object</b>[] {
						<span class="r64 r">vardefref</span>,
						<span class="r65 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>,
						<span class="r67 r">node</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#aee785270197d5f3" class="t t">BaseNode</a>,
						<span class="r65 r">context</span>});
					<b>foreach</b> (<b>var</b> <span id="r101 rd" class="r101 r">i</span> <b>in</b> <span class="r100 r">instructions</span>)
						<b>yield return</b> <span class="r101 r">i</span>;
					<b>yield break</b>;
				}
 
				<b>var</b> <span id="r102 rd" class="r102 r">valueProviderDef</span> = <span class="r66 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b> (<a href="/Xamarin.Forms.Core/A.html#e42955e05b2a950d" class="t t">IValueProvider</a>)).<span class="i">Resolve</span>();
				<b>var</b> <span id="r103 rd" class="r103 r">provideValueInfo</span> = <span class="r102 r">valueProviderDef</span>.<span class="i">Methods</span>.<span class="i">First</span>(<span id="r104 rd" class="r104 r">md</span> =&gt; <span class="r104 r">md</span>.<span class="i">Name</span> == <span class="s">&quot;ProvideValue&quot;</span>);
				<b>var</b> <span id="r105 rd" class="r105 r">provideValue</span> = <span class="r66 r">module</span>.<span class="i">ImportReference</span>(<span class="r103 r">provideValueInfo</span>);
 
				<span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a> = <b>new</b> <span class="i">VariableDefinition</span>(<span class="r66 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">Object</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r65 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r67 r">node</span>]);
				<b>if</b> (<span class="r93 r">acceptEmptyServiceProvider</span>)
					<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldnull</span>);
				<b>else
					foreach</b> (<b>var</b> <span id="r106 rd" class="r106 r">instruction</span> <b>in</b> <span class="r67 r">node</span>.<a href="NodeILExtensions.cs.html#895e7d2b28c5de96" class="i method">PushServiceProvider</a>(<span class="r65 r">context</span>, <span class="r68 r">bpRef</span>, <span class="r69 r">propertyRef</span>, <span class="r70 r">propertyDeclaringTypeRef</span>))
						<b>yield return</b> <span class="r106 r">instruction</span>;
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r105 r">provideValue</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Stloc</span>, <span class="r64 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>);
			}
		}
 
		<span class="c">//Once we get compiled IValueProvider, this will move to the BindingExpression</span>
		<b>static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt; <a id="b34142dadc05cb28" href="R/b34142dadc05cb28.html" target="n" data-glyph="76,1" class="i method">CompileBindingPath</a>(<a href="/Xamarin.Forms.Xaml/A.html#6162566191bf011a" class="t t">ElementNode</a> <span id="r107 rd" class="r107 r">node</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r108 rd" class="r108 r">context</span>, <span class="i">VariableDefinition</span> <span id="r109 rd" class="r109 r">bindingExt</span>)
		{
			<span class="c">//TODO implement handlers[]</span>
			<span class="c">//TODO support casting operators</span>
 
			<a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r110 rd" class="r110 r">pathNode</span>;
			<b>if</b> (!<span class="r107 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#5ee5fe5a808d6839" class="i property">Properties</a>.<a href="@0@mscorlib/A.html#2e5bc6d8c0f21e67" class="i method">TryGetValue</a>(<b>new</b> <a href="/Xamarin.Forms.Xaml/A.html#655d78af446a108a" class="t constructor">XmlName</a>(<span class="s">&quot;&quot;</span>, <span class="s">&quot;Path&quot;</span>), <b>out</b> <span class="r110 r">pathNode</span>) &amp;&amp; <span class="r107 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#339c6ad4140ad10f" class="i property">CollectionItems</a>.<a href="@0@System.Core/A.html#8788153112b7ffd0" class="i method">Any</a>())
				<span class="r110 r">pathNode</span> = <span class="r107 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#339c6ad4140ad10f" class="i property">CollectionItems</a> [0];
			<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r111 rd" class="r111 r">path</span> = (<span class="r110 r">pathNode</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#8154936e25abda05" class="t t">ValueNode</a>)?.<a href="/Xamarin.Forms.Xaml/A.html#5fa72a93b49782e1" class="i property">Value</a> <b>as string</b>;
 
			<a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r112 rd" class="r112 r">dataTypeNode</span> = <b>null</b>;
			<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a> <span id="r113 rd" class="r113 r">n</span> = <span class="r107 r">node</span>;
			<b>while</b> (<span class="r113 r">n</span> != <b>null</b>) {
				<b>if</b> (<span class="r113 r">n</span>.<a href="/Xamarin.Forms.Xaml/A.html#ca11b3b288ccdec1" class="i property">Properties</a>.<a href="@0@mscorlib/A.html#2e5bc6d8c0f21e67" class="i method">TryGetValue</a>(<a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a>.<a href="/Xamarin.Forms.Xaml/A.html#02206a874bd4f9a9" class="i field">xDataType</a>, <b>out</b> <span class="r112 r">dataTypeNode</span>))
					<b>break</b>;
				<span class="r113 r">n</span> = <span class="r113 r">n</span>.<a href="/Xamarin.Forms.Xaml/A.html#aaa082f00606354b" class="i property">Parent</a> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>;
			}
			<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r114 rd" class="r114 r">dataType</span> = (<span class="r112 r">dataTypeNode</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#8154936e25abda05" class="t t">ValueNode</a>)?.<a href="/Xamarin.Forms.Xaml/A.html#5fa72a93b49782e1" class="i property">Value</a> <b>as string</b>;
			<b>if</b> (<span class="r114 r">dataType</span> == <b>null</b>)
				<b>yield break</b>; <span class="c">//throw</span>
 
			<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r115 rd" class="r115 r">namespaceuri</span> = <span class="r114 r">dataType</span>.<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;:&quot;</span>) ? <span class="r107 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#4c29fc7211aeb588" class="i property">NamespaceResolver</a>.<a href="@0@System.Xml/A.html#5a346754cfdb27f6" class="i method">LookupNamespace</a>(<span class="r114 r">dataType</span>.<a href="@0@mscorlib/A.html#1c4a9dc78ba38999" class="i method">Split</a>(<span class="s">&#39;:&#39;</span>) [0].<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>()) : <span class="s">&quot;&quot;</span>;
			<a href="/Xamarin.Forms.Xaml/A.html#944154aac15f45be" class="k">var</a> <span id="r116 rd" class="r116 r">dtXType</span> = <b>new</b> <a href="/Xamarin.Forms.Xaml/A.html#0a1740224b8aaa73" class="t constructor">XmlType</a>(<span class="r115 r">namespaceuri</span>, <span class="r114 r">dataType</span>, <b>null</b>);
 
			<b>var</b> <span id="r117 rd" class="r117 r">tSourceRef</span> = <span class="r116 r">dtXType</span>.<a href="XmlTypeExtensions.cs.html#bd43fe0cd1312d17" class="i method">GetTypeReference</a>(<span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>, (<a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a>)<span class="r107 r">node</span>);
			<b>if</b> (<span class="r117 r">tSourceRef</span> == <b>null</b>)
				<b>yield break</b>; <span class="c">//throw</span>
 
			<a href="@0@mscorlib/A.html#b19f71a84062554b" class="k">var</a> <span id="r118 rd" class="r118 r">properties</span> = <a href="#5c3217b92c6b24e3" class="i method">ParsePath</a>(<span class="r111 r">path</span>, <span class="r117 r">tSourceRef</span>, <span class="r107 r">node</span> <b>as</b> <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a>, <span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>);
			<b>var</b> <span id="r119 rd" class="r119 r">tPropertyRef</span> = <span class="r118 r">properties</span> != <b>null</b> &amp;&amp; <span class="r118 r">properties</span>.<a href="@0@System.Core/A.html#8788153112b7ffd0" class="i method">Any</a>() ? <span class="r118 r">properties</span>.<a href="@0@System.Core/A.html#75722fd194dc2e0e" class="i method">Last</a>().<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>.<span class="i">PropertyType</span> : <span class="r117 r">tSourceRef</span>;
 
			<b>var</b> <span id="r120 rd" class="r120 r">funcRef</span> = <span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;,&gt;)).<span class="i">MakeGenericInstanceType</span>(<b>new</b> [] { <span class="r117 r">tSourceRef</span>, <span class="r119 r">tPropertyRef</span> }));
			<b>var</b> <span id="r121 rd" class="r121 r">actionRef</span> = <span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="@0@mscorlib/A.html#27863de72c2c9b49" class="t t">Action</a>&lt;,&gt;)).<span class="i">MakeGenericInstanceType</span>(<b>new</b> [] { <span class="r117 r">tSourceRef</span>, <span class="r119 r">tPropertyRef</span> }));
			<b>var</b> <span id="r122 rd" class="r122 r">funcObjRef</span> = <span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;,&gt;)).<span class="i">MakeGenericInstanceType</span>(<b>new</b> [] { <span class="r117 r">tSourceRef</span>, <span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">TypeSystem</span>.<span class="i">Object</span> }));
			<b>var</b> <span id="r123 rd" class="r123 r">tupleRef</span> = <span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="t t">Tuple</a>&lt;,&gt;)).<span class="i">MakeGenericInstanceType</span>(<b>new</b> [] { <span class="r122 r">funcObjRef</span>, <span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">TypeSystem</span>.<span class="i">String</span>}));
			<b>var</b> <span id="r124 rd" class="r124 r">typedBindingRef</span> = <span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#4a3aaa460eb5e2ab" class="t t">TypedBinding</a>&lt;,&gt;)).<span class="i">MakeGenericInstanceType</span>(<b>new</b> [] { <span class="r117 r">tSourceRef</span>, <span class="r119 r">tPropertyRef</span>}));
 
			<span class="i">TypeReference</span> <span id="r125 rd" class="r125 r">_</span>;
			<b>var</b> <span id="r126 rd" class="r126 r">ctorInfo</span> =  <span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r124 r">typedBindingRef</span>.<span class="i">Resolve</span>().<span class="i">Methods</span>.<span class="i">FirstOrDefault</span>(<span id="r127 rd" class="r127 r">md</span> =&gt; <span class="r127 r">md</span>.<span class="i">IsConstructor</span> &amp;&amp; !<span class="r127 r">md</span>.<span class="i">IsStatic</span> &amp;&amp; <span class="r127 r">md</span>.<span class="i">Parameters</span>.<span class="i">Count</span> == 3 ));
			<b>var</b> <span id="r128 rd" class="r128 r">ctorinforef</span> = <span class="r126 r">ctorInfo</span>.<span class="i">MakeGeneric</span>(<span class="r124 r">typedBindingRef</span>, <span class="r120 r">funcRef</span>, <span class="r121 r">actionRef</span>, <span class="r123 r">tupleRef</span>);
			<b>var</b> <span id="r129 rd" class="r129 r">setTypedBinding</span> = <span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="/Xamarin.Forms.Xaml/A.html#570055a363ad4460" class="t t">BindingExtension</a>)).<span class="i">GetProperty</span>(<span id="r130 rd" class="r130 r">pd</span> =&gt; <span class="r130 r">pd</span>.<span class="i">Name</span> == <span class="s">&quot;TypedBinding&quot;</span>, <b>out</b> <span class="r125 r">_</span>).<span class="i">SetMethod</span>;
 
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r109 r">bindingExt</span>);
			<b>foreach</b> (<b>var</b> <span id="r131 rd" class="r131 r">instruction</span> <b>in</b> <span class="i">CompiledBindingGetGetter</span>(<span class="r117 r">tSourceRef</span>, <span class="r119 r">tPropertyRef</span>, <span class="r118 r">properties</span>, <span class="r107 r">node</span>, <span class="r108 r">context</span>))
				<b>yield return</b> <span class="r131 r">instruction</span>;
			<b>foreach</b> (<b>var</b> <span id="r132 rd" class="r132 r">instruction</span> <b>in</b> <span class="i">CompiledBindingGetSetter</span>(<span class="r117 r">tSourceRef</span>, <span class="r119 r">tPropertyRef</span>, <span class="r118 r">properties</span>, <span class="r107 r">node</span>, <span class="r108 r">context</span>))
				<b>yield return</b> <span class="r132 r">instruction</span>;
			<b>foreach</b> (<b>var</b> <span id="r133 rd" class="r133 r">instruction</span> <b>in</b> <span class="i">CompiledBindingGetHandlers</span>(<span class="r117 r">tSourceRef</span>, <span class="r119 r">tPropertyRef</span>, <span class="r118 r">properties</span>, <span class="r107 r">node</span>, <span class="r108 r">context</span>))
				<b>yield return</b> <span class="r133 r">instruction</span>;
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Newobj</span>, <span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r128 r">ctorinforef</span>));
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r108 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r129 r">setTypedBinding</span>));
		}
 
		<b>static</b> <a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="t t">Tuple</a>&lt;<span class="i">PropertyDefinition</span>, <b>string</b>&gt;&gt; <a id="5c3217b92c6b24e3" href="R/5c3217b92c6b24e3.html" target="n" data-glyph="76,1" class="i method">ParsePath</a>(<b>string</b> <span id="r134 rd" class="r134 r">path</span>, <span class="i">TypeReference</span> <span id="r135 rd" class="r135 r">tSourceRef</span>, <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a> <span id="r136 rd" class="r136 r">lineInfo</span>, <span class="i">ModuleDefinition</span> <span id="r137 rd" class="r137 r">module</span>)
		{
			<b>if</b> (<b>string</b>.<a href="@0@mscorlib/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r134 r">path</span>))
				<b>return null</b>;
			<span class="r134 r">path</span> = <span class="r134 r">path</span>.<a href="@0@mscorlib/A.html#628f74f98ae9d848" class="i method">Trim</a>(<span class="s">&#39; &#39;</span>, <span class="s">&#39;.&#39;</span>); <span class="c">//trim leading or trailing dots</span>
			<b>var</b> <span id="r138 rd" class="r138 r">parts</span> = <span class="r134 r">path</span>.<a href="@0@mscorlib/A.html#1ff97959e1d46a53" class="i method">Split</a>(<b>new</b> [] { <span class="s">&#39;.&#39;</span> }, <a href="@0@mscorlib/A.html#a948431c3f385783" class="t t">StringSplitOptions</a>.<a href="@0@mscorlib/A.html#249c323b50d44651" class="i field">RemoveEmptyEntries</a>);
			<a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="k">var</a> <span id="r139 rd" class="r139 r">properties</span> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="t t">Tuple</a>&lt;<span class="i">PropertyDefinition</span>, <b>string</b>&gt;&gt;();
 
			<b>var</b> <span id="r140 rd" class="r140 r">previousPartTypeRef</span> = <span class="r135 r">tSourceRef</span>;
			<span class="i">TypeReference</span> <span id="r141 rd" class="r141 r">_</span>;
			<b>foreach</b> (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r142 rd" class="r142 r">part</span> <b>in</b> <span class="r138 r">parts</span>) {
				<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r143 rd" class="r143 r">p</span> = <span class="r142 r">part</span>;
				<b>string</b> <span id="r144 rd" class="r144 r">indexArg</span> = <b>null</b>;
				<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r145 rd" class="r145 r">lbIndex</span> = <span class="r143 r">p</span>.<a href="@0@mscorlib/A.html#eb06d6d166f6a3d9" class="i method">IndexOf</a>(<span class="s">&#39;[&#39;</span>);
				<b>if</b> (<span class="r145 r">lbIndex</span> != -1) {
					<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r146 rd" class="r146 r">rbIndex</span> = <span class="r143 r">p</span>.<a href="@0@mscorlib/A.html#43ea090a2243545e" class="i method">LastIndexOf</a>(<span class="s">&#39;]&#39;</span>);
					<b>if</b> (<span class="r146 r">rbIndex</span> == -1)
						<b>throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<span class="s">&quot;Binding: Indexer did not contain closing bracket&quot;</span>, <span class="r136 r">lineInfo</span>);
					
					<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r147 rd" class="r147 r">argLength</span> = <span class="r146 r">rbIndex</span> - <span class="r145 r">lbIndex</span> - 1;
					<b>if</b> (<span class="r147 r">argLength</span> == 0)
						<b>throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<span class="s">&quot;Binding: Indexer did not contain arguments&quot;</span>, <span class="r136 r">lineInfo</span>);
 
					<span class="r144 r">indexArg</span> = <span class="r143 r">p</span>.<a href="@0@mscorlib/A.html#8124961f027d9ac9" class="i method">Substring</a>(<span class="r145 r">lbIndex</span> + 1, <span class="r147 r">argLength</span>).<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>();
					<b>if</b> (<span class="r144 r">indexArg</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> == 0)
						<b>throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<span class="s">&quot;Binding: Indexer did not contain arguments&quot;</span>, <span class="r136 r">lineInfo</span>);
					
					<span class="r143 r">p</span> = <span class="r143 r">p</span>.<a href="@0@mscorlib/A.html#8124961f027d9ac9" class="i method">Substring</a>(0, <span class="r145 r">lbIndex</span>);
					<span class="r143 r">p</span> = <span class="r143 r">p</span>.<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>();
				}
 
				<b>if</b> (<span class="r143 r">p</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> &gt; 0) {
					<b>var</b> <span id="r148 rd" class="r148 r">property</span> = <span class="r140 r">previousPartTypeRef</span>.<span class="i">GetProperty</span>(<span id="r149 rd" class="r149 r">pd</span> =&gt; <span class="r149 r">pd</span>.<span class="i">Name</span> == <span class="r143 r">p</span> &amp;&amp; <span class="r149 r">pd</span>.<span class="i">GetMethod</span> != <b>null</b> &amp;&amp; <span class="r149 r">pd</span>.<span class="i">GetMethod</span>.<span class="i">IsPublic</span>, <b>out</b> <span class="r141 r">_</span>);
					<span class="r139 r">properties</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<b>new</b> <a href="@0@mscorlib/A.html#ee1efa9bd0176f36" class="t constructor">Tuple</a>&lt;<span class="i">PropertyDefinition</span>, <b>string</b>&gt;(<span class="r148 r">property</span>,<b>null</b>));
					<span class="r140 r">previousPartTypeRef</span> = <span class="r148 r">property</span>.<span class="i">PropertyType</span>;
				}
				<b>if</b> (<span class="r144 r">indexArg</span> != <b>null</b>) {
					<b>var</b> <span id="r150 rd" class="r150 r">defaultMemberAttribute</span> = <span class="r140 r">previousPartTypeRef</span>.<span class="i">GetCustomAttribute</span>(<span class="r137 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i n">Reflection</span>.<a href="@0@mscorlib/A.html#d73c83d205a57372" class="t t">DefaultMemberAttribute</a>)));
					<b>var</b> <span id="r151 rd" class="r151 r">indexerName</span> = <span class="r150 r">defaultMemberAttribute</span>?.<span class="i">ConstructorArguments</span>?.<span class="i">FirstOrDefault</span>().<span class="i">Value</span> <b>as string</b> ?? <span class="s">&quot;Item&quot;</span>;
					<b>var</b> <span id="r152 rd" class="r152 r">indexer</span> = <span class="r140 r">previousPartTypeRef</span>.<span class="i">GetProperty</span>(<span id="r153 rd" class="r153 r">pd</span> =&gt; <span class="r153 r">pd</span>.<span class="i">Name</span> == <span class="r151 r">indexerName</span> &amp;&amp; <span class="r153 r">pd</span>.<span class="i">GetMethod</span> != <b>null</b> &amp;&amp; <span class="r153 r">pd</span>.<span class="i">GetMethod</span>.<span class="i">IsPublic</span>, <b>out</b> <span class="r141 r">_</span>);
					<span class="r139 r">properties</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<b>new</b> <a href="@0@mscorlib/A.html#ee1efa9bd0176f36" class="t constructor">Tuple</a>&lt;<span class="i">PropertyDefinition</span>, <b>string</b>&gt;(<span class="r152 r">indexer</span>, <span class="r144 r">indexArg</span>));
					<b>if</b> (<span class="r152 r">indexer</span>.<span class="i">PropertyType</span> != <span class="r137 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">String</span> &amp;&amp; <span class="r152 r">indexer</span>.<span class="i">PropertyType</span> != <span class="r137 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">Int32</span>)
						<b>throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<span class="s">$&quot;</span><span class="s">Binding: Unsupported indexer index type: </span>{<span class="r152 r">indexer</span>.<span class="i">PropertyType</span>.<span class="i">FullName</span>}<span class="s">&quot;</span>, <span class="r136 r">lineInfo</span>);
					<span class="r140 r">previousPartTypeRef</span> = <span class="r152 r">indexer</span>.<span class="i">PropertyType</span>;
				}
			}
			<b>return</b> <span class="r139 r">properties</span>;
		}
 
		<b>static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt; <a id="c8e9a1eabbae2260" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CompiledBindingGetGetter</a>(<span class="i">TypeReference</span> <span id="r154 rd" class="r154 r">tSourceRef</span>, <span class="i">TypeReference</span> <span id="r155 rd" class="r155 r">tPropertyRef</span>, <a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="t t">Tuple</a>&lt;<span class="i">PropertyDefinition</span>, <b>string</b>&gt;&gt; <span id="r156 rd" class="r156 r">properties</span>, <a href="/Xamarin.Forms.Xaml/A.html#6162566191bf011a" class="t t">ElementNode</a> <span id="r157 rd" class="r157 r">node</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r158 rd" class="r158 r">context</span>)
		{
<span class="c">//			.method private static hidebysig default string &#39;&lt;Main&gt;m__0&#39; (class ViewModel vm)  cil managed</span>
<span class="c">//			{</span>
<span class="c">//				.custom instance void class [mscorlib]System.Runtime.CompilerServices.CompilerGeneratedAttribute::&#39;.ctor&#39;() =  (01 00 00 00 ) // ...</span>
<span class="c">//</span>
<span class="c">//				IL_0000:  ldarg.0 </span>
<span class="c">//				IL_0001:  callvirt instance class ViewModel class ViewModel::get_Model()</span>
<span class="c">//				IL_0006:  callvirt instance string class ViewModel::get_Text()</span>
<span class="c">//				IL_0006:  ret</span>
<span class="c">//			}</span>
 
			<b>var</b> <span id="r159 rd" class="r159 r">module</span> = <span class="r158 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>;
			<b>var</b> <span id="r160 rd" class="r160 r">compilerGeneratedCtor</span> = <span class="r159 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">CompilerServices</span>.<a href="@0@mscorlib/A.html#f3e664c37c84df1f" class="t t">CompilerGeneratedAttribute</a>)).<span class="i">GetMethods</span>(<span id="r161 rd" class="r161 r">md</span> =&gt; <span class="r161 r">md</span>.<span class="i">IsConstructor</span>, <span class="r159 r">module</span>).<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>().<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>;
			<b>var</b> <span id="r162 rd" class="r162 r">getter</span> = <b>new</b> <span class="i">MethodDefinition</span>(<span class="s">$&quot;</span><span class="s">&lt;</span>{<span class="r158 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Name</span>}<span class="s">&gt;typedBindingsM__</span>{<a href="#a5e7c4918f92a9e3" class="i field">typedBindingCount</a>++}<span class="s">&quot;</span>,
											  <span class="i">MethodAttributes</span>.<span class="i">Private</span> | <span class="i">MethodAttributes</span>.<span class="i">HideBySig</span> | <span class="i">MethodAttributes</span>.<span class="i">Static</span>,
											  <span class="r155 r">tPropertyRef</span>) {
				<span class="i">Parameters</span> = {
					<b>new</b> <span class="i">ParameterDefinition</span>(<span class="r154 r">tSourceRef</span>)
				},
				<span class="i">CustomAttributes</span> = {
					<b>new</b> <span class="i">CustomAttribute</span> (<span class="r158 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r160 r">compilerGeneratedCtor</span>))
				}
			};
			<span class="r162 r">getter</span>.<span class="i">Body</span>.<span class="i">InitLocals</span> = <b>true</b>;
			<b>var</b> <span id="r163 rd" class="r163 r">il</span> = <span class="r162 r">getter</span>.<span class="i">Body</span>.<span class="i">GetILProcessor</span>();
 
			<span class="r163 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
			<b>if</b> (<span class="r156 r">properties</span> != <b>null</b> &amp;&amp; <span class="r156 r">properties</span>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a> != 0) {
				<b>foreach</b> (<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="k">var</a> <span id="r164 rd" class="r164 r">propTuple</span> <b>in</b> <span class="r156 r">properties</span>) {
					<b>var</b> <span id="r165 rd" class="r165 r">property</span> = <span class="r164 r">propTuple</span>.<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>;
					<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r166 rd" class="r166 r">indexerArg</span> = <span class="r164 r">propTuple</span>.<a href="@0@mscorlib/A.html#85ddc983cace902c" class="i property">Item2</a>;
					<b>if</b> (<span class="r166 r">indexerArg</span> != <b>null</b>) {
						<b>if</b> (<span class="r165 r">property</span>.<span class="i">GetMethod</span>.<span class="i">Parameters</span> [0].<span class="i">ParameterType</span> == <span class="r159 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">String</span>)
							<span class="r163 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldstr</span>, <span class="r166 r">indexerArg</span>);
						<b>else if</b> (<span class="r165 r">property</span>.<span class="i">GetMethod</span>.<span class="i">Parameters</span> [0].<span class="i">ParameterType</span> == <span class="r159 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">Int32</span>) {
							<b>int</b> <span id="r167 rd" class="r167 r">index</span>;
							<b>if</b> (!<b>int</b>.<a href="@0@mscorlib/A.html#325507e509229dbc" class="i method">TryParse</a>(<span class="r166 r">indexerArg</span>, <b>out</b> <span class="r167 r">index</span>))
								<b>throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<span class="s">$&quot;</span><span class="s">Binding: </span>{<span class="r166 r">indexerArg</span>}<span class="s"> could not be parsed as an index for a </span>{<span class="r165 r">property</span>.<span class="i">Name</span>}<span class="s">&quot;</span>, <span class="r157 r">node</span> <b>as</b> <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a>);
							<span class="r163 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldc_I4</span>, <span class="r167 r">index</span>);
						}
					}
					<span class="r163 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r159 r">module</span>.<span class="i">ImportReference</span>(<span class="r165 r">property</span>.<span class="i">GetMethod</span>));
				}
			}
 
			<span class="r163 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ret</span>);
 
			<span class="r158 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">DeclaringType</span>.<span class="i">Methods</span>.<span class="i">Add</span>(<span class="r162 r">getter</span>);
 
			<b>var</b> <span id="r168 rd" class="r168 r">funcRef</span> = <span class="r159 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;,&gt;));
			<span class="r168 r">funcRef</span> = <span class="r159 r">module</span>.<span class="i">ImportReference</span>(<span class="r168 r">funcRef</span>.<span class="i">MakeGenericInstanceType</span>(<b>new</b> [] { <span class="r154 r">tSourceRef</span>, <span class="r155 r">tPropertyRef</span> }));
			<b>var</b> <span id="r169 rd" class="r169 r">funcCtor</span> = <span class="r159 r">module</span>.<span class="i">ImportReference</span>(<span class="r168 r">funcRef</span>.<span class="i">Resolve</span>().<span class="i">GetConstructors</span>().<span class="i">First</span>());
			<span class="r169 r">funcCtor</span> = <span class="r169 r">funcCtor</span>.<span class="i">MakeGeneric</span>(<span class="r168 r">funcRef</span>, <b>new</b> [] { <span class="r154 r">tSourceRef</span>, <span class="r155 r">tPropertyRef</span> });
 
<span class="c">//			IL_0007:  ldnull</span>
<span class="c">//			IL_0008:  ldftn string class Test::&#39;&lt;Main&gt;m__0&#39;(class ViewModel)</span>
<span class="c">//			IL_000e:  newobj instance void class [mscorlib]System.Func`2&lt;class ViewModel, string&gt;::&#39;.ctor&#39;(object, native int)</span>
 
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldnull</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldftn</span>, <span class="r162 r">getter</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Newobj</span>, <span class="r159 r">module</span>.<span class="i">ImportReference</span>(<span class="r169 r">funcCtor</span>));
		}
 
		<b>static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt; <a id="a21e25b6cfef88ab" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CompiledBindingGetSetter</a>(<span class="i">TypeReference</span> <span id="r170 rd" class="r170 r">tSourceRef</span>, <span class="i">TypeReference</span> <span id="r171 rd" class="r171 r">tPropertyRef</span>, <a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="t t">Tuple</a>&lt;<span class="i">PropertyDefinition</span>, <b>string</b>&gt;&gt; <span id="r172 rd" class="r172 r">properties</span>, <a href="/Xamarin.Forms.Xaml/A.html#6162566191bf011a" class="t t">ElementNode</a> <span id="r173 rd" class="r173 r">node</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r174 rd" class="r174 r">context</span>)
		{
			<b>if</b> (<span class="r172 r">properties</span> == <b>null</b> || <span class="r172 r">properties</span>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a> == 0) {
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldnull</span>);
				<b>yield break</b>;
			}
 
			<span class="c">//			.method private static hidebysig default void &#39;&lt;Main&gt;m__1&#39; (class ViewModel vm, string s)  cil managed</span>
			<span class="c">//			{</span>
			<span class="c">//				.custom instance void class [mscorlib]System.Runtime.CompilerServices.CompilerGeneratedAttribute::&#39;.ctor&#39;() =  (01 00 00 00 ) // ....</span>
			<span class="c">//</span>
			<span class="c">//				IL_0000:  ldarg.0 </span>
			<span class="c">//				IL_0001:  callvirt instance class ViewModel class ViewModel::get_Model()</span>
			<span class="c">//				IL_0006:  ldarg.1 </span>
			<span class="c">//				IL_0007:  callvirt instance void class ViewModel::set_Text(string)</span>
			<span class="c">//				IL_000c:  ret</span>
			<span class="c">//			}</span>
 
			<b>var</b> <span id="r175 rd" class="r175 r">module</span> = <span class="r174 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>;
			<b>var</b> <span id="r176 rd" class="r176 r">compilerGeneratedCtor</span> = <span class="r175 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">CompilerServices</span>.<a href="@0@mscorlib/A.html#f3e664c37c84df1f" class="t t">CompilerGeneratedAttribute</a>)).<span class="i">GetMethods</span>(<span id="r177 rd" class="r177 r">md</span> =&gt; <span class="r177 r">md</span>.<span class="i">IsConstructor</span>, <span class="r175 r">module</span>).<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>().<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>;
			<b>var</b> <span id="r178 rd" class="r178 r">setter</span> = <b>new</b> <span class="i">MethodDefinition</span>(<span class="s">$&quot;</span><span class="s">&lt;</span>{<span class="r174 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Name</span>}<span class="s">&gt;typedBindingsM__</span>{<a href="#a5e7c4918f92a9e3" class="i field">typedBindingCount</a>++}<span class="s">&quot;</span>,
											  <span class="i">MethodAttributes</span>.<span class="i">Private</span> | <span class="i">MethodAttributes</span>.<span class="i">HideBySig</span> | <span class="i">MethodAttributes</span>.<span class="i">Static</span>,
			                                  <span class="r175 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">Void</span>) {
				<span class="i">Parameters</span> = {
					<b>new</b> <span class="i">ParameterDefinition</span>(<span class="r170 r">tSourceRef</span>),
					<b>new</b> <span class="i">ParameterDefinition</span>(<span class="r171 r">tPropertyRef</span>)
				},
				<span class="i">CustomAttributes</span> = {
					<b>new</b> <span class="i">CustomAttribute</span> (<span class="r175 r">module</span>.<span class="i">ImportReference</span>(<span class="r176 r">compilerGeneratedCtor</span>))
				}
			};
			<span class="r178 r">setter</span>.<span class="i">Body</span>.<span class="i">InitLocals</span> = <b>true</b>;
 
			<b>var</b> <span id="r179 rd" class="r179 r">il</span> = <span class="r178 r">setter</span>.<span class="i">Body</span>.<span class="i">GetILProcessor</span>();
			<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="k">var</a> <span id="r180 rd" class="r180 r">lastProperty</span> = <span class="r172 r">properties</span>.<a href="@0@System.Core/A.html#981cccb3b4b716eb" class="i method">LastOrDefault</a>();
			<b>var</b> <span id="r181 rd" class="r181 r">setterRef</span> = <span class="r180 r">lastProperty</span>?.<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>.<span class="i">SetMethod</span>;
			<b>if</b> (<span class="r181 r">setterRef</span> == <b>null</b>) {
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldnull</span>); <span class="c">//throw or not ?</span>
				<b>yield break</b>;
			}
 
			<span class="r179 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
			<b>for</b> (<b>int</b> <span id="r182 rd" class="r182 r">i</span> = 0; <span class="r182 r">i</span> &lt; <span class="r172 r">properties</span>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a> - 1; <span class="r182 r">i</span>++) {
				<b>var</b> <span id="r183 rd" class="r183 r">property</span> = <span class="r172 r">properties</span><a href="@0@mscorlib/A.html#396bb785d31f5979">[</a><span class="r182 r">i</span>].<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>;
				<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r184 rd" class="r184 r">indexerArg</span> = <span class="r172 r">properties</span><a href="@0@mscorlib/A.html#396bb785d31f5979">[</a><span class="r182 r">i</span>].<a href="@0@mscorlib/A.html#85ddc983cace902c" class="i property">Item2</a>;
				<b>if</b> (<span class="r184 r">indexerArg</span> != <b>null</b>) {
					<b>if</b> (<span class="r183 r">property</span>.<span class="i">GetMethod</span>.<span class="i">Parameters</span> [0].<span class="i">ParameterType</span> == <span class="r175 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">String</span>)
						<span class="r179 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldstr</span>, <span class="r184 r">indexerArg</span>);
					<b>else if</b> (<span class="r183 r">property</span>.<span class="i">GetMethod</span>.<span class="i">Parameters</span> [0].<span class="i">ParameterType</span> == <span class="r175 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">Int32</span>) {
						<b>int</b> <span id="r185 rd" class="r185 r">index</span>;
						<b>if</b> (!<b>int</b>.<a href="@0@mscorlib/A.html#325507e509229dbc" class="i method">TryParse</a>(<span class="r184 r">indexerArg</span>, <b>out</b> <span class="r185 r">index</span>))
							<b>throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<span class="s">$&quot;</span><span class="s">Binding: </span>{<span class="r184 r">indexerArg</span>}<span class="s"> could not be parsed as an index for a </span>{<span class="r183 r">property</span>.<span class="i">Name</span>}<span class="s">&quot;</span>, <span class="r173 r">node</span> <b>as</b> <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a>);
						<span class="r179 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldc_I4</span>, <span class="r185 r">index</span>);
					}
				}
				<span class="r179 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r175 r">module</span>.<span class="i">ImportReference</span>(<span class="r183 r">property</span>.<span class="i">GetMethod</span>));
			}
 
			<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r186 rd" class="r186 r">indexer</span> = <span class="r172 r">properties</span>.<a href="@0@System.Core/A.html#75722fd194dc2e0e" class="i method">Last</a>().<a href="@0@mscorlib/A.html#85ddc983cace902c" class="i property">Item2</a>;
			<b>if</b> (<span class="r186 r">indexer</span> != <b>null</b>) {
				<b>if</b> (<span class="r180 r">lastProperty</span>.<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>.<span class="i">GetMethod</span>.<span class="i">Parameters</span> [0].<span class="i">ParameterType</span> == <span class="r175 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">String</span>)
					<span class="r179 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldstr</span>, <span class="r186 r">indexer</span>);
				<b>else if</b> (<span class="r180 r">lastProperty</span>.<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>.<span class="i">GetMethod</span>.<span class="i">Parameters</span> [0].<span class="i">ParameterType</span> == <span class="r175 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">Int32</span>) {
					<b>int</b> <span id="r187 rd" class="r187 r">index</span>;
					<b>if</b> (!<b>int</b>.<a href="@0@mscorlib/A.html#325507e509229dbc" class="i method">TryParse</a>(<span class="r186 r">indexer</span>, <b>out</b> <span class="r187 r">index</span>))
						<b>throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<span class="s">$&quot;</span><span class="s">Binding: </span>{<span class="r186 r">indexer</span>}<span class="s"> could not be parsed as an index for a </span>{<span class="r180 r">lastProperty</span>.<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>.<span class="i">Name</span>}<span class="s">&quot;</span>, <span class="r173 r">node</span> <b>as</b> <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a>);
					<span class="r179 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldc_I4</span>, <span class="r187 r">index</span>);
				}
			}
			<span class="r179 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_1</span>);
			<span class="r179 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r175 r">module</span>.<span class="i">ImportReference</span>(<span class="r181 r">setterRef</span>));
			<span class="r179 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ret</span>);
 
			<span class="r174 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">DeclaringType</span>.<span class="i">Methods</span>.<span class="i">Add</span>(<span class="r178 r">setter</span>);
 
			<b>var</b> <span id="r188 rd" class="r188 r">actionRef</span> = <span class="r175 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="@0@mscorlib/A.html#27863de72c2c9b49" class="t t">Action</a>&lt;,&gt;));
			<span class="r188 r">actionRef</span> = <span class="r175 r">module</span>.<span class="i">ImportReference</span>(<span class="r188 r">actionRef</span>.<span class="i">MakeGenericInstanceType</span>(<b>new</b> [] { <span class="r170 r">tSourceRef</span>, <span class="r171 r">tPropertyRef</span> }));
			<b>var</b> <span id="r189 rd" class="r189 r">actionCtor</span> = <span class="r175 r">module</span>.<span class="i">ImportReference</span>(<span class="r188 r">actionRef</span>.<span class="i">Resolve</span>().<span class="i">GetConstructors</span>().<span class="i">First</span>());
			<span class="r189 r">actionCtor</span> = <span class="r189 r">actionCtor</span>.<span class="i">MakeGeneric</span>(<span class="r188 r">actionRef</span>, <b>new</b> [] { <span class="r170 r">tSourceRef</span>, <span class="r171 r">tPropertyRef</span> });
 
<span class="c">//			IL_0024: ldnull</span>
<span class="c">//			IL_0025: ldftn void class Test::&#39;&lt;Main&gt;m__1&#39;(class ViewModel, string)</span>
<span class="c">//			IL_002b: newobj instance void class [mscorlib]System.Action`2&lt;class ViewModel, string&gt;::&#39;.ctor&#39;(object, native int)</span>
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldnull</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldftn</span>, <span class="r178 r">setter</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Newobj</span>, <span class="r175 r">module</span>.<span class="i">ImportReference</span>(<span class="r189 r">actionCtor</span>));
		}
 
		<b>static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt; <a id="4e6b01efb1123015" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CompiledBindingGetHandlers</a>(<span class="i">TypeReference</span> <span id="r190 rd" class="r190 r">tSourceRef</span>, <span class="i">TypeReference</span> <span id="r191 rd" class="r191 r">tPropertyRef</span>, <a href="@0@mscorlib/A.html#b19f71a84062554b" class="t t">IList</a>&lt;<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="t t">Tuple</a>&lt;<span class="i">PropertyDefinition</span>, <b>string</b>&gt;&gt; <span id="r192 rd" class="r192 r">properties</span>, <a href="/Xamarin.Forms.Xaml/A.html#6162566191bf011a" class="t t">ElementNode</a> <span id="r193 rd" class="r193 r">node</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r194 rd" class="r194 r">context</span>)
		{
<span class="c">//			.method private static hidebysig default object &#39;&lt;Main&gt;m__2&#39;(class ViewModel vm)  cil managed {</span>
<span class="c">//				.custom instance void class [mscorlib] System.Runtime.CompilerServices.CompilerGeneratedAttribute::&#39;.ctor&#39;() =  (01 00 00 00 ) // ....</span>
<span class="c">//				IL_0000:  ldarg.0 </span>
<span class="c">//				IL_0001:  ret</span>
<span class="c">//			} // end of method Test::&lt;Main&gt;m__2</span>
 
<span class="c">//			.method private static hidebysig default object &#39;&lt;Main&gt;m__3&#39; (class ViewModel vm)  cil managed {</span>
<span class="c">//				.custom instance void class [mscorlib] System.Runtime.CompilerServices.CompilerGeneratedAttribute::&#39;.ctor&#39;() =  (01 00 00 00 ) // ....</span>
<span class="c">//				IL_0000:  ldarg.0 </span>
<span class="c">//				IL_0001:  callvirt instance class ViewModel class ViewModel::get_Model()</span>
<span class="c">//				IL_0006:  ret</span>
<span class="c">//			}</span>
 
			<b>var</b> <span id="r195 rd" class="r195 r">module</span> = <span class="r194 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>;
			<b>var</b> <span id="r196 rd" class="r196 r">compilerGeneratedCtor</span> = <span class="r195 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">CompilerServices</span>.<a href="@0@mscorlib/A.html#f3e664c37c84df1f" class="t t">CompilerGeneratedAttribute</a>)).<span class="i">GetMethods</span>(<span id="r197 rd" class="r197 r">md</span> =&gt; <span class="r197 r">md</span>.<span class="i">IsConstructor</span>, <span class="r195 r">module</span>).<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>().<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>;
 
			<a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="k">var</a> <span id="r198 rd" class="r198 r">partGetters</span> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<span class="i">MethodDefinition</span>&gt;();
			<b>if</b> (<span class="r192 r">properties</span> == <b>null</b> || <span class="r192 r">properties</span>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a> == 0) {
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldnull</span>);
				<b>yield break</b>;
			}
				
			<b>for</b> (<b>int</b> <span id="r199 rd" class="r199 r">i</span> = 0; <span class="r199 r">i</span> &lt; <span class="r192 r">properties</span>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a>; <span class="r199 r">i</span>++) {
				<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="k">var</a> <span id="r200 rd" class="r200 r">tuple</span> = <span class="r192 r">properties</span> [<span class="r199 r">i</span>];
				<b>var</b> <span id="r201 rd" class="r201 r">partGetter</span> = <b>new</b> <span class="i">MethodDefinition</span>(<span class="s">$&quot;</span><span class="s">&lt;</span>{<span class="r194 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Name</span>}<span class="s">&gt;typedBindingsM__</span>{<a href="#a5e7c4918f92a9e3" class="i field">typedBindingCount</a>++}<span class="s">&quot;</span>, <span class="i">MethodAttributes</span>.<span class="i">Private</span> | <span class="i">MethodAttributes</span>.<span class="i">HideBySig</span> | <span class="i">MethodAttributes</span>.<span class="i">Static</span>, <span class="r191 r">tPropertyRef</span>) {
					<span class="i">Parameters</span> = {
						<b>new</b> <span class="i">ParameterDefinition</span>(<span class="r190 r">tSourceRef</span>)
					},
					<span class="i">CustomAttributes</span> = {
						<b>new</b> <span class="i">CustomAttribute</span> (<span class="r194 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r196 r">compilerGeneratedCtor</span>))
					}
				};
				<span class="r201 r">partGetter</span>.<span class="i">Body</span>.<span class="i">InitLocals</span> = <b>true</b>;
				<b>var</b> <span id="r202 rd" class="r202 r">il</span> = <span class="r201 r">partGetter</span>.<span class="i">Body</span>.<span class="i">GetILProcessor</span>();
				<span class="r202 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
				<b>for</b> (<b>int</b> <span id="r203 rd" class="r203 r">j</span> = 0; <span class="r203 r">j</span> &lt; <span class="r199 r">i</span>; <span class="r203 r">j</span>++) {
					<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="k">var</a> <span id="r204 rd" class="r204 r">propTuple</span> = <span class="r192 r">properties</span> [<span class="r203 r">j</span>];
					<b>var</b> <span id="r205 rd" class="r205 r">property</span> = <span class="r204 r">propTuple</span>.<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>;
					<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r206 rd" class="r206 r">indexerArg</span> = <span class="r204 r">propTuple</span>.<a href="@0@mscorlib/A.html#85ddc983cace902c" class="i property">Item2</a>;
					<b>if</b> (<span class="r206 r">indexerArg</span> != <b>null</b>) {
						<b>if</b> (<span class="r205 r">property</span>.<span class="i">GetMethod</span>.<span class="i">Parameters</span> [0].<span class="i">ParameterType</span> == <span class="r195 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">String</span>)
							<span class="r202 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldstr</span>, <span class="r206 r">indexerArg</span>);
						<b>else if</b> (<span class="r205 r">property</span>.<span class="i">GetMethod</span>.<span class="i">Parameters</span> [0].<span class="i">ParameterType</span> == <span class="r195 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">Int32</span>) {
							<b>int</b> <span id="r207 rd" class="r207 r">index</span>;
							<b>if</b> (!<b>int</b>.<a href="@0@mscorlib/A.html#325507e509229dbc" class="i method">TryParse</a>(<span class="r206 r">indexerArg</span>, <b>out</b> <span class="r207 r">index</span>))
								<b>throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<span class="s">$&quot;</span><span class="s">Binding: </span>{<span class="r206 r">indexerArg</span>}<span class="s"> could not be parsed as an index for a </span>{<span class="r205 r">property</span>.<span class="i">Name</span>}<span class="s">&quot;</span>, <span class="r193 r">node</span> <b>as</b> <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a>);
							<span class="r202 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldc_I4</span>, <span class="r207 r">index</span>);
						}
					}
					<span class="r202 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r195 r">module</span>.<span class="i">ImportReference</span>(<span class="r205 r">property</span>.<span class="i">GetMethod</span>));
				}
				<span class="r202 r">il</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ret</span>);
				<span class="r194 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">DeclaringType</span>.<span class="i">Methods</span>.<span class="i">Add</span>(<span class="r201 r">partGetter</span>);
				<span class="r198 r">partGetters</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r201 r">partGetter</span>);
			}
 
			<b>var</b> <span id="r208 rd" class="r208 r">funcObjRef</span> = <span class="r194 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r195 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;,&gt;)).<span class="i">MakeGenericInstanceType</span>(<b>new</b> [] { <span class="r190 r">tSourceRef</span>, <span class="r195 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">Object</span> }));
			<b>var</b> <span id="r209 rd" class="r209 r">tupleRef</span> = <span class="r194 r">context</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>.<span class="i">ImportReference</span>(<span class="r195 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="t t">Tuple</a>&lt;,&gt;)).<span class="i">MakeGenericInstanceType</span>(<b>new</b> [] { <span class="r208 r">funcObjRef</span>, <span class="r195 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">String</span> }));
			<b>var</b> <span id="r210 rd" class="r210 r">funcCtor</span> = <span class="r195 r">module</span>.<span class="i">ImportReference</span>(<span class="r208 r">funcObjRef</span>.<span class="i">Resolve</span>().<span class="i">GetConstructors</span>().<span class="i">First</span>());
			<span class="r210 r">funcCtor</span> = <span class="r210 r">funcCtor</span>.<span class="i">MakeGeneric</span>(<span class="r208 r">funcObjRef</span>, <b>new</b> [] { <span class="r190 r">tSourceRef</span>, <span class="r195 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">Object</span> });
			<b>var</b> <span id="r211 rd" class="r211 r">tupleCtor</span> = <span class="r195 r">module</span>.<span class="i">ImportReference</span>(<span class="r209 r">tupleRef</span>.<span class="i">Resolve</span>().<span class="i">GetConstructors</span>().<span class="i">First</span>());
			<span class="r211 r">tupleCtor</span> = <span class="r211 r">tupleCtor</span>.<span class="i">MakeGeneric</span>(<span class="r209 r">tupleRef</span>, <b>new</b> [] { <span class="r208 r">funcObjRef</span>, <span class="r195 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">String</span>});
 
<span class="c">//			IL_003a:  ldc.i4.2 </span>
<span class="c">//			IL_003b:  newarr class [mscorlib] System.Tuple`2&lt;class [mscorlib]System.Func`2&lt;class ViewModel,object&gt;,string&gt;</span>
 
<span class="c">//			IL_0040:  dup</span>
<span class="c">//			IL_0041:  ldc.i4.0 </span>
<span class="c">//			IL_0049:  ldnull</span>
<span class="c">//			IL_004a:  ldftn object class Test::&#39;&lt;Main&gt;m__2&#39;(class ViewModel)</span>
<span class="c">//			IL_0050:  newobj instance void class [mscorlib]System.Func`2&lt;class ViewModel, object&gt;::&#39;.ctor&#39;(object, native int)</span>
<span class="c">//			IL_005f:  ldstr &quot;Model&quot;</span>
<span class="c">//			IL_0064:  newobj instance void class [mscorlib]System.Tuple`2&lt;class [mscorlib]System.Func`2&lt;class ViewModel, object&gt;, string&gt;::&#39;.ctor&#39;(!0, !1)</span>
<span class="c">//			IL_0069:  stelem.ref </span>
 
<span class="c">//			IL_006a:  dup</span>
<span class="c">//			IL_006b:  ldc.i4.1 </span>
<span class="c">//			IL_0073:  ldnull</span>
<span class="c">//			IL_0074:  ldftn object class Test::&#39;&lt;Main&gt;m__3&#39;(class ViewModel)</span>
<span class="c">//			IL_007a:  newobj instance void class [mscorlib]System.Func`2&lt;class ViewModel, object&gt;::&#39;.ctor&#39;(object, native int)</span>
<span class="c">//			IL_0089:  ldstr &quot;Text&quot;</span>
<span class="c">//			IL_008e:  newobj instance void class [mscorlib]System.Tuple`2&lt;class [mscorlib]System.Func`2&lt;class ViewModel, object&gt;, string&gt;::&#39;.ctor&#39;(!0, !1)</span>
<span class="c">//			IL_0093:  stelem.ref </span>
 
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldc_I4</span>, <span class="r192 r">properties</span>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Newarr</span>, <span class="r209 r">tupleRef</span>);
 
			<b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r212 rd" class="r212 r">i</span> = 0; <span class="r212 r">i</span> &lt; <span class="r192 r">properties</span>.<a href="@0@mscorlib/A.html#3d6c21c4e9bd5f63" class="i property">Count</a>; <span class="r212 r">i</span>++) {
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Dup</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldc_I4</span>, <span class="r212 r">i</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldnull</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldftn</span>, <span class="r198 r">partGetters</span> [<span class="r212 r">i</span>]);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Newobj</span>, <span class="r195 r">module</span>.<span class="i">ImportReference</span>(<span class="r210 r">funcCtor</span>));
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldstr</span>, <span class="r192 r">properties</span> [<span class="r212 r">i</span>].<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>.<span class="i">Name</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Newobj</span>, <span class="r195 r">module</span>.<span class="i">ImportReference</span>(<span class="r211 r">tupleCtor</span>));
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Stelem_Ref</span>);
			}
		}
 
		<b>public static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt; <a id="b19e7fca0557c563" href="R/b19e7fca0557c563.html" target="n" data-glyph="72,1" class="i method">SetPropertyValue</a>(<span class="i">VariableDefinition</span> <span id="r213 rd" class="r213 r">parent</span>, <a href="/Xamarin.Forms.Xaml/A.html#78eee6e8b684a76e" class="t t">XmlName</a> <span id="r214 rd" class="r214 r">propertyName</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r215 rd" class="r215 r">valueNode</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r216 rd" class="r216 r">context</span>, <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a> <span id="r217 rd" class="r217 r">iXmlLineInfo</span>)
		{
			<b>var</b> <span id="r218 rd" class="r218 r">module</span> = <span class="r216 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
			<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r219 rd" class="r219 r">localName</span> = <span class="r214 r">propertyName</span>.<a href="/Xamarin.Forms.Xaml/A.html#cc8572c325a516bb" class="i property">LocalName</a>;
			<b>bool</b> <span id="r220 rd" class="r220 r">attached</span>;
			<b>var</b> <span id="r221 rd" class="r221 r">bpRef</span> = <a href="#3a534f65076051c0" class="i method">GetBindablePropertyReference</a>(<span class="r213 r">parent</span>, <span class="r214 r">propertyName</span>.<a href="/Xamarin.Forms.Xaml/A.html#93aca3a09ec7299d" class="i property">NamespaceURI</a>, <b>ref</b> <span class="r219 r">localName</span>, <b>out</b> <span class="r220 r">attached</span>, <span class="r216 r">context</span>, <span class="r217 r">iXmlLineInfo</span>);
 
			<span class="c">//If the target is an event, connect</span>
			<b>if</b> (<a href="#d1333f2096f2bd77" class="i method">CanConnectEvent</a>(<span class="r213 r">parent</span>, <span class="r219 r">localName</span>))
				<b>return</b> <a href="#9e45064815b31539" class="i method">ConnectEvent</a>(<span class="r213 r">parent</span>, <span class="r219 r">localName</span>, <span class="r215 r">valueNode</span>, <span class="r217 r">iXmlLineInfo</span>, <span class="r216 r">context</span>);
 
			<span class="c">//If Value is DynamicResource, SetDynamicResource</span>
			<b>if</b> (<a href="#c7d99b8e371f7b46" class="i method">CanSetDynamicResource</a>(<span class="r221 r">bpRef</span>, <span class="r215 r">valueNode</span>, <span class="r216 r">context</span>))
				<b>return</b> <a href="#2a7dba97d5bd01b1" class="i method">SetDynamicResource</a>(<span class="r213 r">parent</span>, <span class="r221 r">bpRef</span>, <span class="r215 r">valueNode</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>, <span class="r217 r">iXmlLineInfo</span>, <span class="r216 r">context</span>);
 
			<span class="c">//If Value is a BindingBase and target is a BP, SetBinding</span>
			<b>if</b> (<a href="#9d57362184311330" class="i method">CanSetBinding</a>(<span class="r221 r">bpRef</span>, <span class="r215 r">valueNode</span>, <span class="r216 r">context</span>))
				<b>return</b> <a href="#0d5ee904e8f796c2" class="i method">SetBinding</a>(<span class="r213 r">parent</span>, <span class="r221 r">bpRef</span>, <span class="r215 r">valueNode</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>, <span class="r217 r">iXmlLineInfo</span>, <span class="r216 r">context</span>);
 
			<span class="c">//If it&#39;s a BP, SetValue ()</span>
			<b>if</b> (<a href="#c2cf3b5eeb9a364d" class="i method">CanSetValue</a>(<span class="r221 r">bpRef</span>, <span class="r220 r">attached</span>, <span class="r215 r">valueNode</span>, <span class="r217 r">iXmlLineInfo</span>, <span class="r216 r">context</span>))
				<b>return</b> <a href="#873ffeb8a4694413" class="i method">SetValue</a>(<span class="r213 r">parent</span>, <span class="r221 r">bpRef</span>, <span class="r215 r">valueNode</span>, <span class="r217 r">iXmlLineInfo</span>, <span class="r216 r">context</span>);
 
			<span class="c">//If it&#39;s a property, set it</span>
			<b>if</b> (<a href="#ac4007486be61820" class="i method">CanSet</a>(<span class="r213 r">parent</span>, <span class="r219 r">localName</span>, <span class="r215 r">valueNode</span>, <span class="r216 r">context</span>))
				<b>return</b> <a href="#973ddee6569cfa7b" class="i method">Set</a>(<span class="r213 r">parent</span>, <span class="r219 r">localName</span>, <span class="r215 r">valueNode</span>, <span class="r217 r">iXmlLineInfo</span>, <span class="r216 r">context</span>);
 
			<span class="c">//If it&#39;s an already initialized property, add to it</span>
			<b>if</b> (<a href="#146497ab02547952" class="i method">CanAdd</a>(<span class="r213 r">parent</span>, <span class="r219 r">localName</span>, <span class="r215 r">valueNode</span>, <span class="r216 r">context</span>))
				<b>return</b> <a href="#7e3c2684d83929a5" class="i method">Add</a>(<span class="r213 r">parent</span>, <span class="r219 r">localName</span>, <span class="r215 r">valueNode</span>, <span class="r217 r">iXmlLineInfo</span>, <span class="r216 r">context</span>);
 
			<b>throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<span class="s">$&quot;</span><span class="s">No property, bindable property, or event found for &#39;</span>{<span class="r219 r">localName</span>}<span class="s">&#39;, or mismatching type between value and property.</span><span class="s">&quot;</span>, <span class="r217 r">iXmlLineInfo</span>);
		}
 
		<b>static</b> <span class="i">FieldReference</span> <a id="3a534f65076051c0" href="R/3a534f65076051c0.html" target="n" data-glyph="76,1" class="i method">GetBindablePropertyReference</a>(<span class="i">VariableDefinition</span> <span id="r222 rd" class="r222 r">parent</span>, <b>string</b> <span id="r223 rd" class="r223 r">namespaceURI</span>, <b>ref string</b> <span id="r224 rd" class="r224 r">localName</span>, <b>out bool</b> <span id="r225 rd" class="r225 r">attached</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r226 rd" class="r226 r">context</span>, <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a> <span id="r227 rd" class="r227 r">iXmlLineInfo</span>)
		{
			<b>var</b> <span id="r228 rd" class="r228 r">module</span> = <span class="r226 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
			<span class="i">TypeReference</span> <span id="r229 rd" class="r229 r">declaringTypeReference</span>;
 
			<span class="c">//If it&#39;s an attached BP, update elementType and propertyName</span>
			<b>var</b> <span id="r230 rd" class="r230 r">bpOwnerType</span> = <span class="r222 r">parent</span>.<span class="i">VariableType</span>;
			<span class="r225 r">attached</span> = <span class="i">GetNameAndTypeRef</span>(<b>ref</b> <span class="r230 r">bpOwnerType</span>, <span class="r223 r">namespaceURI</span>, <b>ref</b> <span class="r224 r">localName</span>, <span class="r226 r">context</span>, <span class="r227 r">iXmlLineInfo</span>);
			<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r231 rd" class="r231 r">name</span> = <span class="s">$&quot;</span>{<span class="r224 r">localName</span>}<span class="s">Property</span><span class="s">&quot;</span>;
			<span class="i">FieldReference</span> <span id="r232 rd" class="r232 r">bpRef</span> = <span class="r230 r">bpOwnerType</span>.<span class="i">GetField</span>(<span id="r233 rd" class="r233 r">fd</span> =&gt; <span class="r233 r">fd</span>.<span class="i">Name</span> == <span class="r231 r">name</span> &amp;&amp;
														<span class="r233 r">fd</span>.<span class="i">IsStatic</span> &amp;&amp;
														<span class="r233 r">fd</span>.<span class="i">IsPublic</span>, <b>out</b> <span class="r229 r">declaringTypeReference</span>);
			<b>if</b> (<span class="r232 r">bpRef</span> != <b>null</b>) {
				<span class="r232 r">bpRef</span> = <span class="r228 r">module</span>.<span class="i">ImportReference</span>(<span class="r232 r">bpRef</span>.<a href="FieldReferenceExtensions.cs.html#0fc6dac808991c5c" class="i method">ResolveGenericParameters</a>(<span class="r229 r">declaringTypeReference</span>));
				<span class="r232 r">bpRef</span>.<span class="i">FieldType</span> = <span class="r228 r">module</span>.<span class="i">ImportReference</span>(<span class="r232 r">bpRef</span>.<span class="i">FieldType</span>);
			}
			<b>return</b> <span class="r232 r">bpRef</span>;
		}
 
		<b>static bool</b> <a id="d1333f2096f2bd77" href="R/d1333f2096f2bd77.html" target="n" data-glyph="76,1" class="i method">CanConnectEvent</a>(<span class="i">VariableDefinition</span> <span id="r234 rd" class="r234 r">parent</span>, <b>string</b> <span id="r235 rd" class="r235 r">localName</span>)
		{
			<span class="i">TypeReference</span> <span id="r236 rd" class="r236 r">_</span>;
			<b>return</b> <span class="r234 r">parent</span>.<span class="i">VariableType</span>.<span class="i">GetEvent</span>(<span id="r237 rd" class="r237 r">ed</span> =&gt; <span class="r237 r">ed</span>.<span class="i">Name</span> == <span class="r235 r">localName</span>, <b>out</b> <span class="r236 r">_</span>) != <b>null</b>;
		}
 
		<b>static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt; <a id="9e45064815b31539" href="R/9e45064815b31539.html" target="n" data-glyph="76,1" class="i method">ConnectEvent</a>(<span class="i">VariableDefinition</span> <span id="r238 rd" class="r238 r">parent</span>, <b>string</b> <span id="r239 rd" class="r239 r">localName</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r240 rd" class="r240 r">valueNode</span>, <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a> <span id="r241 rd" class="r241 r">iXmlLineInfo</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r242 rd" class="r242 r">context</span>)
		{
			<b>var</b> <span id="r243 rd" class="r243 r">elementType</span> = <span class="r238 r">parent</span>.<span class="i">VariableType</span>;
			<b>var</b> <span id="r244 rd" class="r244 r">module</span> = <span class="r242 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
			<span class="i">TypeReference</span> <span id="r245 rd" class="r245 r">eventDeclaringTypeRef</span>;
			<b>var</b> <span id="r246 rd" class="r246 r">eventinfo</span> = <span class="r243 r">elementType</span>.<span class="i">GetEvent</span>(<span id="r247 rd" class="r247 r">ed</span> =&gt; <span class="r247 r">ed</span>.<span class="i">Name</span> == <span class="r239 r">localName</span>, <b>out</b> <span class="r245 r">eventDeclaringTypeRef</span>);
 
<span class="c">//			IL_0007:  ldloc.0 </span>
<span class="c">//			IL_0008:  ldarg.0 </span>
<span class="c">//</span>
<span class="c">//			IL_0009:  ldftn instance void class Xamarin.Forms.Xaml.XamlcTests.MyPage::OnButtonClicked(object, class [mscorlib]System.EventArgs)</span>
<span class="c">//OR, if the handler is virtual</span>
<span class="c">//			IL_000x:  ldarg.0 </span>
<span class="c">//			IL_0009:  ldvirtftn instance void class Xamarin.Forms.Xaml.XamlcTests.MyPage::OnButtonClicked(object, class [mscorlib]System.EventArgs)</span>
<span class="c">//</span>
<span class="c">//			IL_000f:  newobj instance void class [mscorlib]System.EventHandler::&#39;.ctor&#39;(object, native int)</span>
<span class="c">//			IL_0014:  callvirt instance void class [Xamarin.Forms.Core]Xamarin.Forms.Button::add_Clicked(class [mscorlib]System.EventHandler)</span>
 
			<a href="@0@mscorlib/A.html#d9262ceecc1719ab" class="k">var</a> <span id="r248 rd" class="r248 r">value</span> = ((<a href="/Xamarin.Forms.Xaml/A.html#8154936e25abda05" class="t t">ValueNode</a>)<span class="r240 r">valueNode</span>).<a href="/Xamarin.Forms.Xaml/A.html#5fa72a93b49782e1" class="i property">Value</a>;
 
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r238 r">parent</span>);
			<b>if</b> (<span class="r242 r">context</span>.<a href="ILContext.cs.html#705c9ba61cf070f3" class="i property">Root</a> <b>is</b> <span class="i">VariableDefinition</span>)
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r242 r">context</span>.<a href="ILContext.cs.html#705c9ba61cf070f3" class="i property">Root</a> <b>as</b> <span class="i">VariableDefinition</span>);
			<b>else if</b> (<span class="r242 r">context</span>.<a href="ILContext.cs.html#705c9ba61cf070f3" class="i property">Root</a> <b>is</b> <span class="i">FieldDefinition</span>) {
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldfld</span>, <span class="r242 r">context</span>.<a href="ILContext.cs.html#705c9ba61cf070f3" class="i property">Root</a> <b>as</b> <span class="i">FieldDefinition</span>);
			} <b>else 
				throw</b> <b>new</b> <a href="@0@mscorlib/A.html#c7fe14ee0f97d9eb" class="t constructor">InvalidProgramException</a>();
			<b>var</b> <span id="r249 rd" class="r249 r">declaringType</span> = <span class="r242 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">DeclaringType</span>;
			<b>while</b> (<span class="r249 r">declaringType</span>.<span class="i">IsNested</span>)
				<span class="r249 r">declaringType</span> = <span class="r249 r">declaringType</span>.<span class="i">DeclaringType</span>;
			<b>var</b> <span id="r250 rd" class="r250 r">handler</span> = <span class="r249 r">declaringType</span>.<span class="i">AllMethods</span>().<a href="@0@System.Core/A.html#b7e5965cab68b1cf" class="i method">FirstOrDefault</a>(<span id="r251 rd" class="r251 r">md</span> =&gt; <span class="r251 r">md</span>.<span class="i">Name</span> == <span class="r248 r">value</span> <b>as string</b>);
			<b>if</b> (<span class="r250 r">handler</span> == <b>null</b>) 
				<b>throw</b> <b>new</b> <a href="/Xamarin.Forms.Core/A.html#40567081c8b7dfe0" class="t constructor">XamlParseException</a>(<span class="s">$&quot;</span><span class="s">EventHandler \&quot;</span>{<span class="r248 r">value</span>}<span class="s">\&quot; not found in type \&quot;</span>{<span class="r242 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">DeclaringType</span>.<span class="i">FullName</span>}<span class="s">\&quot;</span><span class="s">&quot;</span>, <span class="r241 r">iXmlLineInfo</span>);
			<b>if</b> (<span class="r250 r">handler</span>.<span class="i">IsVirtual</span>) {
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldvirtftn</span>, <span class="r250 r">handler</span>);
			} <b>else
				yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldftn</span>, <span class="r250 r">handler</span>);
 
			<span class="c">//FIXME: eventually get the right ctor instead fo the First() one, just in case another one could exists (not even sure it&#39;s possible).</span>
			<b>var</b> <span id="r252 rd" class="r252 r">ctor</span> = <span class="r244 r">module</span>.<span class="i">ImportReference</span>(<span class="r246 r">eventinfo</span>.<span class="i">EventType</span>.<span class="i">Resolve</span>().<span class="i">GetConstructors</span>().<span class="i">First</span>());
			<span class="r252 r">ctor</span> = <span class="r252 r">ctor</span>.<span class="i">ResolveGenericParameters</span>(<span class="r246 r">eventinfo</span>.<span class="i">EventType</span>, <span class="r244 r">module</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Newobj</span>, <span class="r244 r">module</span>.<span class="i">ImportReference</span>(<span class="r252 r">ctor</span>));
			<b>var</b> <span id="r253 rd" class="r253 r">adder</span> = <span class="r244 r">module</span>.<span class="i">ImportReference</span>(<span class="r246 r">eventinfo</span>.<span class="i">AddMethod</span>);
			<span class="r253 r">adder</span> = <span class="r253 r">adder</span>.<span class="i">ResolveGenericParameters</span>(<span class="r245 r">eventDeclaringTypeRef</span>, <span class="r244 r">module</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r244 r">module</span>.<span class="i">ImportReference</span>(<span class="r253 r">adder</span>));
		}
 
		<b>static bool</b> <a id="c7d99b8e371f7b46" href="R/c7d99b8e371f7b46.html" target="n" data-glyph="76,1" class="i method">CanSetDynamicResource</a>(<span class="i">FieldReference</span> <span id="r254 rd" class="r254 r">bpRef</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r255 rd" class="r255 r">valueNode</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r256 rd" class="r256 r">context</span>)
		{
			<b>if</b> (<span class="r254 r">bpRef</span> == <b>null</b>)
				<b>return false</b>;
			<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="k">var</a> <span id="r257 rd" class="r257 r">elementNode</span> = <span class="r255 r">valueNode</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>;
			<b>if</b> (<span class="r257 r">elementNode</span> == <b>null</b>)
				<b>return false</b>;
			
			<span class="i">VariableDefinition</span> <span id="r258 rd" class="r258 r">varValue</span>;
			<b>if</b> (!<span class="r256 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a>.<a href="@0@mscorlib/A.html#2e5bc6d8c0f21e67" class="i method">TryGetValue</a>(<span class="r255 r">valueNode</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>, <b>out</b> <span class="r258 r">varValue</span>))
				<b>return false</b>;
			<b>return</b> <span class="r258 r">varValue</span>.<span class="i">VariableType</span>.<span class="i">FullName</span> == <b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#c82a08b846f4bfdc" class="t t">DynamicResource</a>).<a href="@0@mscorlib/A.html#976443bb39dc37cd" class="i property">FullName</a>;
		}
 
		<b>static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt; <a id="2a7dba97d5bd01b1" href="R/2a7dba97d5bd01b1.html" target="n" data-glyph="76,1" class="i method">SetDynamicResource</a>(<span class="i">VariableDefinition</span> <span id="r259 rd" class="r259 r">parent</span>, <span class="i">FieldReference</span> <span id="r260 rd" class="r260 r">bpRef</span>, <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a> <span id="r261 rd" class="r261 r">elementNode</span>, <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a> <span id="r262 rd" class="r262 r">iXmlLineInfo</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r263 rd" class="r263 r">context</span>)
		{
			<b>var</b> <span id="r264 rd" class="r264 r">module</span> = <span class="r263 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
			<b>var</b> <span id="r265 rd" class="r265 r">varValue</span> = <span class="r263 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a> [<span class="r261 r">elementNode</span>];
			<b>var</b> <span id="r266 rd" class="r266 r">setDynamicResource</span> = <span class="r264 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#370a45bf222ddf41" class="t t">IDynamicResourceHandler</a>)).<span class="i">Resolve</span>().<span class="i">Methods</span>.<span class="i">First</span>(<span id="r267 rd" class="r267 r">m</span> =&gt; <span class="r267 r">m</span>.<span class="i">Name</span> == <span class="s">&quot;SetDynamicResource&quot;</span>);
			<a href="@0@mscorlib/A.html#382d90b1fa682bac" class="k">var</a> <span id="r268 rd" class="r268 r">getKey</span> = <b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#c82a08b846f4bfdc" class="t t">DynamicResource</a>).<a href="@0@mscorlib/A.html#fabf683030a6ad8d" class="i method">GetProperty</a>(<span class="s">&quot;Key&quot;</span>).<a href="@0@mscorlib/A.html#4a7d7ce3dc2d6cb2" class="i property">GetMethod</a>;
 
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r259 r">parent</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldsfld</span>, <span class="r260 r">bpRef</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r265 r">varValue</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r264 r">module</span>.<span class="i">ImportReference</span>(<span class="r268 r">getKey</span>));
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r264 r">module</span>.<span class="i">ImportReference</span>(<span class="r266 r">setDynamicResource</span>));
		}
 
		<b>static bool</b> <a id="9d57362184311330" href="R/9d57362184311330.html" target="n" data-glyph="76,1" class="i method">CanSetBinding</a>(<span class="i">FieldReference</span> <span id="r269 rd" class="r269 r">bpRef</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r270 rd" class="r270 r">valueNode</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r271 rd" class="r271 r">context</span>)
		{
			<b>var</b> <span id="r272 rd" class="r272 r">module</span> = <span class="r271 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
 
			<b>if</b> (<span class="r269 r">bpRef</span> == <b>null</b>)
				<b>return false</b>;
			<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="k">var</a> <span id="r273 rd" class="r273 r">elementNode</span> = <span class="r270 r">valueNode</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>;
			<b>if</b> (<span class="r273 r">elementNode</span> == <b>null</b>)
				<b>return false</b>;
 
			<span class="i">VariableDefinition</span> <span id="r274 rd" class="r274 r">varValue</span>;
			<b>if</b> (!<span class="r271 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a>.<a href="@0@mscorlib/A.html#2e5bc6d8c0f21e67" class="i method">TryGetValue</a>(<span class="r270 r">valueNode</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>, <b>out</b> <span class="r274 r">varValue</span>))
				<b>return false</b>;
			<b>var</b> <span id="r275 rd" class="r275 r">implicitOperator</span> = <span class="r274 r">varValue</span>.<span class="i">VariableType</span>.<span class="i">GetImplicitOperatorTo</span>(<span class="r272 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#d4b9ac5f0cf91b95" class="t t">BindingBase</a>)), <span class="r272 r">module</span>);
			<b>if</b> (<span class="r275 r">implicitOperator</span> != <b>null</b>)
				<b>return true</b>;
 
			<b>return</b> <span class="r274 r">varValue</span>.<span class="i">VariableType</span>.<span class="i">InheritsFromOrImplements</span>(<span class="r272 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#d4b9ac5f0cf91b95" class="t t">BindingBase</a>)));
		}
 
		<b>static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt; <a id="0d5ee904e8f796c2" href="R/0d5ee904e8f796c2.html" target="n" data-glyph="76,1" class="i method">SetBinding</a>(<span class="i">VariableDefinition</span> <span id="r276 rd" class="r276 r">parent</span>, <span class="i">FieldReference</span> <span id="r277 rd" class="r277 r">bpRef</span>, <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a> <span id="r278 rd" class="r278 r">elementNode</span>, <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a> <span id="r279 rd" class="r279 r">iXmlLineInfo</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r280 rd" class="r280 r">context</span>)
		{
			<b>var</b> <span id="r281 rd" class="r281 r">module</span> = <span class="r280 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
			<b>var</b> <span id="r282 rd" class="r282 r">varValue</span> = <span class="r280 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a> [<span class="r278 r">elementNode</span>];
			<b>var</b> <span id="r283 rd" class="r283 r">implicitOperator</span> = <span class="r282 r">varValue</span>.<span class="i">VariableType</span>.<span class="i">GetImplicitOperatorTo</span>(<span class="r281 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#d4b9ac5f0cf91b95" class="t t">BindingBase</a>)), <span class="r281 r">module</span>);
 
			<span class="c">//TODO: check if parent is a BP</span>
			<a href="@0@mscorlib/A.html#382d90b1fa682bac" class="k">var</a> <span id="r284 rd" class="r284 r">setBinding</span> = <b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#804aed41f6e6b7c8" class="t t">BindableObject</a>).<a href="@0@mscorlib/A.html#d43a8d0bb16a0b39" class="i method">GetMethod</a>(<span class="s">&quot;SetBinding&quot;</span>, <b>new</b> [] { <b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#743d6dd5177e1828" class="t t">BindableProperty</a>), <b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#d4b9ac5f0cf91b95" class="t t">BindingBase</a>) });
 
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r276 r">parent</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldsfld</span>, <span class="r277 r">bpRef</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r282 r">varValue</span>);
			<b>if</b> (<span class="r283 r">implicitOperator</span> != <b>null</b>) 
<span class="c">//				IL_000f:  call !0 class [Xamarin.Forms.Core]Xamarin.Forms.OnPlatform`1&lt;BindingBase&gt;::op_Implicit(class [Xamarin.Forms.Core]Xamarin.Forms.OnPlatform`1&lt;!0&gt;)</span>
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Call</span>, <span class="r281 r">module</span>.<span class="i">ImportReference</span>(<span class="r283 r">implicitOperator</span>));
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r281 r">module</span>.<span class="i">ImportReference</span>(<span class="r284 r">setBinding</span>));
		}
 
		<b>static bool</b> <a id="c2cf3b5eeb9a364d" href="R/c2cf3b5eeb9a364d.html" target="n" data-glyph="76,1" class="i method">CanSetValue</a>(<span class="i">FieldReference</span> <span id="r285 rd" class="r285 r">bpRef</span>, <b>bool</b> <span id="r286 rd" class="r286 r">attached</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r287 rd" class="r287 r">node</span>, <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a> <span id="r288 rd" class="r288 r">iXmlLineInfo</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r289 rd" class="r289 r">context</span>)
		{
			<b>var</b> <span id="r290 rd" class="r290 r">module</span> = <span class="r289 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
 
			<b>if</b> (<span class="r285 r">bpRef</span> == <b>null</b>)
				<b>return false</b>;
 
			<b>if</b> (<span class="r287 r">node</span> <b>is</b> <a href="/Xamarin.Forms.Xaml/A.html#8154936e25abda05" class="t t">ValueNode</a>)
				<b>return true</b>;
 
			<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="k">var</a> <span id="r291 rd" class="r291 r">elementNode</span> = <span class="r287 r">node</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>;
			<b>if</b> (<span class="r291 r">elementNode</span> == <b>null</b>)
				<b>return false</b>;
 
			<span class="i">VariableDefinition</span> <span id="r292 rd" class="r292 r">varValue</span>;
			<b>if</b> (!<span class="r289 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a>.<a href="@0@mscorlib/A.html#2e5bc6d8c0f21e67" class="i method">TryGetValue</a>(<span class="r291 r">elementNode</span>, <b>out</b> <span class="r292 r">varValue</span>))
				<b>return false</b>;
 
			<b>var</b> <span id="r293 rd" class="r293 r">bpTypeRef</span> = <span class="r285 r">bpRef</span>.<span class="i">GetBindablePropertyType</span>(<span class="r288 r">iXmlLineInfo</span>, <span class="r290 r">module</span>);
			<span class="c">// If it&#39;s an attached BP, there&#39;s no second chance to handle IMarkupExtensions, so we try here.</span>
			<span class="c">// Worst case scenario ? InvalidCastException at runtime</span>
			<b>if</b> (<span class="r286 r">attached</span> &amp;&amp; <span class="r292 r">varValue</span>.<span class="i">VariableType</span>.<span class="i">FullName</span> == <span class="s">&quot;System.Object&quot;</span>) 
				<b>return true</b>;
			<b>var</b> <span id="r294 rd" class="r294 r">implicitOperator</span> = <span class="r292 r">varValue</span>.<span class="i">VariableType</span>.<span class="i">GetImplicitOperatorTo</span>(<span class="r293 r">bpTypeRef</span>, <span class="r290 r">module</span>);
			<b>if</b> (<span class="r294 r">implicitOperator</span> != <b>null</b>)
				<b>return true</b>;
 
			<span class="c">//as we&#39;re in the SetValue Scenario, we can accept value types, they&#39;ll be boxed</span>
			<b>if</b> (<span class="r292 r">varValue</span>.<span class="i">VariableType</span>.<span class="i">IsValueType</span> &amp;&amp; <span class="r293 r">bpTypeRef</span>.<span class="i">FullName</span> == <span class="s">&quot;System.Object&quot;</span>)
				<b>return true</b>;
 
			<b>return</b> <span class="r292 r">varValue</span>.<span class="i">VariableType</span>.<span class="i">InheritsFromOrImplements</span>(<span class="r293 r">bpTypeRef</span>);
		}
 
		<b>static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt; <a id="873ffeb8a4694413" href="R/873ffeb8a4694413.html" target="n" data-glyph="76,1" class="i method">SetValue</a>(<span class="i">VariableDefinition</span> <span id="r295 rd" class="r295 r">parent</span>, <span class="i">FieldReference</span> <span id="r296 rd" class="r296 r">bpRef</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r297 rd" class="r297 r">node</span>, <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a> <span id="r298 rd" class="r298 r">iXmlLineInfo</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r299 rd" class="r299 r">context</span>)
		{
			<a href="@0@mscorlib/A.html#382d90b1fa682bac" class="k">var</a> <span id="r300 rd" class="r300 r">setValue</span> = <b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#804aed41f6e6b7c8" class="t t">BindableObject</a>).<a href="@0@mscorlib/A.html#d43a8d0bb16a0b39" class="i method">GetMethod</a>(<span class="s">&quot;SetValue&quot;</span>, <b>new</b> [] { <b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#743d6dd5177e1828" class="t t">BindableProperty</a>), <b>typeof</b>(<b>object</b>) });
			<a href="/Xamarin.Forms.Xaml/A.html#8154936e25abda05" class="k">var</a> <span id="r301 rd" class="r301 r">valueNode</span> = <span class="r297 r">node</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#8154936e25abda05" class="t t">ValueNode</a>;
			<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="k">var</a> <span id="r302 rd" class="r302 r">elementNode</span> = <span class="r297 r">node</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>;
			<b>var</b> <span id="r303 rd" class="r303 r">module</span> = <span class="r299 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
 
<span class="c">//			IL_0007:  ldloc.0 </span>
<span class="c">//			IL_0008:  ldsfld class [Xamarin.Forms.Core]Xamarin.Forms.BindableProperty [Xamarin.Forms.Core]Xamarin.Forms.Label::TextProperty</span>
<span class="c">//			IL_000d:  ldstr &quot;foo&quot;</span>
<span class="c">//			IL_0012:  callvirt instance void class [Xamarin.Forms.Core]Xamarin.Forms.BindableObject::SetValue(class [Xamarin.Forms.Core]Xamarin.Forms.BindableProperty, object)</span>
 
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r295 r">parent</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldsfld</span>, <span class="r296 r">bpRef</span>);
 
			<b>if</b> (<span class="r301 r">valueNode</span> != <b>null</b>) {
				<b>foreach</b> (<b>var</b> <span id="r304 rd" class="r304 r">instruction</span> <b>in</b> <span class="r301 r">valueNode</span>.<a href="NodeILExtensions.cs.html#efa7f9550d0b6712" class="i method">PushConvertedValue</a>(<span class="r299 r">context</span>, <span class="r296 r">bpRef</span>, <span class="r301 r">valueNode</span>.<a href="NodeILExtensions.cs.html#895e7d2b28c5de96" class="i method">PushServiceProvider</a>(<span class="r299 r">context</span>, <span class="r305 r">bpRef</span>:<span class="r296 r">bpRef</span>), <b>true</b>, <b>false</b>))
					<b>yield return</b> <span class="r304 r">instruction</span>;
			} <b>else if</b> (<span class="r302 r">elementNode</span> != <b>null</b>) {
				<b>var</b> <span id="r306 rd" class="r306 r">bpTypeRef</span> = <span class="r296 r">bpRef</span>.<span class="i">GetBindablePropertyType</span>(<span class="r298 r">iXmlLineInfo</span>, <span class="r303 r">module</span>);
				<b>var</b> <span id="r307 rd" class="r307 r">varDef</span> = <span class="r299 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r302 r">elementNode</span>];
				<b>var</b> <span id="r308 rd" class="r308 r">varType</span> = <span class="r307 r">varDef</span>.<span class="i">VariableType</span>;
				<b>var</b> <span id="r309 rd" class="r309 r">implicitOperator</span> = <span class="r307 r">varDef</span>.<span class="i">VariableType</span>.<span class="i">GetImplicitOperatorTo</span>(<span class="r306 r">bpTypeRef</span>, <span class="r303 r">module</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r307 r">varDef</span>);
				<b>if</b> (<span class="r309 r">implicitOperator</span> != <b>null</b>) {
					<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Call</span>, <span class="r303 r">module</span>.<span class="i">ImportReference</span>(<span class="r309 r">implicitOperator</span>));
					<span class="r308 r">varType</span> = <span class="r303 r">module</span>.<span class="i">ImportReference</span>(<span class="r306 r">bpTypeRef</span>);
				}
				<b>if</b> (<span class="r308 r">varType</span>.<span class="i">IsValueType</span>)
					<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Box</span>, <span class="r308 r">varType</span>);
			}
 
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r303 r">module</span>.<span class="i">ImportReference</span>(<span class="r300 r">setValue</span>));
		}
 
		<b>static bool</b> <a id="ac4007486be61820" href="R/ac4007486be61820.html" target="n" data-glyph="76,1" class="i method">CanSet</a>(<span class="i">VariableDefinition</span> <span id="r310 rd" class="r310 r">parent</span>, <b>string</b> <span id="r311 rd" class="r311 r">localName</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r312 rd" class="r312 r">node</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r313 rd" class="r313 r">context</span>)
		{
			<b>var</b> <span id="r314 rd" class="r314 r">module</span> = <span class="r313 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
			<span class="i">TypeReference</span> <span id="r315 rd" class="r315 r">declaringTypeReference</span>;
			<b>var</b> <span id="r316 rd" class="r316 r">property</span> = <span class="r310 r">parent</span>.<span class="i">VariableType</span>.<span class="i">GetProperty</span>(<span id="r317 rd" class="r317 r">pd</span> =&gt; <span class="r317 r">pd</span>.<span class="i">Name</span> == <span class="r311 r">localName</span>, <b>out</b> <span class="r315 r">declaringTypeReference</span>);
			<b>if</b> (<span class="r316 r">property</span> == <b>null</b>)
				<b>return false</b>;
			<b>var</b> <span id="r318 rd" class="r318 r">propertySetter</span> = <span class="r316 r">property</span>.<span class="i">SetMethod</span>;
			<b>if</b> (<span class="r318 r">propertySetter</span> == <b>null</b> || !<span class="r318 r">propertySetter</span>.<span class="i">IsPublic</span> || <span class="r318 r">propertySetter</span>.<span class="i">IsStatic</span>)
				<b>return false</b>;
 
			<b>if</b> (<span class="r312 r">node</span> <b>is</b> <a href="/Xamarin.Forms.Xaml/A.html#8154936e25abda05" class="t t">ValueNode</a>)
				<b>return true</b>;
 
			<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="k">var</a> <span id="r319 rd" class="r319 r">elementNode</span> = <span class="r312 r">node</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>;
			<b>if</b> (<span class="r319 r">elementNode</span> == <b>null</b>)
				<b>return false</b>;
 
			<b>var</b> <span id="r320 rd" class="r320 r">vardef</span> = <span class="r313 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a> [<span class="r319 r">elementNode</span>];
			<b>var</b> <span id="r321 rd" class="r321 r">propertyType</span> = <span class="r316 r">property</span>.<span class="i">ResolveGenericPropertyType</span>(<span class="r315 r">declaringTypeReference</span>, <span class="r314 r">module</span>);
			<b>var</b> <span id="r322 rd" class="r322 r">implicitOperator</span> = <span class="r320 r">vardef</span>.<span class="i">VariableType</span>.<span class="i">GetImplicitOperatorTo</span>(<span class="r321 r">propertyType</span>, <span class="r314 r">module</span>);
 
			<b>if</b> (<span class="r322 r">implicitOperator</span> != <b>null</b>)
				<b>return true</b>;
			<b>if</b> (<span class="r320 r">vardef</span>.<span class="i">VariableType</span>.<span class="i">InheritsFromOrImplements</span>(<span class="r321 r">propertyType</span>))
				<b>return true</b>;
			<b>if</b> (<span class="r321 r">propertyType</span>.<span class="i">FullName</span> == <span class="s">&quot;System.Object&quot;</span>)
				<b>return true</b>;
 
			<span class="c">//I&#39;d like to get rid of this condition. This comment used to be //TODO replace latest check by a runtime type check</span>
			<b>if</b> (<span class="r320 r">vardef</span>.<span class="i">VariableType</span>.<span class="i">FullName</span> == <span class="s">&quot;System.Object&quot;</span>)
				<b>return true</b>;
 
			<b>return false</b>;
		}
 
		<b>static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt; <a id="973ddee6569cfa7b" href="R/973ddee6569cfa7b.html" target="n" data-glyph="76,1" class="i method">Set</a>(<span class="i">VariableDefinition</span> <span id="r323 rd" class="r323 r">parent</span>, <b>string</b> <span id="r324 rd" class="r324 r">localName</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r325 rd" class="r325 r">node</span>, <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a> <span id="r326 rd" class="r326 r">iXmlLineInfo</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r327 rd" class="r327 r">context</span>)
		{
			<b>var</b> <span id="r328 rd" class="r328 r">module</span> = <span class="r327 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
			<span class="i">TypeReference</span> <span id="r329 rd" class="r329 r">declaringTypeReference</span>;
			<b>var</b> <span id="r330 rd" class="r330 r">property</span> = <span class="r323 r">parent</span>.<span class="i">VariableType</span>.<span class="i">GetProperty</span>(<span id="r331 rd" class="r331 r">pd</span> =&gt; <span class="r331 r">pd</span>.<span class="i">Name</span> == <span class="r324 r">localName</span>, <b>out</b> <span class="r329 r">declaringTypeReference</span>);
			<b>var</b> <span id="r332 rd" class="r332 r">propertySetter</span> = <span class="r330 r">property</span>.<span class="i">SetMethod</span>;
 
<span class="c">//			IL_0007:  ldloc.0</span>
<span class="c">//			IL_0008:  ldstr &quot;foo&quot;</span>
<span class="c">//			IL_000d:  callvirt instance void class [Xamarin.Forms.Core]Xamarin.Forms.Label::set_Text(string)</span>
 
			<span class="r328 r">module</span>.<span class="i">ImportReference</span>(<span class="r323 r">parent</span>.<span class="i">VariableType</span>.<span class="i">Resolve</span>());
			<b>var</b> <span id="r333 rd" class="r333 r">propertySetterRef</span> = <span class="r328 r">module</span>.<span class="i">ImportReference</span>(<span class="r328 r">module</span>.<span class="i">ImportReference</span>(<span class="r332 r">propertySetter</span>).<span class="i">ResolveGenericParameters</span>(<span class="r329 r">declaringTypeReference</span>, <span class="r328 r">module</span>));
			<span class="r333 r">propertySetterRef</span>.<span class="i">ImportTypes</span>(<span class="r328 r">module</span>);
			<b>var</b> <span id="r334 rd" class="r334 r">propertyType</span> = <span class="r330 r">property</span>.<span class="i">ResolveGenericPropertyType</span>(<span class="r329 r">declaringTypeReference</span>, <span class="r328 r">module</span>);
			<a href="/Xamarin.Forms.Xaml/A.html#8154936e25abda05" class="k">var</a> <span id="r335 rd" class="r335 r">valueNode</span> = <span class="r325 r">node</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#8154936e25abda05" class="t t">ValueNode</a>;
			<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="k">var</a> <span id="r336 rd" class="r336 r">elementNode</span> = <span class="r325 r">node</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>;
 
			<span class="c">//if it&#39;s a value type, load the address so we can invoke methods on it</span>
			<b>if</b> (<span class="r323 r">parent</span>.<span class="i">VariableType</span>.<span class="i">IsValueType</span>)
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloca</span>, <span class="r323 r">parent</span>);
			<b>else
				yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r323 r">parent</span>);
 
			<b>if</b> (<span class="r335 r">valueNode</span> != <b>null</b>) {
				<b>foreach</b> (<b>var</b> <span id="r337 rd" class="r337 r">instruction</span> <b>in</b> <span class="r335 r">valueNode</span>.<a href="NodeILExtensions.cs.html#3cbac4793dbbae49" class="i method">PushConvertedValue</a>(<span class="r327 r">context</span>, <span class="r334 r">propertyType</span>, <b>new</b> <span class="i">ICustomAttributeProvider</span> [] { <span class="r330 r">property</span>, <span class="r334 r">propertyType</span>.<span class="i">Resolve</span>() }, <span class="r335 r">valueNode</span>.<span class="i">PushServiceProvider</span>(<span class="r327 r">context</span>, <span class="i">propertyRef</span>:<span class="r330 r">property</span>), <b>false</b>, <b>true</b>))
					<b>yield return</b> <span class="r337 r">instruction</span>;
				<b>if</b> (<span class="r323 r">parent</span>.<span class="i">VariableType</span>.<span class="i">IsValueType</span>)
					<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Call</span>, <span class="r333 r">propertySetterRef</span>);
				<b>else
					yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r333 r">propertySetterRef</span>);
			} <b>else if</b> (<span class="r336 r">elementNode</span> != <b>null</b>) {
				<b>var</b> <span id="r338 rd" class="r338 r">vardef</span> = <span class="r327 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a> [<span class="r336 r">elementNode</span>];
				<b>var</b> <span id="r339 rd" class="r339 r">implicitOperator</span> = <span class="r338 r">vardef</span>.<span class="i">VariableType</span>.<span class="i">GetImplicitOperatorTo</span>(<span class="r334 r">propertyType</span>, <span class="r328 r">module</span>);
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r338 r">vardef</span>);
				<b>if</b> (<span class="r339 r">implicitOperator</span> != <b>null</b>) {
<span class="c">//					IL_000f:  call !0 class [Xamarin.Forms.Core]Xamarin.Forms.OnPlatform`1&lt;bool&gt;::op_Implicit(class [Xamarin.Forms.Core]Xamarin.Forms.OnPlatform`1&lt;!0&gt;)</span>
					<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Call</span>, <span class="r328 r">module</span>.<span class="i">ImportReference</span>(<span class="r339 r">implicitOperator</span>));
				} <b>else if</b> (!<span class="r338 r">vardef</span>.<span class="i">VariableType</span>.<span class="i">IsValueType</span> &amp;&amp; <span class="r334 r">propertyType</span>.<span class="i">IsValueType</span>)
					<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Unbox_Any</span>, <span class="r328 r">module</span>.<span class="i">ImportReference</span>(<span class="r334 r">propertyType</span>));
				<b>else if</b> (<span class="r338 r">vardef</span>.<span class="i">VariableType</span>.<span class="i">IsValueType</span> &amp;&amp; <span class="r334 r">propertyType</span>.<span class="i">FullName</span> == <span class="s">&quot;System.Object&quot;</span>)
					<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Box</span>, <span class="r338 r">vardef</span>.<span class="i">VariableType</span>);
				<b>if</b> (<span class="r323 r">parent</span>.<span class="i">VariableType</span>.<span class="i">IsValueType</span>)
					<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Call</span>, <span class="r333 r">propertySetterRef</span>);
				<b>else
					yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r333 r">propertySetterRef</span>);
			}
		}
 
		<b>static bool</b> <a id="146497ab02547952" href="R/146497ab02547952.html" target="n" data-glyph="76,1" class="i method">CanAdd</a>(<span class="i">VariableDefinition</span> <span id="r340 rd" class="r340 r">parent</span>, <b>string</b> <span id="r341 rd" class="r341 r">localName</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r342 rd" class="r342 r">node</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r343 rd" class="r343 r">context</span>)
		{
			<b>var</b> <span id="r344 rd" class="r344 r">module</span> = <span class="r343 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
			<span class="i">TypeReference</span> <span id="r345 rd" class="r345 r">declaringTypeReference</span>;
			<b>var</b> <span id="r346 rd" class="r346 r">property</span> = <span class="r340 r">parent</span>.<span class="i">VariableType</span>.<span class="i">GetProperty</span>(<span id="r347 rd" class="r347 r">pd</span> =&gt; <span class="r347 r">pd</span>.<span class="i">Name</span> == <span class="r341 r">localName</span>, <b>out</b> <span class="r345 r">declaringTypeReference</span>);
			<b>if</b> (<span class="r346 r">property</span> == <b>null</b>)
				<b>return false</b>;
			<b>var</b> <span id="r348 rd" class="r348 r">propertyGetter</span> = <span class="r346 r">property</span>.<span class="i">GetMethod</span>;
			<b>if</b> (<span class="r348 r">propertyGetter</span> == <b>null</b> || !<span class="r348 r">propertyGetter</span>.<span class="i">IsPublic</span> || <span class="r348 r">propertyGetter</span>.<span class="i">IsStatic</span>)
				<b>return false</b>;
			<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="k">var</a> <span id="r349 rd" class="r349 r">elementNode</span> = <span class="r342 r">node</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>;
			<b>if</b> (<span class="r349 r">elementNode</span> == <b>null</b>)
				<b>return false</b>;
 
			<b>var</b> <span id="r350 rd" class="r350 r">vardef</span> = <span class="r343 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a> [<span class="r349 r">elementNode</span>];
			<b>var</b> <span id="r351 rd" class="r351 r">propertyGetterRef</span> = <span class="r344 r">module</span>.<span class="i">ImportReference</span>(<span class="r348 r">propertyGetter</span>);
			<span class="r351 r">propertyGetterRef</span> = <span class="r344 r">module</span>.<span class="i">ImportReference</span>(<span class="r351 r">propertyGetterRef</span>.<span class="i">ResolveGenericParameters</span>(<span class="r345 r">declaringTypeReference</span>, <span class="r344 r">module</span>));
			<b>var</b> <span id="r352 rd" class="r352 r">propertyType</span> = <span class="r351 r">propertyGetterRef</span>.<span class="i">ReturnType</span>.<span class="i">ResolveGenericParameters</span>(<span class="r345 r">declaringTypeReference</span>);
 
			<span class="c">//TODO check md.Parameters[0] type</span>
			<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="k">var</a> <span id="r353 rd" class="r353 r">adderTuple</span> = <span class="r352 r">propertyType</span>.<span class="i">GetMethods</span>(<span id="r354 rd" class="r354 r">md</span> =&gt; <span class="r354 r">md</span>.<span class="i">Name</span> == <span class="s">&quot;Add&quot;</span> &amp;&amp; <span class="r354 r">md</span>.<span class="i">Parameters</span>.<span class="i">Count</span> == 1, <span class="r344 r">module</span>).<a href="@0@System.Core/A.html#8087366974af11d2" class="i method">FirstOrDefault</a>();
			<b>if</b> (<span class="r353 r">adderTuple</span> == <b>null</b>)
				<b>return false</b>;
 
			<b>return true</b>;
		}
 
		<b>static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="i">Instruction</span>&gt; <a id="7e3c2684d83929a5" href="R/7e3c2684d83929a5.html" target="n" data-glyph="76,1" class="i method">Add</a>(<span class="i">VariableDefinition</span> <span id="r355 rd" class="r355 r">parent</span>, <b>string</b> <span id="r356 rd" class="r356 r">localName</span>, <a href="/Xamarin.Forms.Xaml/A.html#9697de7bafb1de38" class="t t">INode</a> <span id="r357 rd" class="r357 r">node</span>, <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a> <span id="r358 rd" class="r358 r">iXmlLineInfo</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r359 rd" class="r359 r">context</span>)
		{
			<b>var</b> <span id="r360 rd" class="r360 r">module</span> = <span class="r359 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>;
			<span class="i">TypeReference</span> <span id="r361 rd" class="r361 r">declaringTypeReference</span>;
			<b>var</b> <span id="r362 rd" class="r362 r">property</span> = <span class="r355 r">parent</span>.<span class="i">VariableType</span>.<span class="i">GetProperty</span>(<span id="r363 rd" class="r363 r">pd</span> =&gt; <span class="r363 r">pd</span>.<span class="i">Name</span> == <span class="r356 r">localName</span>, <b>out</b> <span class="r361 r">declaringTypeReference</span>);
			<b>var</b> <span id="r364 rd" class="r364 r">propertyGetter</span> = <span class="r362 r">property</span>.<span class="i">GetMethod</span>;
			<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="k">var</a> <span id="r365 rd" class="r365 r">elementNode</span> = <span class="r357 r">node</span> <b>as</b> <a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a>;
			<b>var</b> <span id="r366 rd" class="r366 r">vardef</span> = <span class="r359 r">context</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a> [<span class="r365 r">elementNode</span>];
			<b>var</b> <span id="r367 rd" class="r367 r">propertyGetterRef</span> = <span class="r360 r">module</span>.<span class="i">ImportReference</span>(<span class="r364 r">propertyGetter</span>);
			<span class="r367 r">propertyGetterRef</span> = <span class="r360 r">module</span>.<span class="i">ImportReference</span>(<span class="r367 r">propertyGetterRef</span>.<span class="i">ResolveGenericParameters</span>(<span class="r361 r">declaringTypeReference</span>, <span class="r360 r">module</span>));
			<b>var</b> <span id="r368 rd" class="r368 r">propertyType</span> = <span class="r367 r">propertyGetterRef</span>.<span class="i">ReturnType</span>.<span class="i">ResolveGenericParameters</span>(<span class="r361 r">declaringTypeReference</span>);
			<span class="c">//TODO check md.Parameters[0] type</span>
			<a href="@0@mscorlib/A.html#1806cf6634f5a371" class="k">var</a> <span id="r369 rd" class="r369 r">adderTuple</span> = <span class="r368 r">propertyType</span>.<span class="i">GetMethods</span>(<span id="r370 rd" class="r370 r">md</span> =&gt; <span class="r370 r">md</span>.<span class="i">Name</span> == <span class="s">&quot;Add&quot;</span> &amp;&amp; <span class="r370 r">md</span>.<span class="i">Parameters</span>.<span class="i">Count</span> == 1, <span class="r360 r">module</span>).<a href="@0@System.Core/A.html#8087366974af11d2" class="i method">FirstOrDefault</a>();
			<b>var</b> <span id="r371 rd" class="r371 r">adderRef</span> = <span class="r360 r">module</span>.<span class="i">ImportReference</span>(<span class="r369 r">adderTuple</span>.<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>);
			<span class="r371 r">adderRef</span> = <span class="r360 r">module</span>.<span class="i">ImportReference</span>(<span class="r371 r">adderRef</span>.<span class="i">ResolveGenericParameters</span>(<span class="r369 r">adderTuple</span>.<a href="@0@mscorlib/A.html#85ddc983cace902c" class="i property">Item2</a>, <span class="r360 r">module</span>));
			<b>var</b> <span id="r372 rd" class="r372 r">childType</span> = <span class="i">GetParameterType</span>(<span class="r371 r">adderRef</span>.<span class="i">Parameters</span> [0]);
			<b>var</b> <span id="r373 rd" class="r373 r">implicitOperator</span> = <span class="r366 r">vardef</span>.<span class="i">VariableType</span>.<span class="i">GetImplicitOperatorTo</span>(<span class="r372 r">childType</span>, <span class="r360 r">module</span>);
 
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r355 r">parent</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r367 r">propertyGetterRef</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r366 r">vardef</span>);
			<b>if</b> (<span class="r373 r">implicitOperator</span> != <b>null</b>)
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Call</span>, <span class="r360 r">module</span>.<span class="i">ImportReference</span>(<span class="r373 r">implicitOperator</span>));
			<b>if</b> (<span class="r373 r">implicitOperator</span> == <b>null</b> &amp;&amp; <span class="r366 r">vardef</span>.<span class="i">VariableType</span>.<span class="i">IsValueType</span> &amp;&amp; !<span class="r372 r">childType</span>.<span class="i">IsValueType</span>)
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Box</span>, <span class="r366 r">vardef</span>.<span class="i">VariableType</span>);
			<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r371 r">adderRef</span>);
			<b>if</b> (<span class="r371 r">adderRef</span>.<span class="i">ReturnType</span>.<span class="i">FullName</span> != <span class="s">&quot;System.Void&quot;</span>)
				<b>yield return</b> <span class="i">Instruction</span>.<span class="i">Create</span>(<span class="i">OpCodes</span>.<span class="i">Pop</span>);
		}
 
		<b>public static</b> <span class="i">TypeReference</span> <a id="aba69af831ae728e" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetParameterType</a>(<span class="i">ParameterDefinition</span> <span id="r374 rd" class="r374 r">param</span>)
		{
			<b>if</b> (!<span class="r374 r">param</span>.<span class="i">ParameterType</span>.<span class="i">IsGenericParameter</span>)
				<b>return</b> <span class="r374 r">param</span>.<span class="i">ParameterType</span>;
			<b>var</b> <span id="r375 rd" class="r375 r">type</span> = (<span class="r374 r">param</span>.<span class="i">Method</span> <b>as</b> <span class="i">MethodReference</span>).<span class="i">DeclaringType</span> <b>as</b> <span class="i">GenericInstanceType</span>;
			<b>return</b> <span class="r375 r">type</span>.<span class="i">GenericArguments</span> [0];
		}
 
		<b>static bool</b> <a id="b359e51a5e79ca40" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetNameAndTypeRef</a>(<b>ref</b> <span class="i">TypeReference</span> <span id="r376 rd" class="r376 r">elementType</span>, <b>string</b> <span id="r377 rd" class="r377 r">namespaceURI</span>, <b>ref string</b> <span id="r378 rd" class="r378 r">localname</span>,
			<a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r379 rd" class="r379 r">context</span>, <a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a> <span id="r380 rd" class="r380 r">lineInfo</span>)
		{
			<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r381 rd" class="r381 r">dotIdx</span> = <span class="r378 r">localname</span>.<a href="@0@mscorlib/A.html#eb06d6d166f6a3d9" class="i method">IndexOf</a>(<span class="s">&#39;.&#39;</span>);
			<b>if</b> (<span class="r381 r">dotIdx</span> &gt; 0)
			{
				<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r382 rd" class="r382 r">typename</span> = <span class="r378 r">localname</span>.<a href="@0@mscorlib/A.html#8124961f027d9ac9" class="i method">Substring</a>(0, <span class="r381 r">dotIdx</span>);
				<span class="r378 r">localname</span> = <span class="r378 r">localname</span>.<a href="@0@mscorlib/A.html#882fa7998d6ca35a" class="i method">Substring</a>(<span class="r381 r">dotIdx</span> + 1);
				<span class="r376 r">elementType</span> = <b>new</b> <a href="/Xamarin.Forms.Xaml/A.html#0a1740224b8aaa73" class="t constructor">XmlType</a>(<span class="r377 r">namespaceURI</span>, <span class="r382 r">typename</span>, <b>null</b>).<span class="i">GetTypeReference</span>(<span class="r379 r">context</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Module</span>, <span class="r380 r">lineInfo</span>);
				<b>return true</b>;
			}
			<b>return false</b>;
		}
 
		<b>static void</b> <a id="f680f7feab3c720f" href="R/f680f7feab3c720f.html" target="n" data-glyph="76,1" class="i method">SetDataTemplate</a>(<a href="/Xamarin.Forms.Xaml/A.html#0395ca46ae80839a" class="t t">IElementNode</a> <span id="r383 rd" class="r383 r">parentNode</span>, <a href="/Xamarin.Forms.Xaml/A.html#6162566191bf011a" class="t t">ElementNode</a> <span id="r384 rd" class="r384 r">node</span>, <a href="ILContext.cs.html#cfeae44d09d495a0" class="t t">ILContext</a> <span id="r385 rd" class="r385 r">parentContext</span>,
			<a href="@0@System.Xml/A.html#9acfbdd9c868e54d" class="t t">IXmlLineInfo</a> <span id="r386 rd" class="r386 r">xmlLineInfo</span>)
		{
			<b>var</b> <span id="r387 rd" class="r387 r">parentVar</span> = <span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r383 r">parentNode</span>];
			<span class="c">//Push the DataTemplate to the stack, for setting the template</span>
			<span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r387 r">parentVar</span>);
 
			<span class="c">//Create nested class</span>
			<span class="c">//			.class nested private auto ansi sealed beforefieldinit &#39;&lt;Main&gt;c__AnonStorey0&#39;</span>
			<span class="c">//			extends [mscorlib]System.Object</span>
 
 
			<b>var</b> <span id="r388 rd" class="r388 r">module</span> = <span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#1b1129cf4c1c8523" class="i property">Module</a>;
			<b>var</b> <span id="r389 rd" class="r389 r">compilerGeneratedCtor</span> = <span class="r388 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">CompilerServices</span>.<a href="@0@mscorlib/A.html#f3e664c37c84df1f" class="t t">CompilerGeneratedAttribute</a>)).<span class="i">GetMethods</span>(<span id="r390 rd" class="r390 r">md</span> =&gt; <span class="r390 r">md</span>.<span class="i">IsConstructor</span>, <span class="r388 r">module</span>).<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>().<a href="@0@mscorlib/A.html#d1922db1cf9dcd03" class="i property">Item1</a>;
			<b>var</b> <span id="r391 rd" class="r391 r">anonType</span> = <b>new</b> <span class="i">TypeDefinition</span>(
				<b>null</b>,
				<span class="s">&quot;&lt;&quot;</span> + <span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">Name</span> + <span class="s">&quot;&gt;_anonXamlCDataTemplate_&quot;</span> + <a href="#4485b43b1662201e" class="i field">dtcount</a>++,
				<span class="i">TypeAttributes</span>.<span class="i">BeforeFieldInit</span> |
				<span class="i">TypeAttributes</span>.<span class="i">Sealed</span> |
				<span class="i">TypeAttributes</span>.<span class="i">NestedPrivate</span>)
			{
				<span class="i">BaseType</span> = <span class="r388 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">Object</span>,
				<span class="i">CustomAttributes</span> = {
					<b>new</b> <span class="i">CustomAttribute</span> (<span class="r388 r">module</span>.<span class="i">ImportReference</span>(<span class="r389 r">compilerGeneratedCtor</span>))
				}
			};
 
			<span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#cac61ff1aeca890c" class="i property">Body</a>.<span class="i">Method</span>.<span class="i">DeclaringType</span>.<span class="i">NestedTypes</span>.<span class="i">Add</span>(<span class="r391 r">anonType</span>);
			<b>var</b> <span id="r392 rd" class="r392 r">ctor</span> = <span class="r391 r">anonType</span>.<a href="TypeDefinitionExtensions.cs.html#f2bb05f85939564e" class="i method">AddDefaultConstructor</a>();
 
			<b>var</b> <span id="r393 rd" class="r393 r">loadTemplate</span> = <b>new</b> <span class="i">MethodDefinition</span>(<span class="s">&quot;LoadDataTemplate&quot;</span>,
				<span class="i">MethodAttributes</span>.<span class="i">Assembly</span> | <span class="i">MethodAttributes</span>.<span class="i">HideBySig</span>,
				<span class="r388 r">module</span>.<span class="i">TypeSystem</span>.<span class="i">Object</span>);
			<span class="r393 r">loadTemplate</span>.<span class="i">Body</span>.<span class="i">InitLocals</span> = <b>true</b>;
			<span class="r391 r">anonType</span>.<span class="i">Methods</span>.<span class="i">Add</span>(<span class="r393 r">loadTemplate</span>);
 
			<b>var</b> <span id="r394 rd" class="r394 r">parentValues</span> = <b>new</b> <span class="i">FieldDefinition</span>(<span class="s">&quot;parentValues&quot;</span>, <span class="i">FieldAttributes</span>.<span class="i">Assembly</span>, <span class="r388 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b> (<b>object</b>[])));
			<span class="r391 r">anonType</span>.<span class="i">Fields</span>.<span class="i">Add</span>(<span class="r394 r">parentValues</span>);
 
			<span class="i">TypeReference</span> <span id="r395 rd" class="r395 r">rootType</span> = <b>null</b>;
			<b>var</b> <span id="r396 rd" class="r396 r">vdefRoot</span> = <span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#705c9ba61cf070f3" class="i property">Root</a> <b>as</b> <span class="i">VariableDefinition</span>;
			<b>if</b> (<span class="r396 r">vdefRoot</span> != <b>null</b>)
				<span class="r395 r">rootType</span> = <span class="r396 r">vdefRoot</span>.<span class="i">VariableType</span>;
			<b>var</b> <span id="r397 rd" class="r397 r">fdefRoot</span> = <span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#705c9ba61cf070f3" class="i property">Root</a> <b>as</b> <span class="i">FieldDefinition</span>;
			<b>if</b> (<span class="r397 r">fdefRoot</span> != <b>null</b>)
				<span class="r395 r">rootType</span> = <span class="r397 r">fdefRoot</span>.<span class="i">FieldType</span>;
 
			<b>var</b> <span id="r398 rd" class="r398 r">root</span> = <b>new</b> <span class="i">FieldDefinition</span>(<span class="s">&quot;root&quot;</span>, <span class="i">FieldAttributes</span>.<span class="i">Assembly</span>, <span class="r395 r">rootType</span>);
			<span class="r391 r">anonType</span>.<span class="i">Fields</span>.<span class="i">Add</span>(<span class="r398 r">root</span>);
 
			<span class="c">//Fill the loadTemplate Body</span>
			<b>var</b> <span id="r399 rd" class="r399 r">templateIl</span> = <span class="r393 r">loadTemplate</span>.<span class="i">Body</span>.<span class="i">GetILProcessor</span>();
			<span class="r399 r">templateIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Nop</span>);
			<a href="ILContext.cs.html#cfeae44d09d495a0" class="k">var</a> <span id="r400 rd" class="r400 r">templateContext</span> = <b>new</b> <span class="t">ILContext</span>(<span class="r399 r">templateIl</span>, <span class="r393 r">loadTemplate</span>.<span class="i">Body</span>, <span class="r388 r">module</span>, <span class="r394 r">parentValues</span>)
			{
				<a href="ILContext.cs.html#705c9ba61cf070f3" class="i property">Root</a> = <span class="r398 r">root</span>
			};
			<span class="r384 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#37e536862b9f395f" class="i method">Accept</a>(<b>new</b> <a href="CreateObjectVisitor.cs.html#b5016315583d751b" class="t constructor">CreateObjectVisitor</a>(<span class="r400 r">templateContext</span>), <b>null</b>);
			<span class="r384 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#37e536862b9f395f" class="i method">Accept</a>(<b>new</b> <a href="SetNamescopesAndRegisterNamesVisitor.cs.html#b8cf7cd1f7cce875" class="t constructor">SetNamescopesAndRegisterNamesVisitor</a>(<span class="r400 r">templateContext</span>), <b>null</b>);
			<span class="r384 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#37e536862b9f395f" class="i method">Accept</a>(<b>new</b> <a href="SetFieldVisitor.cs.html#b7a60075814d5d31" class="t constructor">SetFieldVisitor</a>(<span class="r400 r">templateContext</span>), <b>null</b>);
			<span class="r384 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#37e536862b9f395f" class="i method">Accept</a>(<b>new</b> <a href="SetResourcesVisitor.cs.html#78d84508ea619aa3" class="t constructor">SetResourcesVisitor</a>(<span class="r400 r">templateContext</span>), <b>null</b>);
			<span class="r384 r">node</span>.<a href="/Xamarin.Forms.Xaml/A.html#37e536862b9f395f" class="i method">Accept</a>(<b>new</b> <a href="#4ad47baf30ec7c64" class="t constructor">SetPropertiesVisitor</a>(<span class="r400 r">templateContext</span>, <span class="r1 r">stopOnResourceDictionary</span>: <b>true</b>), <b>null</b>);
 
			<span class="r399 r">templateIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r400 r">templateContext</span>.<a href="ILContext.cs.html#3a594383a1a7a590" class="i property">Variables</a><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r384 r">node</span>]);
			<span class="r399 r">templateIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ret</span>);
 
			<span class="c">//Instanciate nested class</span>
			<b>var</b> <span id="r401 rd" class="r401 r">parentIl</span> = <span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>;
			<span class="r401 r">parentIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Newobj</span>, <span class="r392 r">ctor</span>);
 
			<span class="c">//Copy required local vars</span>
			<span class="r401 r">parentIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Dup</span>); <span class="c">//Duplicate the nestedclass instance</span>
			<span class="r401 r">parentIl</span>.<a href="ILProcessorExtensions.cs.html#acd8ad5b987316bd" class="i method">Append</a>(<span class="r384 r">node</span>.<a href="NodeILExtensions.cs.html#3d298c89451f153f" class="i method">PushParentObjectsArray</a>(<span class="r385 r">parentContext</span>));
			<span class="r401 r">parentIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Stfld</span>, <span class="r394 r">parentValues</span>);
			<span class="r401 r">parentIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Dup</span>); <span class="c">//Duplicate the nestedclass instance</span>
			<b>if</b> (<span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#705c9ba61cf070f3" class="i property">Root</a> <b>is</b> <span class="i">VariableDefinition</span>)
				<span class="r401 r">parentIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#705c9ba61cf070f3" class="i property">Root</a> <b>as</b> <span class="i">VariableDefinition</span>);
			<b>else if</b> (<span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#705c9ba61cf070f3" class="i property">Root</a> <b>is</b> <span class="i">FieldDefinition</span>)
			{
				<span class="r401 r">parentIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
				<span class="r401 r">parentIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldfld</span>, <span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#705c9ba61cf070f3" class="i property">Root</a> <b>as</b> <span class="i">FieldDefinition</span>);
			}
			<b>else
				throw</b> <b>new</b> <a href="@0@mscorlib/A.html#c7fe14ee0f97d9eb" class="t constructor">InvalidProgramException</a>();
			<span class="r401 r">parentIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Stfld</span>, <span class="r398 r">root</span>);
 
			<span class="c">//SetDataTemplate</span>
			<span class="r401 r">parentIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldftn</span>, <span class="r393 r">loadTemplate</span>);
			<b>var</b> <span id="r402 rd" class="r402 r">funcObjRef</span> = <span class="r388 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b>(<a href="@0@mscorlib/A.html#87d60abb7092d5a4" class="t t">Func</a>&lt;<b>object</b>&gt;));
			<b>var</b> <span id="r403 rd" class="r403 r">funcCtor</span> =
				<span class="r402 r">funcObjRef</span>
					.<span class="i">Resolve</span>()
					.<span class="i">Methods</span>.<span class="i">First</span>(<span id="r404 rd" class="r404 r">md</span> =&gt; <span class="r404 r">md</span>.<span class="i">IsConstructor</span> &amp;&amp; <span class="r404 r">md</span>.<span class="i">Parameters</span>.<span class="i">Count</span> == 2)
					.<span class="i">ResolveGenericParameters</span>(<span class="r402 r">funcObjRef</span>, <span class="r388 r">module</span>);
			<span class="r401 r">parentIl</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Newobj</span>, <span class="r388 r">module</span>.<span class="i">ImportReference</span>(<span class="r403 r">funcCtor</span>));
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 0612
			<b>var</b> <span id="r405 rd" class="r405 r">propertySetter</span> =
				<span class="r388 r">module</span>.<span class="i">ImportReference</span>(<b>typeof</b> (<a href="/Xamarin.Forms.Core/A.html#12afc260d3791851" class="t t">IDataTemplate</a>)).<span class="i">Resolve</span>().<span class="i">Properties</span>.<span class="i">First</span>(<span id="r406 rd" class="r406 r">p</span> =&gt; <span class="r406 r">p</span>.<span class="i">Name</span> == <span class="s">&quot;LoadTemplate&quot;</span>).<span class="i">SetMethod</span>;
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 0612
			<span class="r385 r">parentContext</span>.<a href="ILContext.cs.html#5aa52f8a473a67c9" class="i property">IL</a>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r388 r">module</span>.<span class="i">ImportReference</span>(<span class="r405 r">propertySetter</span>));
 
			<span class="r393 r">loadTemplate</span>.<span class="i">Body</span>.<span class="i">Optimize</span>();
		}
	}
 
	<b>class</b> <a id="4bed0ed6d02d9248" href="R/4bed0ed6d02d9248.html" target="n" data-glyph="2,0" class="t t">VariableDefinitionReference</a>
	{
		<b>public</b> <a id="8ed14af9f95d7d98" href="R/8ed14af9f95d7d98.html" target="n" data-glyph="72,1" class="i constructor">VariableDefinitionReference</a>(<span class="i">VariableDefinition</span> <span id="r407 rd" class="r407 r">vardef</span>)
		{
			<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a> = <span class="r407 r">vardef</span>;
		}
 
		<b>public</b> <span class="i">VariableDefinition</span> <a id="fc3d55621e87df67" href="R/fc3d55621e87df67.html" target="n" data-glyph="102,1" class="i property">VariableDefinition</a> { <b>get</b>; <b>set</b>; }
 
		<b>public static implicit operator</b> <span class="i">VariableDefinition</span>(<a href="#4bed0ed6d02d9248" class="t t">VariableDefinitionReference</a> <span id="r408 rd" class="r408 r">vardefref</span>)
		{
			<b>return</b> <span class="r408 r">vardefref</span>.<a href="#fc3d55621e87df67" class="i property">VariableDefinition</a>;
		}
	}
}
</pre></td></tr></table></div></body></html>
