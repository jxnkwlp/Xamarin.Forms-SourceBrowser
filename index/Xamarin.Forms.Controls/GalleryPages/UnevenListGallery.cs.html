<!DOCTYPE html>
<html><head><title>UnevenListGallery.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(117);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="Xamarin.Forms.Controls/GalleryPages/UnevenListGallery.cs" target="_top">GalleryPages\UnevenListGallery.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xamarin.Forms.Controls" target="_top">Xamarin.Forms.Controls\Xamarin.Forms.Controls.csproj</a> (Xamarin.Forms.Controls)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Internals</span>;
 
<b>namespace</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Controls</span>
{
    [<a href="/Xamarin.Forms.Core/A.html#86e8cd96f62aab08" class="t constructor">Preserve</a>(<a href="/Xamarin.Forms.Core/A.html#1bacf10dafd22c73" class="i field">AllMembers</a> = <b>true</b>)]
    <b>public class</b> <a id="b5fb38250299b475" href="../R/b5fb38250299b475.html" target="n" data-glyph="0,0" class="t t">UnevenListGallery</a> : <a href="/Xamarin.Forms.Core/A.html#2f77fd3b834f8534" class="t t">ContentPage</a>
	{
        <b>public</b> <a id="b66a294482b9872c" href="../R/b66a294482b9872c.html" target="n" data-glyph="72,1" class="i constructor">UnevenListGallery</a> ()
		{
			<a href="/Xamarin.Forms.Core/A.html#f1345294373b64e8" class="i property">Padding</a> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#fb8081f9632acc64" class="t constructor">Thickness</a> (0, 20, 0, 0);
 
			<a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="k">var</a> <span id="r0 rd" class="r0 r">list</span> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#6f349a8ce3b4362f" class="t constructor">ListView</a> {
				<a href="/Xamarin.Forms.Core/A.html#7d4655a3bc00be9b" class="i property">HasUnevenRows</a> = <b>true</b>
			};
 
			<b>bool</b> <span id="r1 rd" class="r1 r">next</span> = <b>true</b>;
			<span class="r0 r">list</span>.<a href="/Xamarin.Forms.Core/A.html#e714497888d14198" class="i property">ItemTemplate</a> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#5d29a04f9d12654c" class="t constructor">DataTemplate</a> (() =&gt; {
				<b>bool</b> <span id="r2 rd" class="r2 r">tall</span> = <span class="r1 r">next</span>;
				<span class="r1 r">next</span> = !<span class="r1 r">next</span>;
				
				<a href="/Xamarin.Forms.Core/A.html#ba9b70b0224a44cd" class="k">var</a> <span id="r3 rd" class="r3 r">cell</span> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#ba9b70b0224a44cd" class="t constructor">TextCell</a> {
					<a href="/Xamarin.Forms.Core/A.html#0eedd908bf3c7b03" class="i property">Height</a> = (<span class="r2 r">tall</span>) ? 88 : 44
				};
 
				<span class="r3 r">cell</span>.<a href="/Xamarin.Forms.Core/A.html#6da00f516fa898d7" class="i method">SetBinding</a> (<a href="/Xamarin.Forms.Core/A.html#ba9b70b0224a44cd" class="t t">TextCell</a>.<a href="/Xamarin.Forms.Core/A.html#90f39da3bd0f1868" class="i field">TextProperty</a>, <span class="s">&quot;.&quot;</span>);
				<b>return</b> <span class="r3 r">cell</span>;
			});
 
			<span class="r0 r">list</span>.<a href="/Xamarin.Forms.Core/A.html#5eab030fbef30e59" class="i property">ItemsSource</a> = <b>new</b>[] { <span class="s">&quot;Tall&quot;</span>, <span class="s">&quot;Short&quot;</span>, <span class="s">&quot;Tall&quot;</span>, <span class="s">&quot;Short&quot;</span> };
 
			<a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="k">var</a> <span id="r4 rd" class="r4 r">listViewCellDynamicHeight</span> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#6f349a8ce3b4362f" class="t constructor">ListView</a> {
				<a href="/Xamarin.Forms.Core/A.html#7d4655a3bc00be9b" class="i property">HasUnevenRows</a> = <b>true</b>,
				<a href="/Xamarin.Forms.Core/A.html#2e7214c2a6b50358" class="i property">AutomationId</a>= <span class="s">&quot;unevenCellListGalleryDynamic&quot;</span>
			};
 
			<span class="r4 r">listViewCellDynamicHeight</span>.<a href="/Xamarin.Forms.Core/A.html#5eab030fbef30e59" class="i property">ItemsSource</a> = <b>new</b> [] { 
				<span class="s">@&quot;That Flesh is heir to? &#39;Tis a consummation
Devoutly to be wished. To die, to sleep,
To sleep, perchance to Dream; Aye, there&#39;s the rub,
For in that sleep of death, what dreams may come,That Flesh is heir to? &#39;Tis a consummation
Devoutly to be wished. To die, to sleep,
To sleep, perchance to Dream; Aye, there&#39;s the rub,
For in that sleep of death, what dreams may come&quot;</span>,
			};
 
			<span class="r4 r">listViewCellDynamicHeight</span>.<a href="/Xamarin.Forms.Core/A.html#e714497888d14198" class="i property">ItemTemplate</a> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#63a215190345c160" class="t constructor">DataTemplate</a> (<b>typeof</b>(<a href="#6a13047843a8d569" class="t t">UnevenRowsCell</a>));
 
			<span class="r4 r">listViewCellDynamicHeight</span>.<a href="/Xamarin.Forms.Core/A.html#c09f6c15d5698cc9" class="i">ItemTapped</a> += (<span id="r5 rd" class="r5 r">sender</span>, <span id="r6 rd" class="r6 r">e</span>) =&gt; {
				<b>if</b> (<span class="r6 r">e</span> == <b>null</b>)
					<b>return</b>; <span class="c">// has been set to null, do not &#39;process&#39; tapped event</span>
				((<a href="/Xamarin.Forms.Core/A.html#bde8d740ed7039c7" class="t t">ListView</a>)<span class="r5 r">sender</span>).<a href="/Xamarin.Forms.Core/A.html#dfce6372456ec083" class="i property">SelectedItem</a> = <b>null</b>; <span class="c">// de-select the row</span>
			};
 
			<a href="/Xamarin.Forms.Core/A.html#b4132e8e9a86f1d6" class="k">var</a> <span id="r7 rd" class="r7 r">grd</span> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#cb7d69d9b07590da" class="t constructor">Grid</a> ();
 
			<span class="r7 r">grd</span>.<a href="/Xamarin.Forms.Core/A.html#1ee7a3117c1f1c76" class="i property">RowDefinitions</a>.<a href="/Xamarin.Forms.Core/A.html#6273231b32b59006" class="i method">Add</a> (<b>new</b> <a href="/Xamarin.Forms.Core/A.html#e654ffc6d29004be" class="t constructor">RowDefinition</a> ());
			<span class="r7 r">grd</span>.<a href="/Xamarin.Forms.Core/A.html#1ee7a3117c1f1c76" class="i property">RowDefinitions</a>.<a href="/Xamarin.Forms.Core/A.html#6273231b32b59006" class="i method">Add</a> (<b>new</b> <a href="/Xamarin.Forms.Core/A.html#e654ffc6d29004be" class="t constructor">RowDefinition</a> ());
		
			<span class="r7 r">grd</span>.<a href="/Xamarin.Forms.Core/A.html#a475b66501d17523" class="i property">Children</a>.<a href="@1@System.Runtime/A.html#a9319db8c62ae453" class="i method">Add</a> (<span class="r4 r">listViewCellDynamicHeight</span>);
			<span class="r7 r">grd</span>.<a href="/Xamarin.Forms.Core/A.html#a475b66501d17523" class="i property">Children</a>.<a href="@1@System.Runtime/A.html#a9319db8c62ae453" class="i method">Add</a> (<span class="r0 r">list</span>);
		
			<a href="/Xamarin.Forms.Core/A.html#b4132e8e9a86f1d6" class="t t">Grid</a>.<a href="/Xamarin.Forms.Core/A.html#3c23939acc20f93a" class="i method">SetRow</a> (<span class="r0 r">list</span>, 1);
		
			<a href="/Xamarin.Forms.Core/A.html#3929eda3f5d3e80d" class="i property">Content</a> =  <span class="r7 r">grd</span>;
		}
 
 
        [<a href="/Xamarin.Forms.Core/A.html#86e8cd96f62aab08" class="t constructor">Preserve</a>(<a href="/Xamarin.Forms.Core/A.html#1bacf10dafd22c73" class="i field">AllMembers</a> = <b>true</b>)]
        <b>public class</b> <a id="6a13047843a8d569" href="../R/6a13047843a8d569.html" target="n" data-glyph="0,1" class="t t">UnevenRowsCell</a> : <a href="/Xamarin.Forms.Core/A.html#080f860d2adf2a57" class="t t">ViewCell</a>
		{
			<b>public</b> <a id="366613af0c6cd047" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i constructor">UnevenRowsCell</a> ()
			{
				<a href="/Xamarin.Forms.Core/A.html#9467fb795433a9ba" class="k">var</a> <span id="r8 rd" class="r8 r">label1</span> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#aa576bf63d926ee6" class="t constructor">Label</a> {
					<a href="/Xamarin.Forms.Core/A.html#60b82bdc24dcbdf6" class="i property">Text</a> = <span class="s">&quot;Label 1&quot;</span>,
					<a href="/Xamarin.Forms.Core/A.html#16a4d70a298a161f" class="i property">FontSize</a> = <a href="/Xamarin.Forms.Core/A.html#4809323d42d3030a" class="t t">Device</a>.<a href="/Xamarin.Forms.Core/A.html#fa64428d63a90d2b" class="i method">GetNamedSize</a> (<a href="/Xamarin.Forms.Core/A.html#6ea57413a7159d38" class="t t">NamedSize</a>.<a href="/Xamarin.Forms.Core/A.html#6e9f79ba23a0d2bf" class="i field">Small</a>, <b>typeof</b>(<a href="/Xamarin.Forms.Core/A.html#9467fb795433a9ba" class="t t">Label</a>))
				};
				<span class="r8 r">label1</span>.<a href="/Xamarin.Forms.Core/A.html#d05c3999b6e90555" class="i method">SetBinding</a> (<a href="/Xamarin.Forms.Core/A.html#9467fb795433a9ba" class="t t">Label</a>.<a href="/Xamarin.Forms.Core/A.html#208bde7cd8e27200" class="i field">TextProperty</a>, <b>new</b> <a href="/Xamarin.Forms.Core/A.html#c79f6c91a3606a34" class="t constructor">Binding</a> (<span class="s">&quot;.&quot;</span>));
 
				<a href="/Xamarin.Forms.Core/A.html#7e0120b037b3522c" class="i property">View</a> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#9eff482dc844e6af" class="t constructor">StackLayout</a> {
					<a href="/Xamarin.Forms.Core/A.html#20029466f01d2a39" class="i property">Orientation</a> = <a href="/Xamarin.Forms.Core/A.html#6f196c86fbf52dcc" class="t t">StackOrientation</a>.<a href="/Xamarin.Forms.Core/A.html#b2438cceacb45845" class="i field">Vertical</a>,
					<a href="/Xamarin.Forms.Core/A.html#8e761ec8c2755065" class="i property">VerticalOptions</a> = <a href="/Xamarin.Forms.Core/A.html#633bdae02c57accb" class="t t">LayoutOptions</a>.<a href="/Xamarin.Forms.Core/A.html#edf3bdaab2352b98" class="i field">StartAndExpand</a>,
					<a href="/Xamarin.Forms.Core/A.html#7ca8765029e54dfb" class="i property">Padding</a> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#fb8081f9632acc64" class="t constructor">Thickness</a> (15, 5, 5, 5),
					<a href="/Xamarin.Forms.Core/A.html#5049824abac2f58c" class="i property">Children</a> = { <span class="r8 r">label1</span> }
				};
			}
			<span class="c">// This is the code used before and still works by setting the height of the cell</span>
			<span class="c">//		const int avgCharsInRow = 35;</span>
			<span class="c">//		const int defaultHeight = 44;</span>
			<span class="c">//		const int extraLineHeight = 20;</span>
			<span class="c">//		protected override void OnBindingContextChanged ()</span>
			<span class="c">//		{</span>
			<span class="c">//			base.OnBindingContextChanged ();</span>
			<span class="c">//</span>
			<span class="c">//			if (Device.OS == TargetPlatform.iOS) {</span>
			<span class="c">//				var text = (string)BindingContext;</span>
			<span class="c">//</span>
			<span class="c">//				var len = text.Length;</span>
			<span class="c">//</span>
			<span class="c">//				if (len &lt; (avgCharsInRow * 2)) {</span>
			<span class="c">//					// fits in one cell</span>
			<span class="c">//					Height = defaultHeight;</span>
			<span class="c">//				} else {</span>
			<span class="c">//					len = len - (avgCharsInRow * 2);</span>
			<span class="c">//					var extraRows = len / 35;</span>
			<span class="c">//					Height = defaultHeight + extraRows * extraLineHeight;</span>
			<span class="c">//				}</span>
			<span class="c">//			}</span>
			<span class="c">//		}</span>
		}
	}
}
</pre></td></tr></table></div></body></html>
