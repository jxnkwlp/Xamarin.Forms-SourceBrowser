<!DOCTYPE html>
<html><head><title>TwitterPage.xaml.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(186);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="Xamarin.Forms.Controls/HanselForms/TwitterPage.xaml.cs" target="_top">HanselForms\TwitterPage.xaml.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xamarin.Forms.Controls" target="_top">Xamarin.Forms.Controls\Xamarin.Forms.Controls.csproj</a> (Xamarin.Forms.Controls)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
 
<b>namespace</b> <span class="i n">Xamarin</span>.<span class="i n">Forms</span>.<span class="i n">Controls</span>
{
	<b>public</b> <b>partial</b> <b>class</b> <a id="67bf539074301610" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">TwitterPage</a> : <a href="/Xamarin.Forms.Core/A.html#2f77fd3b834f8534" class="t t">ContentPage</a>
	{
 
		<b>private</b> <a href="#d4622a9aea1ab583" class="t t">TwitterViewModel</a> <a id="1755a5f049d43397" href="../R/1755a5f049d43397.html" target="n" data-glyph="106,1" class="i property">ViewModel</a>
		{
			<b>get</b> { <b>return</b> <a href="/Xamarin.Forms.Core/A.html#ec31b23be1ce91d4" class="i property">BindingContext</a> <b>as</b> <a href="#d4622a9aea1ab583" class="t t">TwitterViewModel</a>; }
		}
		<b>public</b> <a id="abbc23953f1ad47e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i constructor">TwitterPage</a>()
		{
			<span class="i">InitializeComponent</span>();
			<a href="/Xamarin.Forms.Core/A.html#ec31b23be1ce91d4" class="i property">BindingContext</a> = <b>new</b> <a href="#05ea70d3c30c11c6" class="t constructor">TwitterViewModel</a>();
 
 
			<span class="i">listView</span>.<span class="i">ItemTapped</span> += (<span id="r0 rd" class="r0 r">sender</span>, <span id="r1 rd" class="r1 r">args</span>) =&gt;
			{
				<b>if</b> (<span class="i">listView</span>.<span class="i">SelectedItem</span> == <b>null</b>)
					<b>return</b>;
				<a href="#d9277d52c2546946" class="k">var</a> <span id="r2 rd" class="r2 r">tweet</span> = <span class="i">listView</span>.<span class="i">SelectedItem</span> <b>as</b> <a href="#d9277d52c2546946" class="t t">Tweet</a>;
				<a href="#67bf539074301610" class="k">this</a>.<a href="/Xamarin.Forms.Core/A.html#0621720042f94078" class="i property">Navigation</a>.<a href="/Xamarin.Forms.Core/A.html#3ff757e3b604805a" class="i method">PushAsync</a>(<b>new</b> <a href="WebsiteView.cs.html#afdd4c629f40fe9b" class="t constructor">WebsiteView</a>(<span class="s">&quot;http://m.twitter.com/shanselman/status/&quot;</span> + <span class="r2 r">tweet</span>.<a href="#3513dc66862af64a" class="i property">StatusID</a>, <span class="r2 r">tweet</span>.<a href="#6f4ff7770c980185" class="i property">Date</a>));
				<span class="i">listView</span>.<span class="i">SelectedItem</span> = <b>null</b>;
			};
		}
 
 
		<b>protected override void</b> <a id="00abe52eb0188487" href="../R/00abe52eb0188487.html" target="n" data-glyph="75,1" class="i method">OnAppearing</a>()
		{
			<a href="/Xamarin.Forms.Core/A.html#2f77fd3b834f8534" class="k">base</a>.<a href="/Xamarin.Forms.Core/A.html#6159d4d059ac7175" class="i method">OnAppearing</a>();
			<b>if</b> (<a href="#1755a5f049d43397" class="i property">ViewModel</a> == <b>null</b> || !<a href="#1755a5f049d43397" class="i property">ViewModel</a>.<a href="HBaseViewModel.cs.html#e632c621b1ee1d35" class="i property">CanLoadMore</a> || <a href="#1755a5f049d43397" class="i property">ViewModel</a>.<a href="HBaseViewModel.cs.html#9297ee8b0a7f9db9" class="i property">IsBusy</a> || <a href="#1755a5f049d43397" class="i property">ViewModel</a>.<a href="#742438a31f9ab00c" class="i property">Tweets</a>.<a href="@1@System.Runtime/A.html#f2419069e9890f5d" class="i property">Count</a> &gt; 0)
				<b>return</b>;
 
			<a href="#1755a5f049d43397" class="i property">ViewModel</a>.<a href="#5195e40db18523a8" class="i property">LoadTweetsCommand</a>.<a href="/Xamarin.Forms.Core/A.html#20e65f5fba0a6e66" class="i method">Execute</a>(<b>null</b>);
		}
	}
 
	<b>public class</b> <a id="d4622a9aea1ab583" href="../R/d4622a9aea1ab583.html" target="n" data-glyph="0,0" class="t t">TwitterViewModel</a> : <a href="HBaseViewModel.cs.html#26db8a8eb01678da" class="t t">HBaseViewModel</a>
	{
 
		<b>public</b> <span class="t t">ObservableCollection</span>&lt;<a href="#d9277d52c2546946" class="t t">Tweet</a>&gt; <a id="742438a31f9ab00c" href="../R/742438a31f9ab00c.html" target="n" data-glyph="102,1" class="i property">Tweets</a> { <b>get</b>; <b>set</b>; }
 
		<b>public</b> <a id="05ea70d3c30c11c6" href="../R/05ea70d3c30c11c6.html" target="n" data-glyph="72,1" class="i constructor">TwitterViewModel</a>()
		{
			<a href="HBaseViewModel.cs.html#6b3bcb792626218f" class="i property">Title</a> = <span class="s">&quot;Twitter&quot;</span>;
			<a href="HBaseViewModel.cs.html#5162c1dcd3c3b705" class="i property">Icon</a> = <span class="s">&quot;slideout.png&quot;</span>;
			<a href="#742438a31f9ab00c" class="i property">Tweets</a> = <b>new</b> <span class="t constructor">ObservableCollection</span>&lt;<a href="#d9277d52c2546946" class="t t">Tweet</a>&gt;();
 
		}
 
		<b>private</b> <a href="/Xamarin.Forms.Core/A.html#8751d3e015cab881" class="t t">Command</a> <a id="40d505d7b730cbad" href="../R/40d505d7b730cbad.html" target="n" data-glyph="46,1" class="i field">loadTweetsCommand</a>;
 
		<b>public</b> <a href="/Xamarin.Forms.Core/A.html#8751d3e015cab881" class="t t">Command</a> <a id="5195e40db18523a8" href="../R/5195e40db18523a8.html" target="n" data-glyph="102,1" class="i property">LoadTweetsCommand</a>
		{
			<b>get</b>
			{
				<b>return</b> <a href="#40d505d7b730cbad" class="i field">loadTweetsCommand</a> ??
				  (<a href="#40d505d7b730cbad" class="i field">loadTweetsCommand</a> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#d493a595799ead4c" class="t constructor">Command</a>(<b>async</b> () =&gt;
				  {
					  <b>await</b> <a href="#1ffa142050d04d32" class="i method">ExecuteLoadTweetsCommand</a>();
				  }, () =&gt;
				  {
					  <b>return</b> !<a href="HBaseViewModel.cs.html#9297ee8b0a7f9db9" class="i property">IsBusy</a>;
				  }));
			}
		}
 
		<b>public async</b> <span class="t t">Task</span> <a id="1ffa142050d04d32" href="../R/1ffa142050d04d32.html" target="n" data-glyph="72,1" class="i method">ExecuteLoadTweetsCommand</a>()
		{
			<b>if</b> (<a href="HBaseViewModel.cs.html#9297ee8b0a7f9db9" class="i property">IsBusy</a>)
				<b>return</b>;
 
			<a href="HBaseViewModel.cs.html#9297ee8b0a7f9db9" class="i property">IsBusy</a> = <b>true</b>;
			<a href="#5195e40db18523a8" class="i property">LoadTweetsCommand</a>.<a href="/Xamarin.Forms.Core/A.html#84e4dd296f7022cd" class="i method">ChangeCanExecute</a>();
			<a href="@1@System.Runtime/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r3 rd" class="r3 r">error</span> = <b>false</b>;
			<b>try</b>
			{
 
				<a href="#742438a31f9ab00c" class="i property">Tweets</a>.<a href="@1@System.Runtime/A.html#1c7184c9f3526d9d" class="i method">Clear</a>();
				<span class="c">//var auth = new ApplicationOnlyAuthorizer()</span>
				<span class="c">//{</span>
				<span class="c">//	CredentialStore = new InMemoryCredentialStore</span>
				<span class="c">//	{</span>
				<span class="c">//		ConsumerKey = &quot;ZTmEODUCChOhLXO4lnUCEbH2I&quot;,</span>
				<span class="c">//		ConsumerSecret = &quot;Y8z2Wouc5ckFb1a0wjUDT9KAI6DUat5tFNdmIkPLl8T4Nyaa2J&quot;,</span>
				<span class="c">//	},</span>
				<span class="c">//};</span>
				<span class="c">//await auth.AuthorizeAsync();</span>
 
				<span class="c">//var twitterContext = new TwitterContext(auth);</span>
 
				<span class="c">//var queryResponse = await</span>
				<span class="c">//  (from tweet in twitterContext.Status</span>
				<span class="c">//   where tweet.Type == StatusType.User &amp;&amp;</span>
				<span class="c">//	 tweet.ScreenName == &quot;shanselman&quot; &amp;&amp;</span>
				<span class="c">//	 tweet.Count == 100 &amp;&amp;</span>
				<span class="c">//	 tweet.IncludeRetweets == true &amp;&amp;</span>
				<span class="c">//	 tweet.ExcludeReplies == true</span>
				<span class="c">//   select tweet).ToListAsync();</span>
 
				<span class="c">//var tweets =</span>
				<span class="c">//  (from tweet in queryResponse</span>
				<span class="c">//   select new Tweet</span>
				<span class="c">//   {</span>
				<span class="c">//	   StatusID = tweet.StatusID,</span>
				<span class="c">//	   ScreenName = tweet.User.ScreenNameResponse,</span>
				<span class="c">//	   Text = tweet.Text,</span>
				<span class="c">//	   CurrentUserRetweet = tweet.CurrentUserRetweet,</span>
				<span class="c">//	   CreatedAt = tweet.CreatedAt,</span>
				<span class="c">//	   Image = tweet.RetweetedStatus != null &amp;&amp; tweet.RetweetedStatus.User != null ?</span>
				<span class="c">//					  tweet.RetweetedStatus.User.ProfileImageUrl.Replace(&quot;http://&quot;, &quot;https://&quot;) : (tweet.User.ScreenNameResponse == &quot;shanselman&quot; ? &quot;scott159.png&quot; : tweet.User.ProfileImageUrl.Replace(&quot;http://&quot;, &quot;https://&quot;))</span>
				<span class="c">//   }).ToList();</span>
				<span class="c">//foreach (var tweet in tweets)</span>
				<span class="c">//{</span>
				<span class="c">//	Tweets.Add(tweet);</span>
				<span class="c">//}</span>
 
				<span class="c">//if (Device.OS == TargetPlatform.iOS)</span>
				<span class="c">//{</span>
				<span class="c">//	// only does anything on iOS, for the Watch</span>
				<span class="c">//	//	DependencyService.Get&lt;ITweetStore&gt;().Save(tweets);</span>
				<span class="c">//}</span>
 
 
 
			}
			<b>catch</b>
			{
				<span class="r3 r">error</span> = <b>true</b>;
			}
 
			<b>if</b> (<span class="r3 r">error</span>)
			{
				<a href="/Xamarin.Forms.Core/A.html#2f77fd3b834f8534" class="k">var</a> <span id="r4 rd" class="r4 r">page</span> = <b>new</b> <a href="/Xamarin.Forms.Core/A.html#2f77fd3b834f8534" class="t constructor">ContentPage</a>();
				<b>await</b> <span class="r4 r">page</span>.<a href="/Xamarin.Forms.Core/A.html#3dc9f3ad3bd6f0c0" class="i method">DisplayAlert</a>(<span class="s">&quot;Error&quot;</span>, <span class="s">&quot;Unable to load tweets.&quot;</span>, <span class="s">&quot;OK&quot;</span>);
			}
 
			<a href="HBaseViewModel.cs.html#9297ee8b0a7f9db9" class="i property">IsBusy</a> = <b>false</b>;
			<a href="#5195e40db18523a8" class="i property">LoadTweetsCommand</a>.<a href="/Xamarin.Forms.Core/A.html#84e4dd296f7022cd" class="i method">ChangeCanExecute</a>();
		}
	}
 
	<b>public class</b> <a id="d9277d52c2546946" href="../R/d9277d52c2546946.html" target="n" data-glyph="0,0" class="t t">Tweet</a>
	{
		<b>public</b> <a id="01ee5eacc11736e1" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i constructor">Tweet</a>()
		{
		}
 
 
		<b>public ulong</b> <a id="3513dc66862af64a" href="../R/3513dc66862af64a.html" target="n" data-glyph="102,1" class="i property">StatusID</a> { <b>get</b>; <b>set</b>; }
 
		<b>public string</b> <a id="54d6f756c7d1624b" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ScreenName</a> { <b>get</b>; <b>set</b>; }
 
		<b>public string</b> <a id="419a8ab18f43959e" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Text</a> { <b>get</b>; <b>set</b>; }
 
		<span class="c">//[JsonIgnore]</span>
		<b>public string</b> <a id="6f4ff7770c980185" href="../R/6f4ff7770c980185.html" target="n" data-glyph="102,1" class="i property">Date</a> { <b>get</b> { <b>return</b> <a href="#0e0f0ac53bc16657" class="i property">CreatedAt</a>.<a href="@1@System.Runtime/A.html#5088b43558351160" class="i method">ToString</a>(<span class="s">&quot;g&quot;</span>); } }
		<span class="c">//[JsonIgnore]</span>
		<b>public string</b> <a id="dda30c89e72ab0a7" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">RTCount</a> { <b>get</b> { <b>return</b> <a href="#1c88daf964bb960c" class="i property">CurrentUserRetweet</a> == 0 ? <b>string</b>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a> : <a href="#1c88daf964bb960c" class="i property">CurrentUserRetweet</a> + <span class="s">&quot; RT&quot;</span>; } }
 
		<b>public string</b> <a id="ded1ad73a38e2291" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Image</a> { <b>get</b>; <b>set</b>; }
 
		<b>public</b> <a href="@1@System.Runtime/A.html#df6b1eba7461813b" class="t t">DateTime</a> <a id="0e0f0ac53bc16657" href="../R/0e0f0ac53bc16657.html" target="n" data-glyph="102,1" class="i property">CreatedAt</a>
		{
			<b>get</b>;
			<b>set</b>;
		}
 
		<b>public ulong</b> <a id="1c88daf964bb960c" href="../R/1c88daf964bb960c.html" target="n" data-glyph="102,1" class="i property">CurrentUserRetweet</a>
		{
			<b>get</b>;
			<b>set</b>;
		}
	}
 
	<b>public interface</b> <a id="bb3e7b503ac7835e" href="../R/../../0000000000.html" target="n" data-glyph="48,0" class="t t">ITweetStore</a>
	{
		<b>void</b> <a id="1eef8b964286f5a0" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Save</a>(<span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>.<a href="@1@System.Collections/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="#d9277d52c2546946" class="t t">Tweet</a>&gt; <span id="r5 rd" class="r5 r">tweets</span>);
		<span class="c">//System.Collections.Generic.List&lt;Hanselman.Shared.Tweet&gt; Load ();</span>
	}
}
</pre></td></tr></table></div></body></html>
